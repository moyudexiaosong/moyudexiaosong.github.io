

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=light>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/icon.jpg">
  <link rel="icon" href="/img/icon.jpg">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="项目一：外星人入侵本项目将使用Pygame模块，用于管理图形、动画乃至声音，让你能够更轻松地开发复杂的游戏。 阶段一 创建一艘飞船，可以左右移动，并且能在用户按空格键时开火。设置好这种行为后，就可以创建外星人并提高游戏的可玩性了。 先来安装Pygame，可使用pip 模块来帮助下载并安装 Python包。要安装Pygame，在终端提示符下执行如下命令： 123python3 -m pip ins">
<meta property="og:type" content="article">
<meta property="og:title" content="Python项目练习">
<meta property="og:url" content="http://example.com/2022/09/09/Python%E9%A1%B9%E7%9B%AE%E7%BB%83%E4%B9%A0/index.html">
<meta property="og:site_name" content="摸鱼之家">
<meta property="og:description" content="项目一：外星人入侵本项目将使用Pygame模块，用于管理图形、动画乃至声音，让你能够更轻松地开发复杂的游戏。 阶段一 创建一艘飞船，可以左右移动，并且能在用户按空格键时开火。设置好这种行为后，就可以创建外星人并提高游戏的可玩性了。 先来安装Pygame，可使用pip 模块来帮助下载并安装 Python包。要安装Pygame，在终端提示符下执行如下命令： 123python3 -m pip ins">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/img/photo30.jpeg">
<meta property="article:published_time" content="2022-09-09T15:52:46.000Z">
<meta property="article:modified_time" content="2022-09-13T18:10:22.820Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="Python基础知识">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/img/photo30.jpeg">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>Python项目练习 - 摸鱼之家</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/bynotes/texiao/source/css/shubiao.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.1","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":false},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"AwHBUAjSP1GvDVpiBgxfS2Pg-gzGzoHsz","app_key":"kMsGLN3hzkQJuLrmqQBgquFF","server_url":"https://awhbuajs.lc-cn-n1-shared.com","path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>

  
<meta name="generator" content="Hexo 5.4.2"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>快乐老家</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                主页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                档案馆
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                目录
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                友链
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/photo30.jpeg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Python项目练习"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-09-09 23:52" pubdate>
          September 9, 2022 pm
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          15k words
        
      </span>
    

    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> views
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Python项目练习</h1>
            
              <p class="note note-info">
                
                  
                    Last updated on 13 hours ago
                  
                
              </p>
            
            <div class="markdown-body">
              
              <hr>
<h3 id="项目一：外星人入侵"><a href="#项目一：外星人入侵" class="headerlink" title="项目一：外星人入侵"></a>项目一：外星人入侵</h3><p>本项目将使用Pygame模块，用于管理图形、动画乃至声音，让你能够更轻松地开发复杂的游戏。</p>
<p><strong>阶段一</strong></p>
<p>创建一艘飞船，可以左右移动，并且能在用户按空格键时开火。设置好这种行为后，就可以创建外星人并提高游戏的可玩性了。</p>
<p>先来安装Pygame，可使用pip 模块来帮助下载并安装 Python包。要安装Pygame，在终端提示符下执行如下命令：</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs tex">python3 -m pip install --user pygame<br>python3<br>import pygame<br></code></pre></td></tr></table></figure>
<p><strong>开始游戏项目</strong></p>
<p>首先创建一个空的Pygame窗口，并让这个游戏响应用户输入，设置背景色，以及加载飞船图像。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> pygame<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">AlienInvasion</span>:<br>  <span class="hljs-comment">#访问Pygame检测到的事件</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>      <span class="hljs-comment">#初始化游戏并创建游戏资源</span><br>        pygame.init()<br>        self.screen=pygame.display.set_mode((<span class="hljs-number">1200</span>,<span class="hljs-number">800</span>))<br>        pygame.display.set_caption(<span class="hljs-string">&quot;Alien Invasion&quot;</span>)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run_game</span>(<span class="hljs-params">self</span>):<br>      <span class="hljs-comment">#开始游戏的主循环</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>          <span class="hljs-comment">#监视键盘和鼠标事件</span><br>            <span class="hljs-keyword">for</span> event <span class="hljs-keyword">in</span> pygame.event.get():<br>                <span class="hljs-keyword">if</span> event.<span class="hljs-built_in">type</span>==pygame.QUIT:<br>                    sys.exit()<br>            <span class="hljs-comment">#让最近绘制的屏幕可见</span><br>            pygame.display.flip()<br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&#x27;__main__&#x27;</span>:<br>  <span class="hljs-comment">#创建游戏实例并运行游戏</span><br>    ai=AlienInvasion()<br>    ai.run_game()<br></code></pre></td></tr></table></figure>
<p>a. 导入模块</p>
<p>首先，导入模块sys和pygame 。模块pygame 包含开发游戏所需的功能，模块sys中的工具用来退出游戏。</p>
<p>b. 初始化显示窗口</p>
<p><code>pygame.init()</code>初始化背景设置，<code>pygame.display.set_mode()</code>创建一个显示窗口，游戏的所有图形元素都将在其中绘制。实参(1200, 800) 是一个元组，指定了游戏窗口的尺寸——宽1200像素、高800 像素。将这个显示窗口赋给属性<code>self.screen</code> ，让这个类中的所有方法都能够使用它。</p>
<p>c. surface元素</p>
<p>在这个游戏中，每个元素（如外星人或飞船）都是一个surface。<code>display.set_mode()</code>返回的surface表示整个游戏窗口。激活游戏的动画循环后，每经过一次循环都将自动重绘这个surface。</p>
<p>d. 运行游戏</p>
<p>方法<code>run_game()</code> 有无限循环的 while 循环，循环内用来放监听事件和事件响应。</p>
<p>c. 响应事件</p>
<p><code>pygame.event.get()</code>用于访问Pygame检测到的事件，这个函数返回一个事件列表，所有键盘和鼠标事件都将导致这个for 循环运行。</p>
<p>d. 换帧</p>
<p><code>pygame.display.flip()</code> 函数命令Pygame显示最近绘制的屏幕。在这个程序里，它每次执行while 循环时都会绘制一个空屏幕，并擦去旧屏幕。我们移动游戏元素时，<code>pygame.display.flip()</code>将不断更新屏幕，以显示元素的新位置，并且在原来的位置隐藏元素，从而营造平滑移动的效果。</p>
<p>e. 创建实例</p>
<p>创建一个游戏实例并调用<code>run_game()</code> 。如果此时运行alien_invasion.py，将看到一个空的Pygame窗口。</p>
<p><strong>设置背景色</strong></p>
<p>在Pygame中，颜色是以RGB值指定的，我们自定义一个元祖赋给self.bg_color作为RGB参数。并在while循环内调用方法<code>fill()</code> 用背景色填充屏幕，方法<code>fill()</code>用于处理surface，接受一个RGB实参，在每次循环时都用该背景色重绘屏幕。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> pygame<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">AlienInvasion</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        pygame.init()<br>        self.screen=pygame.display.set_mode((<span class="hljs-number">1200</span>,<span class="hljs-number">800</span>))<br>        pygame.display.set_caption(<span class="hljs-string">&quot;Alien Invasion&quot;</span>)<br>        self.bg_color=(<span class="hljs-number">227</span>, <span class="hljs-number">234</span>, <span class="hljs-number">255</span>)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run_game</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            <span class="hljs-keyword">for</span> event <span class="hljs-keyword">in</span> pygame.event.get():<br>                <span class="hljs-keyword">if</span> event.<span class="hljs-built_in">type</span>==pygame.QUIT:<br>                    sys.exit()<br>            self.screen.fill((self.bg_color))<br>            pygame.display.flip()<br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    ai=AlienInvasion()<br>    ai.run_game()<br></code></pre></td></tr></table></figure>
<p><strong>创建设置类</strong></p>
<p>每次给游戏添加新功能时，都要引入一些新设置。下面来编写一个settings模块，用于将所有设置都存储在一个地方，以免在代码中到处添加设置。</p>
<p>在文件夹alien_invasion中，新建一个名为settings.py的文件，并在其中添加如下Settings 类：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Settings</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.screen_width=<span class="hljs-number">1200</span><br>        self.screen_height=<span class="hljs-number">800</span><br>        self.bg_color=(<span class="hljs-number">227</span>, <span class="hljs-number">234</span>, <span class="hljs-number">255</span>)<br></code></pre></td></tr></table></figure>
<p>并将 alien_invasion.py修改成下面这样：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> pygame<br><span class="hljs-keyword">from</span> settings <span class="hljs-keyword">import</span> Settings<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">AlienInvasion</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        pygame.init()<br>        self.settings=Settings()       			<br>     		self.screen=pygame.display.set_mode((self.settings.screen_width,<br>                                             self.settings.screen_height))<br>        pygame.display.set_caption(<span class="hljs-string">&quot;Alien Invasion&quot;</span>)<span class="hljs-comment">#设置窗口标题</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run_game</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            <span class="hljs-keyword">for</span> event <span class="hljs-keyword">in</span> pygame.event.get():<br>                <span class="hljs-keyword">if</span> event.<span class="hljs-built_in">type</span>==pygame.QUIT:<br>                    sys.exit()<br>            self.screen.fill((self.settings.bg_color))<br>            pygame.display.flip()<br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    ai=AlienInvasion()<br>    ai.run_game()<br></code></pre></td></tr></table></figure>
<p>创建的Settings类被赋给<code>self.settings</code>，接下来就可以作为AlienInvasion示例本身的属性来调用了。</p>
<p><strong>添加飞船图像</strong></p>
<p>为了在屏幕上绘制玩家的飞船，我们将加 载一幅图像，再使用Pygame方法blit() 绘制它。在游戏中几乎可以使用任何类型的图像文件，但使用位图（.bmp） 文件最为简单，因为Pygame默认加载位图，可使用Photoshop、 GIMP和Paint等工具将其转换为位图。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pygame<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Ship</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,ai_game</span>):<br>        self.screen=ai_game.screen<br>        self.screen_rect=ai_game.screen.get_rect()<br>        <span class="hljs-comment"># 加载飞船图像并获取其外接矩形。</span><br>        self.proto=pygame.image.load(<span class="hljs-string">&#x27;airsvg.svg&#x27;</span>)<br>        self.image=pygame.transform.scale(self.proto,(<span class="hljs-number">200</span>,<span class="hljs-number">100</span>))<br>        self.rect = self.image.get_rect()<br>        <span class="hljs-comment"># 对于每艘新飞船，都将其放在屏幕底部的中央。</span><br>        self.rect.midbottom = self.screen_rect.midbottom<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">blitme</span>(<span class="hljs-params">self</span>):<br>      	<span class="hljs-comment">#在指定位置绘制飞船。</span><br>        self.screen.blit(self.image, self.rect)<br>        <span class="hljs-comment">#pygame.transform.scale(Surface, (width, height), DestSurface = None) </span><br>        <span class="hljs-comment">#转化大小</span><br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> pygame<br><span class="hljs-keyword">from</span> ship <span class="hljs-keyword">import</span> Ship<br><span class="hljs-keyword">from</span> settings <span class="hljs-keyword">import</span> Settings<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">AlienInvasion</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        pygame.init()<br>        self.settings=Settings()<br>        self.screen=pygame.display.set_mode(<br>          (self.settings.screen_width,<br>           self.settings.screen_height))<br>        pygame.display.set_caption(<span class="hljs-string">&quot;Alien Invasion&quot;</span>)<br>        self.ship = Ship(self)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run_game</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            <span class="hljs-keyword">for</span> event <span class="hljs-keyword">in</span> pygame.event.get():<br>                <span class="hljs-keyword">if</span> event.<span class="hljs-built_in">type</span>==pygame.QUIT:<br>                    sys.exit()<br>            self.screen.fill((self.settings.bg_color))<br>            self.ship.blitme()<br>            pygame.display.flip()<br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    ai=AlienInvasion()<br>    ai.run_game()<br></code></pre></td></tr></table></figure>
<p>Pygame之所以高效，是因为它让你能够像处理矩形（rect 对象） 一样处理所有的游戏元素。</p>
<p>Ship传进去一个当前AlienInvasion 实例的引用来访问AlienInvasion中定义的所有游戏资源。<code>get_rect()</code>函数的作用是将我们的图片的位置用代码的形式告诉我们。</p>
<p><img src="/../img/image-20220913202941197.png" srcset="/img/loading.gif" lazyload alt="image-20220913202941197"></p>
<p>调用<code>pygame.image.load()</code>加载图像，并将飞船图像的位置传递给它。该函数返回一个表示飞船的surface，将这个 surface赋给了self.image 。加载图像后，使用get_rect() 获取相应surface的属性rect ，以便后面能够把图片的位置和外框的底部中央对齐起来。</p>
<ul>
<li>处理rect 对象时，可通过设置它的属性值来指定矩形的位置。</li>
<li>让游戏元素居中，可设置相应 rect 对象的属性center 、centerx 或centery ；</li>
<li>让游戏元素与屏幕边缘对齐，可使用属性top 、bottom 、left 或right 。</li>
<li>还有一些组合属性，可同时设置两个方向，如midbottom 、midtop 、midleft 和 midright 。</li>
<li>要调整游戏元素的水平或垂直位置，可使用属性x和y ，分别是相应矩形左上角的坐标和坐标。</li>
</ul>
<p><strong><code>pygame.surface.blit()</code>方法</strong></p>
<p>假设有两个surface对象，简称为图，函数<code>B.blit(A,dest)</code>的功能就是把图A粘贴到图B上，这意味着B上的图将被A上的图覆盖，且永久不能恢复。</p>
<p><code>blit（）</code>的原型是<code>blit（source, dest, area=None, special_flags = 0）</code>，返回值为rect对象，返回被改变的画面区域，例如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">screen=pygame.display.set_mode(<span class="hljs-number">200</span>,<span class="hljs-number">200</span>)	<span class="hljs-comment">#screen是Surface实例，宽高各为200</span><br>screen.blit(image,(<span class="hljs-number">10</span>,<span class="hljs-number">10</span>))		<span class="hljs-comment">#image是某图像，(10,10)是screen坐标</span><br></code></pre></td></tr></table></figure>
<p>先创建一个surface实例B，再把图A粘贴到图B的某一位置上。第二个参数为一个坐标标识，可以是一个（x，y）元组。也可以是一个（x，y，height，width）元组，也可以是一个Rect对象，Rect对象可以理解为有位置有大小的矩形。</p>
<p>pygame的坐标体系中以左上角为原点，向右向下两个方向作x轴y轴，构成坐标（x，y），注意是被画的B对象的左上角，如果这个对象是屏幕，那就是屏幕的左上角了。如果传入一个Rect对象给dest，那么blit()会使用传入Rect对象的左上角坐标，而忽略Rect的宽和高。例如：</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs crystal">screen = pygame.display.set_mode(<span class="hljs-number">200</span>,<span class="hljs-number">200</span>)<br>rect=image.get_rect()<br>rect.x=<span class="hljs-number">10</span><br>rect.y=<span class="hljs-number">10</span><br>screen.blit(image, rect)	<span class="hljs-comment">#效果同上边代码</span><br></code></pre></td></tr></table></figure>
<p>blit方法的第3和第4个参数都有默认值，实际使用中可以不使用这两个参数。可选参数area是一个Rect对象，表示从source的area区域取出图像绘制到screen上。</p>
<p><strong>重构</strong></p>
<p>在大型项目中，经常需要在添加新代码前重构既有代码。重构旨在简化代码结构，把一大段代码分割成多个不同的函数，易于扩展和管理。本节将把越来越长的方法 run_game() 拆分成两个辅助方法（helper method）。辅助方法在 类中执行任务，但并非是通过实例调用的。在Python中，辅助方法的名称以单个下划线打头。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> pygame<br><span class="hljs-keyword">from</span> ship <span class="hljs-keyword">import</span> Ship<br><span class="hljs-keyword">from</span> settings <span class="hljs-keyword">import</span> Settings<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">AlienInvasion</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        pygame.init()<br>        self.settings=Settings()<br>        self.screen=pygame.display.set_mode((self.settings.screen_width,self.settings.screen_height))<br>        pygame.display.set_caption(<span class="hljs-string">&quot;Alien Invasion&quot;</span>)<br>        self.ship = Ship(self)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run_game</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            self._check_events()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_check_events</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">for</span> event <span class="hljs-keyword">in</span> pygame.event.get():<br>            <span class="hljs-keyword">if</span> event.<span class="hljs-built_in">type</span> == pygame.QUIT:<br>                sys.exit()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_update_screen</span>(<span class="hljs-params">self</span>):<br>        self.screen.fill((self.settings.bg_color))<br>        self.ship.blitme()<br>        pygame.display.flip()<br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    ai=AlienInvasion()<br>    ai.run_game()<br></code></pre></td></tr></table></figure>
<p><strong>驾驶飞船</strong></p>
<p>下面来编写代码，在用户按左或右箭头键时做出响应。</p>
<p>a. 响应按键</p>
<p>每当用户执行动作时，都会在Pygame中注册一个事件，事件都是通过方法pygame.event.get() 获取的，因此需要在方法 _check_events() 中指定要检查哪些类型的事件。每次按键都被注册为一个KEYDOWN 事件。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">_check_events</span>(<span class="hljs-params">self</span>):<br>    <span class="hljs-keyword">for</span> event <span class="hljs-keyword">in</span> pygame.event.get():<br>        <span class="hljs-keyword">if</span> event.<span class="hljs-built_in">type</span> == pygame.QUIT:<br>            sys.exit()<br>        <span class="hljs-keyword">elif</span> event.<span class="hljs-built_in">type</span>==pygame.KEYDOWN:<br>            <span class="hljs-keyword">if</span> event.key==pygame.K_RIGHT:<br>                self.ship.rect.x+=<span class="hljs-number">1</span><br>            <span class="hljs-keyword">elif</span> event.key==pygame.K_LEFT:<br>                self.ship.rect.x-=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>
<p>b. 允许持续移动</p>
<p>玩家按住右键不放时，我们希望飞船不断向右移动，直到玩家松开为止。我们将让游戏检测<code>pygame.KEYUP</code>事件，以便知道玩家何时松开右键。然后，结合使用<code>KEYDOWN</code>和<code>KEYUP</code>事件以及一个名为<code>moving_right</code> 和<code>moving_left</code>的标志来实现持续移动。</p>
<p>当标志为False 时，飞船不会移动。玩家按下右键时，我们将该标志设置为True ，在玩家松开时将该标志重新设置为False 。</p>
<p>飞船的属性都由Ship 类控制，因此要给这个类添加一个名为<code>moving_right</code> 和<code>moving_left</code>的属性以及一个名为<code>update()</code> 的方法。方法<code>update()</code>检查标志的状态，在while 循环中调用这个方法，以调整飞船的位置。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">_check_events</span>(<span class="hljs-params">self</span>):<br>    <span class="hljs-keyword">for</span> event <span class="hljs-keyword">in</span> pygame.event.get():<br>        <span class="hljs-keyword">if</span> event.<span class="hljs-built_in">type</span> == pygame.QUIT:<br>            sys.exit()<br>        <span class="hljs-keyword">elif</span> event.<span class="hljs-built_in">type</span>==pygame.KEYDOWN:<br>            <span class="hljs-keyword">if</span> event.key==pygame.K_RIGHT:<br>                self.ship.moving_right=<span class="hljs-literal">True</span><br>            <span class="hljs-keyword">elif</span> event.key==pygame.K_LEFT:<br>                self.ship.moving_left=<span class="hljs-literal">True</span><br>        <span class="hljs-keyword">elif</span> event.<span class="hljs-built_in">type</span>==pygame.KEYUP:<br>            self.ship.moving_left=<span class="hljs-literal">False</span><br>            self.ship.moving_right=<span class="hljs-literal">False</span><br></code></pre></td></tr></table></figure>
<p>如果在keyup时让左右键标志都置为False的话，当同时按下左右键，只要松开其中一个飞机就停止动作了，这种游戏机制太严格了，还是分别检测吧。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">_check_events</span>(<span class="hljs-params">self</span>):<br>    <span class="hljs-keyword">for</span> event <span class="hljs-keyword">in</span> pygame.event.get():<br>        <span class="hljs-keyword">if</span> event.<span class="hljs-built_in">type</span> == pygame.QUIT:<br>            sys.exit()<br>        <span class="hljs-keyword">elif</span> event.<span class="hljs-built_in">type</span>==pygame.KEYDOWN:<br>            <span class="hljs-keyword">if</span> event.key==pygame.K_RIGHT:<br>                self.ship.moving_right=<span class="hljs-literal">True</span><br>            <span class="hljs-keyword">elif</span> event.key==pygame.K_LEFT:<br>                self.ship.moving_left=<span class="hljs-literal">True</span><br>        <span class="hljs-keyword">elif</span> event.<span class="hljs-built_in">type</span>==pygame.KEYUP:<br>            <span class="hljs-keyword">if</span> event.key == pygame.K_RIGHT:<br>                self.ship.moving_right = <span class="hljs-literal">False</span><br>            <span class="hljs-keyword">elif</span> event.key == pygame.K_LEFT:<br>                self.ship.moving_left = <span class="hljs-literal">False</span><br></code></pre></td></tr></table></figure>
<p>Ship类：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pygame<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Ship</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,ai_game</span>):<br>        self.screen=ai_game.screen<br>        self.screen_rect=ai_game.screen.get_rect()<br>        self.proto=pygame.image.load(<span class="hljs-string">&#x27;airsvg.svg&#x27;</span>)<br>        self.image=pygame.transform.scale(self.proto,(<span class="hljs-number">200</span>,<span class="hljs-number">100</span>))<br>        self.rect = self.image.get_rect()<br>        self.rect.midbottom = self.screen_rect.midbottom<br>        self.moving_right=<span class="hljs-literal">False</span><br>        self.moving_left=<span class="hljs-literal">False</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">blitme</span>(<span class="hljs-params">self</span>):<br>        self.screen.blit(self.image, self.rect)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">update</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">if</span> self.moving_right:<br>            self.rect.x+=<span class="hljs-number">1</span><br>        <span class="hljs-keyword">elif</span> self.moving_left:<br>            self.rect.x-=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>
<p><strong>调整飞船的速度</strong></p>
<p>当前，每次执行while 循环时，飞船最多移动1像素，但可 在Settings 类中添加属性ship_speed ，用于控制飞船的速度。使用函数float() 将速度的值转换为小数，才能准确进行运算 。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Settings</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.screen_width=<span class="hljs-number">1200</span><br>        self.screen_height=<span class="hljs-number">800</span><br>        self.bg_color=(<span class="hljs-number">230</span>, <span class="hljs-number">230</span>, <span class="hljs-number">230</span>)<br>        self.ship_speed=<span class="hljs-number">1.5</span><br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pygame<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Ship</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,ai_game</span>):<br>        self.screen=ai_game.screen<br>        self.screen_rect=ai_game.screen.get_rect()<br>        self.proto=pygame.image.load(<span class="hljs-string">&#x27;airsvg.svg&#x27;</span>)<br>        self.image=pygame.transform.scale(self.proto,(<span class="hljs-number">200</span>,<span class="hljs-number">100</span>))<br>        self.rect = self.image.get_rect()<br>        self.rect.midbottom = self.screen_rect.midbottom<br>        self.moving_right=<span class="hljs-literal">False</span><br>        self.moving_left=<span class="hljs-literal">False</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">blitme</span>(<span class="hljs-params">self</span>):<br>        self.screen.blit(self.image, self.rect)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">update</span>(<span class="hljs-params">self,speed</span>):<br>        <span class="hljs-keyword">if</span> self.moving_right:<br>            self.rect.x+=<span class="hljs-built_in">float</span>(speed)<br>        <span class="hljs-keyword">elif</span> self.moving_left:<br>            self.rect.x-=<span class="hljs-built_in">float</span>(speed)<br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> pygame<br><span class="hljs-keyword">from</span> ship <span class="hljs-keyword">import</span> Ship<br><span class="hljs-keyword">from</span> settings <span class="hljs-keyword">import</span> Settings<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">AlienInvasion</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        pygame.init()<br>        self.settings=Settings()<br>        self.screen=pygame.display.set_mode((self.settings.screen_width,self.settings.screen_height))<br>        pygame.display.set_caption(<span class="hljs-string">&quot;Alien Invasion&quot;</span>)<br>        self.ship = Ship(self)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run_game</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            self._check_events()<br>            self.ship.update(self.settings.ship_speed)<br>            self._update_screen()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_check_events</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">for</span> event <span class="hljs-keyword">in</span> pygame.event.get():<br>            <span class="hljs-keyword">if</span> event.<span class="hljs-built_in">type</span> == pygame.QUIT:<br>                sys.exit()<br>            <span class="hljs-keyword">elif</span> event.<span class="hljs-built_in">type</span>==pygame.KEYDOWN:<br>                <span class="hljs-keyword">if</span> event.key==pygame.K_RIGHT:<br>                    self.ship.moving_right=<span class="hljs-literal">True</span><br>                <span class="hljs-keyword">elif</span> event.key==pygame.K_LEFT:<br>                    self.ship.moving_left=<span class="hljs-literal">True</span><br>            <span class="hljs-keyword">elif</span> event.<span class="hljs-built_in">type</span>==pygame.KEYUP:<br>                <span class="hljs-keyword">if</span> event.key == pygame.K_RIGHT:<br>                    self.ship.moving_right = <span class="hljs-literal">False</span><br>                <span class="hljs-keyword">elif</span> event.key == pygame.K_LEFT:<br>                    self.ship.moving_left = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_update_screen</span>(<span class="hljs-params">self</span>):<br>        self.screen.fill((self.settings.bg_color))<br>        self.ship.blitme()<br>        pygame.display.flip()<br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    ai=AlienInvasion()<br>    ai.run_game()<br></code></pre></td></tr></table></figure>
<p><strong>限制飞船的活动范围</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">update</span>(<span class="hljs-params">self,speed</span>):<br>    <span class="hljs-keyword">if</span> self.moving_right <span class="hljs-keyword">and</span> self.rect.right&lt;<span class="hljs-number">1200</span>:<br>        self.rect.x+=<span class="hljs-built_in">float</span>(speed)<br>    <span class="hljs-keyword">elif</span> self.moving_left <span class="hljs-keyword">and</span> self.rect.left&gt;<span class="hljs-number">0</span>:<br>        self.rect.x-=<span class="hljs-built_in">float</span>(speed)<br></code></pre></td></tr></table></figure>
<p>随着游戏的开发，方法_check_events() 将越来越长。因此将其部分代码放在两个方法中，其中一个处理KEYDOWN 事件，另一个处理KEYUP 事件。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">_check_events</span>(<span class="hljs-params">self</span>):<br>    <span class="hljs-keyword">for</span> event <span class="hljs-keyword">in</span> pygame.event.get():<br>        <span class="hljs-keyword">if</span> event.<span class="hljs-built_in">type</span> == pygame.QUIT:<br>            sys.exit()<br>        <span class="hljs-keyword">elif</span> event.<span class="hljs-built_in">type</span>==pygame.KEYDOWN:<br>            self._check_keydown_events(event)<br>        <span class="hljs-keyword">elif</span> event.<span class="hljs-built_in">type</span>==pygame.KEYUP:<br>            self._check_keyup_events(event)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">_check_keydown_events</span>(<span class="hljs-params">self, event</span>):<br>    <span class="hljs-keyword">if</span> event.key == pygame.K_RIGHT:<br>        self.ship.moving_right = <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">elif</span> event.key == pygame.K_LEFT:<br>        self.ship.moving_left = <span class="hljs-literal">True</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">_check_keyup_events</span>(<span class="hljs-params">self, event</span>):<br>    <span class="hljs-keyword">if</span> event.key == pygame.K_RIGHT:<br>        self.ship.moving_right = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">elif</span> event.key == pygame.K_LEFT:<br>        self.ship.moving_left = <span class="hljs-literal">False</span><br></code></pre></td></tr></table></figure>
<p><strong>全屏模式</strong></p>
<p>要在全屏模式下运行该游戏，可在<code>__init()__</code>中做如下修改：</p>
<p>创建屏幕时传入尺寸(0, 0) 以及参数<code>pygame.FULLSCREEN</code>。这让Pygame生成一个覆盖整个显示器的屏幕。由于无法预先知道屏幕的宽度和高度，要在创建屏幕后更新这些设置：使用屏幕的rect 的属性width 和height 来更新对象settings 。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>    pygame.init()<br>    self.settings=Settings()<br>    self.screen=pygame.display.set_mode((<span class="hljs-number">0</span>,<span class="hljs-number">0</span>),pygame.FULLSCREEN)<br>    self.settings.screen_width=self.screen.get_rect().width<br>    self.settings.screen_height=self.screen.get_rect().height<br>    pygame.display.set_caption(<span class="hljs-string">&quot;Alien Invasion&quot;</span>)<br>    self.ship = Ship(self)<br></code></pre></td></tr></table></figure>
<p>注意：在全屏模式下运行这款游戏之前，请确认能够按Q键退出，因为Pygame默认不提供在全屏模式下退出游戏的方式。</p>
<p><strong>射击</strong></p>
<p>我们将编写在玩家按空格键时发射子弹的代码，子弹将在屏幕中向上飞行，抵达屏幕上边缘 后消失。</p>
<p>a. 添加子弹设置</p>
<p>首先，更新settings.py，存储新类Bullet 所需的值：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>	--snip-<br>	<span class="hljs-comment"># 子弹设置 </span><br>	self.bullet_speed = <span class="hljs-number">1.0</span> <br>	self.bullet_width = <span class="hljs-number">3</span> <br>	self.bullet_height = <span class="hljs-number">15</span> <br>	self.bullet_color = (<span class="hljs-number">60</span>, <span class="hljs-number">60</span>, <span class="hljs-number">60</span>)<br></code></pre></td></tr></table></figure>
<p>b. 创建Bullet 类</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pygame <br><span class="hljs-keyword">from</span> pygame.sprite <span class="hljs-keyword">import</span> Sprite<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Bullet</span>(<span class="hljs-title class_ inherited__">Sprite</span>):<br>	<span class="hljs-string">&quot;&quot;&quot;管理飞船所发射子弹的类&quot;&quot;&quot;</span><br>	<span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, ai_game</span>):<br>		<span class="hljs-string">&quot;&quot;&quot;在飞船当前位置创建一个子弹对象。&quot;&quot;&quot;</span> <br>		<span class="hljs-built_in">super</span>().__init__() <br>		self.screen = ai_game.screen <br>		self.settings = ai_game.settings <br>		self.color = self.settings.bullet_color<br>		<span class="hljs-comment">#在(0,0)处创建一个表示子弹的矩形，再设置正确的位置。 </span><br>		self.rect = pygame.Rect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <br>		self.settings.bullet_width, 			<br>		self.settings.bullet_height) <br>		self.rect.midtop = ai_game.ship.rect.midtop<br>		<span class="hljs-comment"># 存储用小数表示的子弹位置。 </span><br>		self.y = <span class="hljs-built_in">float</span>(self.rect.y)<br></code></pre></td></tr></table></figure>
<p>Bullet 类继承了Sprite 类。通过使用精灵（sprite），可将游戏中相关的元素编组，进而同时用for循环操作编组中的所有元素。<code>pygame.sprite.group</code>中的一个值得注意的method是<code>draw(surface)</code>，可以直接将group里面的每一个sprite对象在surface上通过<code>surface.blit()</code>操作进行绘制，见下例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#创建一个sprite类实例aliens</span><br>aliens.draw(screen)<br><span class="hljs-keyword">for</span> alien <span class="hljs-keyword">in</span> aliens.sprites():<br>    screen.blit(alien.image, alien.rect)<br></code></pre></td></tr></table></figure>
<p>本例中，先调用super() 来继承Sprite，再创建子弹属性的rect</p>
<p>因为子弹并非基于图像，所以必须使用pygame.Rect() 类从头开始创建一个矩形。创建这个类的实例 时，必须提供矩形左上角的x坐标和y坐标，以及矩形的宽度和高度。我们在(0, 0)处创建这个矩形，但下一行代码就将其移到了正确的位置，因为子弹的初始位置取决于飞船当前的位置。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Bullet</span>(<span class="hljs-title class_ inherited__">Sprite</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,ai_game</span>):<br>        <span class="hljs-built_in">super</span>().__init__()<br>        self.screen=ai_game.screen<br>        self.settings=ai_game.settings<br>        self.color = self.settings.bullet_color<br>        self.rect = pygame.Rect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, self.settings.bullet_width, self.settings.bullet_height)<br>        self.rect.midtop = ai_game.ship.rect.midtop<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">update</span>(<span class="hljs-params">self</span>):<br>        self.rect.y-=self.settings.bullet_speed<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">draw_bullet</span>(<span class="hljs-params">self</span>):<br>        pygame.draw.ellipse(self.screen, self.color, self.rect)<br></code></pre></td></tr></table></figure>
<p>c. 将子弹存储到编组中</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>	--snip-<br>	self.ship = Ship(self)<br>	self.bullets = pygame.sprite.Group()<br></code></pre></td></tr></table></figure>
<p>然后在while 循环中更新子弹的位置：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">run_game</span>(<span class="hljs-params">self</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        self._check_events()<br>        self.ship.update(self.settings.ship_speed,self.settings.screen_width)<br>        self.bullets.update()<br>        self._update_screen()<br></code></pre></td></tr></table></figure>
<p>d. Fire</p>
<p>e. 删除屏幕外的子弹</p>
<p>使用for循环遍历Pygame编组时，Python要求该列表的长度在整个循环中保持不变。因此不能从for 循环遍历的列表或编组中删除元素，所以必须遍历编组的副本。</p>
<p>我们使用方法copy() 来设置for 循环，从而能够在循环中修改bullets 。</p>
<p>f. 限制子弹数量</p>
<p>将未消失的子弹数限制为三颗，在创建新子弹前检查未消失的子弹数是否小于该设置：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">_fire_bullet</span>(<span class="hljs-params">self</span>):<br>	<span class="hljs-string">&quot;&quot;&quot;创建新子弹并将其加入编组bullets中。&quot;&quot;&quot;</span><br>	<span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self.bullets) &lt; self.settings.bullets_allowed:<br>		new_bullet = Bullet(self) self.bullets.add(new_bullet)<br></code></pre></td></tr></table></figure>
<p>g. 让主循环包含尽可能少的代码</p>
<p>把run_game() 中while 循环里带模块的代码都写到单独的函数里</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> pygame<br><span class="hljs-keyword">from</span> ship <span class="hljs-keyword">import</span> Ship<br><span class="hljs-keyword">from</span> settings <span class="hljs-keyword">import</span> Settings<br><span class="hljs-keyword">from</span> settings <span class="hljs-keyword">import</span> Bullet<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">AlienInvasion</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        pygame.init()<br>        self.settings=Settings()<br>        <span class="hljs-comment">#self.screen=pygame.display.set_mode((self.settings.screen_width,self.settings.screen_height))</span><br>        self.screen=pygame.display.set_mode((<span class="hljs-number">0</span>,<span class="hljs-number">0</span>),pygame.FULLSCREEN)<br>        self.settings.screen_width=self.screen.get_rect().width<br>        self.settings.screen_height=self.screen.get_rect().height<br>        pygame.display.set_caption(<span class="hljs-string">&quot;Alien Invasion&quot;</span>)<br>        self.ship = Ship(self)<br>        self.bullets=pygame.sprite.Group()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run_game</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            self._check_events()<br>            self.ship.update(self.settings.ship_speed,self.settings.screen_width)<br>            self.bullets.update()<br>            self._update_bullets()<br>            self._update_screen()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_check_events</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">for</span> event <span class="hljs-keyword">in</span> pygame.event.get():<br>            <span class="hljs-keyword">if</span> event.<span class="hljs-built_in">type</span> == pygame.QUIT:<br>                sys.exit()<br>            <span class="hljs-keyword">elif</span> event.<span class="hljs-built_in">type</span>==pygame.KEYDOWN:<br>                self._check_keydown_events(event)<br>            <span class="hljs-keyword">elif</span> event.<span class="hljs-built_in">type</span>==pygame.KEYUP:<br>                self._check_keyup_events(event)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_check_keydown_events</span>(<span class="hljs-params">self, event</span>):<br>        <span class="hljs-keyword">if</span> event.key == pygame.K_RIGHT:<br>            self.ship.moving_right = <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">elif</span> event.key == pygame.K_LEFT:<br>            self.ship.moving_left = <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">elif</span> event.key==pygame.K_q:<br>            sys.exit()<br>        <span class="hljs-keyword">elif</span> event.key==pygame.K_SPACE:<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self.bullets)&lt;self.settings.bullets_allowed:<br>                self._fire_bullet()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_check_keyup_events</span>(<span class="hljs-params">self, event</span>):<br>        <span class="hljs-keyword">if</span> event.key == pygame.K_RIGHT:<br>            self.ship.moving_right = <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">elif</span> event.key == pygame.K_LEFT:<br>            self.ship.moving_left = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_fire_bullet</span>(<span class="hljs-params">self</span>):<br>        new_bullet=Bullet(self)<br>        self.bullets.add((new_bullet))<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_update_screen</span>(<span class="hljs-params">self</span>):<br>        self.screen.fill((self.settings.bg_color))<br>        self.ship.blitme()<br>        <span class="hljs-keyword">for</span> bullet <span class="hljs-keyword">in</span> self.bullets.sprites():<br>            bullet.draw_bullet()<br>        pygame.display.flip()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_update_bullets</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">for</span> bullet <span class="hljs-keyword">in</span> self.bullets.copy():<br>            <span class="hljs-keyword">if</span> bullet.rect.bottom &lt; <span class="hljs-number">0</span>:<br>                self.bullets.remove(bullet)<br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    ai=AlienInvasion()<br>    ai.run_game()<br></code></pre></td></tr></table></figure>
<h3 id="项目二：外星人生成"><a href="#项目二：外星人生成" class="headerlink" title="项目二：外星人生成"></a>项目二：外星人生成</h3><p>我们将首先在屏幕上边缘附近添加一个外星人，再生成一群外星人。然后让这群外星人向两边和下面移动，并删除被子弹击中的外星人。最后，显示玩家拥有的飞船数量，并在玩家的飞船用完后结束游戏。</p>

              
            </div>
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Python/" class="category-chain-item">Python</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Python%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">#Python基础知识</a>
      
    </div>
  
</div>


              

              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/09/13/Python-Day05/" title="Python Day05">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Python Day05</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/09/08/Python-Day03/" title="Python Day03">
                        <span class="hidden-mobile">Python Day03</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  <article id="comments" lazyload>
    
  <div id="vcomment" class="comment"></div> 
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script>
  <script>
    var notify = '' == true ? true : false;
    var verify = '' == true ? true : false;
      window.onload = function() {
          new Valine({
              el: '#vcomment',
              app_id: "AwHBUAjSP1GvDVpiBgxfS2Pg-gzGzoHsz",
              app_key: "kMsGLN3hzkQJuLrmqQBgquFF",
              placeholder: "说点什么",
              avatar:"retro",
              visitor: true       

          });
      }
  </script>

 
  <noscript>Please enable JavaScript to view the comments</noscript>



  </article>


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;Table of Contents</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  




  
  








    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  

  

  

  

  

  

  
    
  




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script>
  (function() {
    var enableLang = CONFIG.code_language.enable && CONFIG.code_language.default;
    var enableCopy = CONFIG.copy_btn;
    if (!enableLang && !enableCopy) {
      return;
    }

    function getBgClass(ele) {
      return Fluid.utils.getBackgroundLightness(ele) >= 0 ? 'code-widget-light' : 'code-widget-dark';
    }

    var copyTmpl = '';
    copyTmpl += '<div class="code-widget">';
    copyTmpl += 'LANG';
    copyTmpl += '</div>';
    jQuery('.markdown-body pre').each(function() {
      var $pre = jQuery(this);
      if ($pre.find('code.mermaid').length > 0) {
        return;
      }
      if ($pre.find('span.line').length > 0) {
        return;
      }

      var lang = '';

      if (enableLang) {
        lang = CONFIG.code_language.default;
        if ($pre[0].children.length > 0 && $pre[0].children[0].classList.length >= 2 && $pre.children().hasClass('hljs')) {
          lang = $pre[0].children[0].classList[1];
        } else if ($pre[0].getAttribute('data-language')) {
          lang = $pre[0].getAttribute('data-language');
        } else if ($pre.parent().hasClass('sourceCode') && $pre[0].children.length > 0 && $pre[0].children[0].classList.length >= 2) {
          lang = $pre[0].children[0].classList[1];
          $pre.parent().addClass('code-wrapper');
        } else if ($pre.parent().hasClass('markdown-body') && $pre[0].classList.length === 0) {
          $pre.wrap('<div class="code-wrapper"></div>');
        }
        lang = lang.toUpperCase().replace('NONE', CONFIG.code_language.default);
      }
      $pre.append(copyTmpl.replace('LANG', lang).replace('code-widget">',
        getBgClass($pre[0]) + (enableCopy ? ' code-widget copy-btn" data-clipboard-snippet><i class="iconfont icon-copy"></i>' : ' code-widget">')));

      if (enableCopy) {
        Fluid.utils.createScript('https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js', function() {
          var clipboard = new window.ClipboardJS('.copy-btn', {
            target: function(trigger) {
              var nodes = trigger.parentNode.childNodes;
              for (var i = 0; i < nodes.length; i++) {
                if (nodes[i].tagName === 'CODE') {
                  return nodes[i];
                }
              }
            }
          });
          clipboard.on('success', function(e) {
            e.clearSelection();
            e.trigger.innerHTML = e.trigger.innerHTML.replace('icon-copy', 'icon-success');
            setTimeout(function() {
              e.trigger.innerHTML = e.trigger.innerHTML.replace('icon-success', 'icon-copy');
            }, 2000);
          });
        });
      }
    });
  })();
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  
      <script>
        MathJax = {
          tex    : {
            inlineMath: { '[+]': [['$', '$']] }
          },
          loader : {
            load: ['ui/lazy']
          },
          options: {
            renderActions: {
              findScript    : [10, doc => {
                document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
                  const display = !!node.type.match(/; *mode=display/);
                  const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                  const text = document.createTextNode('');
                  node.parentNode.replaceChild(text, node);
                  math.start = { node: text, delim: '', n: 0 };
                  math.end = { node: text, delim: '', n: 0 };
                  doc.math.push(math);
                });
              }, '', false],
              insertedScript: [200, () => {
                document.querySelectorAll('mjx-container').forEach(node => {
                  let target = node.parentNode;
                  if (target.nodeName.toLowerCase() === 'li') {
                    target.parentNode.classList.add('has-jax');
                  }
                });
              }, '', false]
            }
          }
        };
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.1/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>

  <script defer src="/js/leancloud.js" ></script>




  
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/yinghua.js"></script>
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/xiantiao.js"></script>
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/xiaoxingxing.js"></script>
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/caidai.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/z16.model.json"},"display":{"position":"right","width":150,"height":300,"hOffset":-15,"vOffset":-15},"mobile":{"show":true},"react":{"opacity":0.7},"log":false});</script></body>
</html>
