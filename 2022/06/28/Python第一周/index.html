

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=light>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/icon.jpg">
  <link rel="icon" href="/img/icon.jpg">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="第 1 章    起步 查看python版本python3 -V 退出Python并返回到终端窗口， Ctrl + D或执行命令exit()  文件名使用小写字母，并用下划线代替空格，因为Python采用了这些命名约定  ⌘+B运行程序   第 2 章　变量和简单数据类型Python只记录变量的最新值。 变量名只能包含字母（最好是小写）、数字和下划线。 变量是标签： 变量常被描述为可用于存储值的">
<meta property="og:type" content="article">
<meta property="og:title" content="Python基础">
<meta property="og:url" content="http://example.com/2022/06/28/Python%E7%AC%AC%E4%B8%80%E5%91%A8/index.html">
<meta property="og:site_name" content="摸鱼之家">
<meta property="og:description" content="第 1 章    起步 查看python版本python3 -V 退出Python并返回到终端窗口， Ctrl + D或执行命令exit()  文件名使用小写字母，并用下划线代替空格，因为Python采用了这些命名约定  ⌘+B运行程序   第 2 章　变量和简单数据类型Python只记录变量的最新值。 变量名只能包含字母（最好是小写）、数字和下划线。 变量是标签： 变量常被描述为可用于存储值的">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/img/photo30.jpeg">
<meta property="article:published_time" content="2022-06-28T07:38:33.000Z">
<meta property="article:modified_time" content="2022-11-07T18:08:21.495Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="Python基础知识">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/img/photo30.jpeg">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>Python基础 - 摸鱼之家</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/bynotes/texiao/source/css/shubiao.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.1","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":false},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"AwHBUAjSP1GvDVpiBgxfS2Pg-gzGzoHsz","app_key":"kMsGLN3hzkQJuLrmqQBgquFF","server_url":"https://awhbuajs.lc-cn-n1-shared.com","path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>

  
<meta name="generator" content="Hexo 5.4.2"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>快乐老家</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                主页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                档案馆
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                目录
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                友链
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/photo30.jpeg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Python基础"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-06-28 15:38" pubdate>
          June 28, 2022 pm
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          67k words
        
      </span>
    

    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> views
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Python基础</h1>
            
              <p class="note note-info">
                
                  
                    Last updated on 3 days ago
                  
                
              </p>
            
            <div class="markdown-body">
              
              <hr>
<h3 id="第-1-章-起步"><a href="#第-1-章-起步" class="headerlink" title="第 1 章    起步"></a>第 1 章    起步</h3><ul>
<li>查看python版本<code>python3 -V</code></li>
<li><p>退出Python并返回到终端窗口， <code>Ctrl + D</code>或执行命令<code>exit()</code></p>
</li>
<li><p>文件名使用小写字母，并用下划线代替空格，因为Python采用了这些命名约定</p>
</li>
<li><p>⌘+B运行程序</p>
</li>
</ul>
<h3 id="第-2-章-变量和简单数据类型"><a href="#第-2-章-变量和简单数据类型" class="headerlink" title="第 2 章　变量和简单数据类型"></a>第 2 章　变量和简单数据类型</h3><p>Python只记录变量的<strong>最新值</strong>。</p>
<p>变量名只能包含<strong>字母（最好是小写）、数字和下划线</strong>。</p>
<p><strong>变量是标签：</strong></p>
<p>变量常被描述为可用于存储值的盒子。变量是可以赋给值的标签，也可以说变量指向特定的值。</p>
<p><strong>字符串就是一系列字符：</strong></p>
<p>在Python中，用<strong>引号括起的都是字符串</strong>。</p>
<p><strong>字符串的大小写方法：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">name = <span class="hljs-string">&quot;ada lovelace&quot;</span> <br><span class="hljs-built_in">print</span>(name.title())//首字母大写<br><span class="hljs-built_in">print</span>(name.upper())//全部大写<br><span class="hljs-built_in">print</span>(name.lower())//全部小写<br></code></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">Ada Lovelace</span><br><span class="hljs-attribute">ADA LOVELACE </span><br><span class="hljs-attribute">ada lovelace</span><br></code></pre></td></tr></table></figure>
<p><strong>在字符串中使用变量：</strong></p>
<p><strong>在字符串中插入变量的值，可在前引号前加上字母f</strong> ，再将要插入的变量放在花括号内，f是format（设置格式）的简写。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">first_name=<span class="hljs-string">&quot;ada&quot;</span><br>last_name=<span class="hljs-string">&quot;lovelace&quot;</span><br>full_name=<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;first_name&#125;</span> <span class="hljs-subst">&#123;last_name&#125;</span>&quot;</span><br><span class="hljs-built_in">print</span>(full_name)<br></code></pre></td></tr></table></figure>
<p>练习2-3：个性化消息 　</p>
<p>用变量表示一个人的名字，并向其显示一 条消息。显示的消息应非常简单，下面是一个例子。</p>
<p>Hello Eric, would you like to learn some Python today?</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">name=<span class="hljs-string">&quot;eric&quot;</span><br>word=<span class="hljs-string">f&quot;Hello <span class="hljs-subst">&#123;name&#125;</span>, would you like to learn some Python today?&quot;</span><br><span class="hljs-built_in">print</span>(word)<br></code></pre></td></tr></table></figure>
<p><strong>制表符或换行符：</strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">制表符</th>
<th style="text-align:center">\t</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">换行符</td>
<td style="text-align:center">\n</td>
</tr>
<tr>
<td style="text-align:center">换行后添加一个制表符</td>
<td style="text-align:center">\n\t</td>
</tr>
</tbody>
</table>
</div>
<p><strong>删除空白：</strong></p>
<p>去掉字符串右边空白，使用方法rstrip() ，左边空白使用lstrip()，去掉全部空白使用strip()。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>favorite_language = <span class="hljs-string">&#x27;python &#x27;</span> <br><span class="hljs-meta">&gt;&gt;&gt; </span>favorite_language<br><span class="hljs-string">&#x27;python &#x27;</span> <br><span class="hljs-meta">&gt;&gt;&gt; </span>favorite_language.rstrip()<br><span class="hljs-string">&#x27;python&#x27;</span> <br><span class="hljs-meta">&gt;&gt;&gt; </span>favorite_language<br><span class="hljs-string">&#x27;python &#x27;</span><br></code></pre></td></tr></table></figure>
<p>对变量favorite_language 调用方法rstrip() 后，多余的空格被删除了。但这种删除只是暂时的，接下来再次询问favorite_language 的值时，你会发现这个字符串与输入时一样，依然包含多余的空白。</p>
<p><strong>要永久删除这个字符串中的空白，必须将删除操作的结果关联到变量：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>favorite_language = <span class="hljs-string">&#x27;python &#x27;</span><br><span class="hljs-meta">&gt;&gt;&gt; </span>favorite_language = favorite_language.rstrip() &gt;&gt;&gt; favorite_language <span class="hljs-string">&#x27;python&#x27;</span><br></code></pre></td></tr></table></figure>
<p><strong>整数</strong></p>
<ul>
<li><p>在Python中，可对整数执行加（+ ）减（- ）乘（* ）除（/ ）运算。</p>
</li>
<li><p>用两个乘号表示乘方运算。</p>
</li>
<li><p>Python支持运算次序。</p>
</li>
</ul>
<p><strong>浮点数</strong></p>
<p>Python将所有带小数点的数称为浮点数 。</p>
<p>从很大程度上说，使用浮点数时无须考虑其行为。你只需输入要使用的数，Python通常会按你期望的方式处理它们，但需要注意的是，结果包含的小数位数可能是不确定的：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-number">0.2</span>+<span class="hljs-number">0.1</span><br><span class="hljs-number">0.30000000000000004</span><br><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-number">3</span>*<span class="hljs-number">0.1</span><br><span class="hljs-number">0.30000000000000004</span><br></code></pre></td></tr></table></figure>
<p><strong>整数和浮点数</strong></p>
<ul>
<li>将任意两个数相除时，结果总是浮点数，即便这两个数都是整数且能整除。</li>
<li>在其他任何运算中，如果一个操作数是整数，另一个操作数是浮点数， 结果也总是浮点数。</li>
</ul>
<p><strong>数中的下划线</strong></p>
<p>书写很大的数时，可使用下划线将其中的数字分组，使其更清晰易读：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>universe_age = <span class="hljs-number">14_000_000_000</span><br></code></pre></td></tr></table></figure>
<p>当你打印这种使用下划线定义的数时，Python不会打印其中的下划线：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(universe_age) <span class="hljs-number">14000000000</span><br></code></pre></td></tr></table></figure>
<p><strong>在一行内同时给多个变量赋值：</strong></p>
<p>例如，下面演示了如何将变量x 、y 和z 都初始化为零：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">x,y,z=<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span><br><span class="hljs-built_in">print</span>(x)<br><span class="hljs-built_in">print</span>(y)<br><span class="hljs-built_in">print</span>(z)<br></code></pre></td></tr></table></figure>
<p>Python将<strong>按顺序将每个值赋给对应的变量。只要变量和值的个数相同，Python就能正确地将它们关联起来。</strong></p>
<p><strong>常量类似于变量：</strong></p>
<p><strong>其值在程序的整个生命周期内保持不变</strong>。Python没有内置的常量类型，但Python程序员会使用全大写来指出应将某个变量视为常量，其值应始终不变：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">MAX_CONNECTIONS = <span class="hljs-number">5000</span><br></code></pre></td></tr></table></figure>
<p><u>在代码中，要指出某个特定的变量视为常量，可将其字母全部大写。</u></p>
<p>在Python中，注释用井号（# ）标识。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 向大家问好。 </span><br></code></pre></td></tr></table></figure>
<h3 id="第-3-章-列表简介"><a href="#第-3-章-列表简介" class="headerlink" title="第 3 章　列表简介"></a>第 3 章　列表简介</h3><p>列表由一系列按特定顺序排列的元素组成。通常给列表指定一个表示复数的名称（如letters 、digits 或names ）。在Python中，用方括号<code>[]</code>表示列表，并用逗号分隔其中的元素。下面是一个简单的列表示例，其中包含几种自行车：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">bicycles = [<span class="hljs-string">&#x27;trek&#x27;</span>, <span class="hljs-string">&#x27;cannondale&#x27;</span>, <span class="hljs-string">&#x27;redline&#x27;</span>, <span class="hljs-string">&#x27;specialized&#x27;</span>]<br></code></pre></td></tr></table></figure>
<p>Python将打印列表的固定格式如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">[<span class="hljs-string">&#x27;trek&#x27;</span>, <span class="hljs-string">&#x27;cannondale&#x27;</span>, <span class="hljs-string">&#x27;redline&#x27;</span>, <span class="hljs-string">&#x27;specialized&#x27;</span>]<br></code></pre></td></tr></table></figure>
<p><strong>访问列表元素</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(bicycles[<span class="hljs-number">0</span>])<br></code></pre></td></tr></table></figure>
<p><strong>索引从0而不是1开始</strong></p>
<p>Python为访问最后一个列表元素提供了一种特殊语法。<strong>通过将索引指定为-1 ，可让Python返回最后一个列表元素：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">bicycles = [<span class="hljs-string">&#x27;trek&#x27;</span>, <span class="hljs-string">&#x27;cannondale&#x27;</span>, <span class="hljs-string">&#x27;redline&#x27;</span>, <span class="hljs-string">&#x27;specialized&#x27;</span>] <br><span class="hljs-built_in">print</span>(bicycles[-<span class="hljs-number">1</span>])<br></code></pre></td></tr></table></figure>
<p>这段代码返回’specialized’ 。</p>
<p>这种语法很有用，因为你经常需要在不知道列表长度的情况下访问最后的元素。这种约定也适用于其他负数索引。例如，索引-2 返回倒数第二个列表元素，索引-3 返回倒数第三个列表元素，依此类推。</p>
<p><strong>元素增删改查：</strong></p>
<p>1）<strong>在列表末尾添加元素append() </strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">motorcycles = [<span class="hljs-string">&#x27;honda&#x27;</span>, <span class="hljs-string">&#x27;yamaha&#x27;</span>, <span class="hljs-string">&#x27;suzuki&#x27;</span>]<br>motorcycles.append(<span class="hljs-string">&#x27;ducati&#x27;</span>) <br><span class="hljs-built_in">print</span>(motorcycles)<br></code></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scheme">[<span class="hljs-symbol">&#x27;honda</span>&#x27;, <span class="hljs-symbol">&#x27;yamaha</span>&#x27;, <span class="hljs-symbol">&#x27;suzuki</span>&#x27;, <span class="hljs-symbol">&#x27;ducati</span>&#x27;]<br></code></pre></td></tr></table></figure>
<p>方法append() 让动态地创建列表易如反掌。</p>
<p>例如，你可以先创建 一个空列表，再使用一系列函数调用append() 来添加元素。</p>
<p>2）<strong>使用方法insert() 可在列表的任何位置添加新元素</strong>，为此，你需要指定新元素的索引和值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">motorcycles = [<span class="hljs-string">&#x27;honda&#x27;</span>, <span class="hljs-string">&#x27;yamaha&#x27;</span>, <span class="hljs-string">&#x27;suzuki&#x27;</span>]<br>motorcycles.insert(<span class="hljs-number">0</span>, <span class="hljs-string">&#x27;ducati&#x27;</span>) <br></code></pre></td></tr></table></figure>
<p>方法 insert() 在索引0 处添加空间，并将值’ducati’ 存储到这个地 方。这种操作将列表中既有的每个元素都右移一个位置。</p>
<p>3）<strong>使用del 语句删除元素</strong></p>
<p>如果知道要删除的元素在列表中的位置，可使用del 语句。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">del</span> motorcycles[<span class="hljs-number">0</span>]<br></code></pre></td></tr></table></figure>
<p>4）<strong>使用方法pop() 删除末尾元素</strong></p>
<p>方法pop() 删除列表末尾的元素，并让你能够接着使用它。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">motorcycles = [<span class="hljs-string">&#x27;honda&#x27;</span>, <span class="hljs-string">&#x27;yamaha&#x27;</span>, <span class="hljs-string">&#x27;suzuki&#x27;</span>]<br>last_owned = motorcycles.pop() <br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;The last motorcycle I owned was a <span class="hljs-subst">&#123;last_owned.title()&#125;</span>.&quot;</span>)<br></code></pre></td></tr></table></figure>
<p>5）弹出列表中任何位置处的元素</p>
<p>可以使用pop() 来删除列表中任意位置的元素，只需在圆括号中指定要删除元素的索引即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">first_owned = motorcycles.pop(<span class="hljs-number">0</span>)<br></code></pre></td></tr></table></figure>
<p>6）根据值删除元素</p>
<p>有时候，你不知道要从列表中删除的值所处的位置。如果只知道要 删除的元素的值，可使用方法remove() 。</p>
<p>例如，假设要从列表motorcycles 中删除值’ducati’ 。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">motorcycles.remove(<span class="hljs-string">&#x27;ducati&#x27;</span>) <br></code></pre></td></tr></table></figure>
<p>注意：方法remove() 只删除第一个指定的值。如果要删除的值可能在列表中出现多次，就需要使用循环来确保将每个值都删除。</p>
<p><strong>列表排序：</strong></p>
<p>按字母顺序<strong>永久</strong>排列<code>sort()</code>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">cars.sort()<br></code></pre></td></tr></table></figure>
<p>列表顺序被永久改变，<strong>再也无法恢复到原来的排列顺序</strong>。</p>
<p>按与字母顺序相反的顺序排列列表元素，只需向<code>sort()</code>方法传递参数<code>reverse=True</code> 即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">cars.sort(reverse=<span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure>
<p>列表<strong>临时</strong>排序<code>sorted</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">cars = [<span class="hljs-string">&#x27;bmw&#x27;</span>, <span class="hljs-string">&#x27;audi&#x27;</span>, <span class="hljs-string">&#x27;toyota&#x27;</span>, <span class="hljs-string">&#x27;subaru&#x27;</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">sorted</span>(cars))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">sorted</span>(cars,reverse=<span class="hljs-literal">True</span>))<br></code></pre></td></tr></table></figure>
<p><strong>反转列表reverse()</strong> </p>
<p>永久性地修改列表元素的排列顺序，但可随时恢复到原来的排列顺序，只需对列表再次调用reverse() 即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">cars.reverse() <br></code></pre></td></tr></table></figure>
<p><strong>len() 获取列表长度</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">len</span>(cars)<br></code></pre></td></tr></table></figure>
<h3 id="第-4-章-操作列表"><a href="#第-4-章-操作列表" class="headerlink" title="第 4 章　操作列表"></a>第 4 章　操作列表</h3><p><strong>遍历整个列表：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">magicians = [<span class="hljs-string">&#x27;alice&#x27;</span>, <span class="hljs-string">&#x27;david&#x27;</span>, <span class="hljs-string">&#x27;carolina&#x27;</span>]<br><span class="hljs-keyword">for</span> magician <span class="hljs-keyword">in</span> magicians:<br>	<span class="hljs-built_in">print</span>(magician)<br></code></pre></td></tr></table></figure>
<p><strong>使用函数range()</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> value <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">5</span>):<br>	<span class="hljs-built_in">print</span>(value)<br></code></pre></td></tr></table></figure>
<p>在这个示例中，range() 只打印数1～4。</p>
<p><u>这是编程语言中常见的差一行为的结果</u>。函数range() 让Python从指定的第一个值开始数， 并在到达你指定的第二个值时停止。因为它在第二个值处停止，所以输出不包含该值（这里为5）。</p>
<p>要打印数1～5，需要使用range(1,6) 。</p>
<p><strong>使用range() 创建数字列表</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">numbers = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">6</span>)) <br><span class="hljs-built_in">print</span>(numbers)<br></code></pre></td></tr></table></figure>
<p><strong>使用函数range() 时，还可指定步长</strong>。为此，可给这个函数指定第 三个参数，Python将根据这个步长来生成数。</p>
<p>例如，下面的代码打印1～10的偶数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">even_numbers = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>, <span class="hljs-number">11</span>, <span class="hljs-number">2</span>)) <br><span class="hljs-built_in">print</span>(even_numbers)<br></code></pre></td></tr></table></figure>
<p>下面的代码演示了如何将前10个整数的平方加入一个列表中：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">squares=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">11</span>):<br>	squares.append(i**<span class="hljs-number">2</span>)<br><span class="hljs-built_in">print</span>(squares)<br></code></pre></td></tr></table></figure>
<p><strong>最大值、最小值和总和：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">&gt;&gt;&gt; digits = [1, 2, 3, 4, 5, 6, 7, 8, 9, 0]<br>&gt;&gt;&gt; min(digits)<br>0<br>&gt;&gt;&gt; max(digits)<br>9<br>&gt;&gt;&gt; <span class="hljs-built_in">sum</span>(digits)<br>45<br></code></pre></td></tr></table></figure>
<p><strong>列表解析：</strong></p>
<p>列表解析将for循环和创建新元素的代码合并成一行，并自动附加新元素。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">squares=[i**<span class="hljs-number">2</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">11</span>)]<br><span class="hljs-built_in">print</span>(squares)<br></code></pre></td></tr></table></figure>
<p>要使用这种语法，首先指定一个描述性的列表名，如squares 。然后定义一个表达式，用于生成要存储到列表中的值。接下来，编写一个for 循环，用于给表达式提供值。</p>
<p><strong>元素切片：</strong></p>
<p>要创建切片，指定要使用的第一个元素和最后一个元素的索引。 与函数range() 一样，Python在到达第二个索引之前的元素后停止。要输出列表中的前三个元素，需要指定索引0和3，这将返回索引为0、1和2的元素。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">players = [<span class="hljs-string">&#x27;charles&#x27;</span>, <span class="hljs-string">&#x27;martina&#x27;</span>, <span class="hljs-string">&#x27;michael&#x27;</span>, <span class="hljs-string">&#x27;florence&#x27;</span>, <span class="hljs-string">&#x27;eli&#x27;</span>]<br><span class="hljs-built_in">print</span>(players[<span class="hljs-number">0</span>:<span class="hljs-number">3</span>])<br></code></pre></td></tr></table></figure>
<p>如果没有指定第一个索引，Python将自动从列表开头开始。要让切片终止于列表末尾，也可使用类似的语法。</p>
<p>注意 　可在表示切片的方括号内指定第三个值为步长。</p>
<p><strong>遍历切片</strong></p>
<p>如果要遍历列表的部分元素，可在for循环中使用切片。下面的示例遍历前三名队员，并打印他们的名字：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">players = [<span class="hljs-string">&#x27;charles&#x27;</span>, <span class="hljs-string">&#x27;martina&#x27;</span>, <span class="hljs-string">&#x27;michael&#x27;</span>, <span class="hljs-string">&#x27;florence&#x27;</span>, <span class="hljs-string">&#x27;eli&#x27;</span>]<br><span class="hljs-keyword">for</span> player <span class="hljs-keyword">in</span> players[:<span class="hljs-number">3</span>]:<br>	<span class="hljs-built_in">print</span>(player.title())<br></code></pre></td></tr></table></figure>
<p><strong>复制列表</strong></p>
<p>要复制列表，可创建一个包含整个列表的切片，方法是同时省略起 始索引和终止索引（[:] ）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">my_foods = [<span class="hljs-string">&#x27;pizza&#x27;</span>, <span class="hljs-string">&#x27;falafel&#x27;</span>, <span class="hljs-string">&#x27;carrot cake&#x27;</span>] <br>friend_foods = my_foods[:]<br></code></pre></td></tr></table></figure>
<p>如果直接用=赋值，相当于赋的指针，两个指针仍然指向同一个变量。</p>
<hr>
<h3 id="1-元组"><a href="#1-元组" class="headerlink" title="1. 元组"></a>1. 元组</h3><p><strong>不可变的列表被称为元组</strong> </p>
<p>元组使用圆括号而非中括号来标识，可使用索引来访问其元素。</p>
<p>例如，如果有一个大小不应改变的矩形，可将其长度和宽度存储在 一个元组中，从而确保它们是不能修改的：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">dimens=(<span class="hljs-number">200</span>,<span class="hljs-number">50</span>)<br><span class="hljs-built_in">print</span>(dimens[<span class="hljs-number">0</span>])<br><span class="hljs-built_in">print</span>(dimens[<span class="hljs-number">1</span>])<br></code></pre></td></tr></table></figure>
<p>修改元素的值，会触发错误消息。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-built_in">TypeError</span>: <span class="hljs-string">&#x27;tuple&#x27;</span> <span class="hljs-keyword">object</span> does not support item assignment<br></code></pre></td></tr></table></figure>
<p>注意：严格地说，元组是由逗号标识的，如果你要定义只包含一个元素的元组，必须在这个元素后面加上逗号：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">my_t = (<span class="hljs-number">3</span>,)<br></code></pre></td></tr></table></figure>
<p>遍历元组和列表一样：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">dimens=(<span class="hljs-number">200</span>,<span class="hljs-number">50</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> dimens:<br>	<span class="hljs-built_in">print</span>(i)<br></code></pre></td></tr></table></figure>
<p>虽然不能修改元组的元素，但可以重新定义整个元组：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">dimens=(<span class="hljs-number">200</span>,<span class="hljs-number">50</span>)<br>dimens=(<span class="hljs-number">300</span>,<span class="hljs-number">20</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> dimens:<br>	<span class="hljs-built_in">print</span>(i)<br></code></pre></td></tr></table></figure>
<p>相比于列表，元组是更简单的数据结构。如果需要存储的一组值在程序的整个生命周期内都不变，可以使用元组。</p>
<h3 id="2-if-语句"><a href="#2-if-语句" class="headerlink" title="2. if 语句"></a>2. if 语句</h3><p><strong>区分大小写：</strong></p>
<p>在Python中检查是否相等时区分大小写，两个大小写不同的值被视为不相等。</p>
<p>如果大小写很重要，这种行为有其优点。但如果大小写无关紧要， 只想检查变量的值，可将变量的值转换为小写，再进行比较。</p>
<p><strong>数值比较：</strong></p>
<p>条件语句中可包含各种数学比较，如小于、小于等于、大于、大于等于、等于、不等于：</p>
<figure class="highlight node-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs node-repl"><span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript">&gt;= &lt; &lt;= == !=</span><br></code></pre></td></tr></table></figure>
<p><strong>检查多个条件：</strong></p>
<p>a. 使用and 检查多个条件</p>
<p>b. 使用or检查多个条件</p>
<p><strong>检查特定值是否包含在列表中：</strong></p>
<p>要判断特定的值是否已包含在列表中，可使用关键字<code>in</code></p>
<p>不包含在列表中，使用<code>not in</code></p>
<p><strong>布尔表达式</strong> </p>
<p>布尔值通常用于记录条件，如游戏是否正在运行，或者用户是否可以编辑网站的特定内容：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">game_active = <span class="hljs-literal">True</span> <br><br>can_edit = <span class="hljs-literal">False</span><br></code></pre></td></tr></table></figure>
<p>在跟踪程序状态或程序中重要的条件方面，布尔值提供了一种高效的方式。</p>
<p><strong>if语句结构：</strong></p>
<ul>
<li>if</li>
<li>If-else</li>
<li>If-elif-else：else可以省略</li>
</ul>
<p><strong>验证列表是否为空：</strong></p>
<p>Python将在列表至少包含一个元素时返回True ， 并在列表为空时返回False 。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">lists=[]<br><span class="hljs-keyword">if</span> lists:<br>	<span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;yes&#x27;</span>)<br><span class="hljs-keyword">else</span>:<br>	<span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;no&#x27;</span>)<br></code></pre></td></tr></table></figure>
<h3 id="3-字典"><a href="#3-字典" class="headerlink" title="3. 字典"></a>3. 字典</h3><p>字典类似于列表，但是是是一系列键值对，让你能够将不同的信息关联起来，用中括号表示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">alien=&#123;<span class="hljs-string">&#x27;color&#x27;</span>:<span class="hljs-string">&#x27;green&#x27;</span>,<span class="hljs-string">&#x27;points&#x27;</span>:<span class="hljs-number">5</span>&#125;<br><span class="hljs-built_in">print</span>(alien[<span class="hljs-string">&#x27;color&#x27;</span>])<br><span class="hljs-built_in">print</span>(alien[<span class="hljs-string">&#x27;points&#x27;</span>])<br></code></pre></td></tr></table></figure>
<p>输出</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">green</span><br><span class="hljs-number">5</span><br></code></pre></td></tr></table></figure>
<p>每个键都与一个值相关联， 你可使用键来访问相关联的值。与键相关联的值可以是数、字符串、列表乃至字典。事实上，可将任何Python对象用作字典中的值。</p>
<p><strong>添加键值对：</strong></p>
<p>字典是一种动态结构，可随时在其中添加键值对。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">alien=&#123;<span class="hljs-string">&#x27;color&#x27;</span>:<span class="hljs-string">&#x27;green&#x27;</span>,<span class="hljs-string">&#x27;points&#x27;</span>:<span class="hljs-number">5</span>&#125;<br><span class="hljs-built_in">print</span>(alien)<br>alien[<span class="hljs-string">&#x27;xpos&#x27;</span>]=<span class="hljs-number">100</span><br>alien[<span class="hljs-string">&#x27;ypos&#x27;</span>]=<span class="hljs-number">50</span><br><span class="hljs-built_in">print</span>(alien)<br></code></pre></td></tr></table></figure>
<p>注意：字典中元素的排列顺序与定义时相同</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">alien_0 = &#123;<span class="hljs-string">&#x27;x_position&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;y_position&#x27;</span>: <span class="hljs-number">25</span>, <span class="hljs-string">&#x27;speed&#x27;</span>: <span class="hljs-string">&#x27;medium&#x27;</span>&#125; <br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Original position: <span class="hljs-subst">&#123;alien_0[<span class="hljs-string">&#x27;x_position&#x27;</span>]&#125;</span>&quot;</span>)<br><span class="hljs-keyword">if</span> alien_0[<span class="hljs-string">&#x27;speed&#x27;</span>]==<span class="hljs-string">&#x27;slow&#x27;</span>:<br>	x_inc=<span class="hljs-number">1</span><br><span class="hljs-keyword">elif</span> alien_0[<span class="hljs-string">&#x27;speed&#x27;</span>]==<span class="hljs-string">&#x27;medium&#x27;</span>:<br>	x_inc=<span class="hljs-number">2</span><br><span class="hljs-keyword">else</span>:<br>	x_inc=<span class="hljs-number">3</span><br>alien_0[<span class="hljs-string">&#x27;x_position&#x27;</span>]+=x_inc<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;New position:<span class="hljs-subst">&#123;alien_0[<span class="hljs-string">&#x27;x_position&#x27;</span>]&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>
<p><strong>删除键值对</strong></p>
<p>使用del 语句，必须指定字典名和要删除的键。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">alien_0 = &#123;<span class="hljs-string">&#x27;x_position&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;y_position&#x27;</span>: <span class="hljs-number">25</span>, <span class="hljs-string">&#x27;speed&#x27;</span>: <span class="hljs-string">&#x27;medium&#x27;</span>&#125; <br><span class="hljs-keyword">del</span> alien_0[<span class="hljs-string">&#x27;speed&#x27;</span>]<br><span class="hljs-built_in">print</span>(alien_0)<br></code></pre></td></tr></table></figure>
<p>注意 　删除的键值对会永远消失。</p>
<p><strong>使用get() 来访问值</strong> </p>
<p>用键搜索时，可能会引发问题：如果指定的键不存在就会出错。</p>
<p>但就字典而言，可使用方法get() 在指定的键不存在时返回一个默认值，从而避免这样的错误。</p>
<p>方法get() 的第一个参数用于指定键；第二个参数指定键不存在时要返回的值：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">alien_0 = &#123;<span class="hljs-string">&#x27;x_position&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;y_position&#x27;</span>: <span class="hljs-number">25</span>, <span class="hljs-string">&#x27;speed&#x27;</span>: <span class="hljs-string">&#x27;medium&#x27;</span>&#125; <br>msg=alien_0.get(<span class="hljs-string">&#x27;dgg&#x27;</span>,<span class="hljs-string">&#x27;no such value&#x27;</span>)<br><span class="hljs-built_in">print</span>(msg)<br></code></pre></td></tr></table></figure>
<p>注意：调用get() 时，如果没有指定第二个参数，Python将返回值None 。</p>
<p><strong>遍历字典</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">alien_0 = &#123;<span class="hljs-string">&#x27;x_position&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;y_position&#x27;</span>: <span class="hljs-number">25</span>, <span class="hljs-string">&#x27;speed&#x27;</span>: <span class="hljs-string">&#x27;medium&#x27;</span>&#125; <br><span class="hljs-keyword">for</span> i,j <span class="hljs-keyword">in</span> alien_0.items():<br>	<span class="hljs-built_in">print</span>(i)<br>	<span class="hljs-built_in">print</span>(j)<br></code></pre></td></tr></table></figure>
<p><strong>遍历字典中的所有键</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">alien_0 = &#123;<span class="hljs-string">&#x27;x_position&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;y_position&#x27;</span>: <span class="hljs-number">25</span>, <span class="hljs-string">&#x27;speed&#x27;</span>: <span class="hljs-string">&#x27;medium&#x27;</span>&#125; <br><span class="hljs-built_in">print</span>(alien_0.keys())<br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> alien_0.keys():<br>	<span class="hljs-built_in">print</span>(x)<br></code></pre></td></tr></table></figure>
<p>Keys()返回一个列表，因此可以用<code>sort()</code>等方法进行排序。</p>
<p><strong>遍历字典中的所有值</strong></p>
<p>方法values() 可以返回一 个值列表，不包含任何键。这种做法提取字典中所有的值，而没有考虑是否重复。为剔除重复项，可使用集合<code>set()</code>，集合中的每个元素都必须是独一无二的：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">favorite_languages = &#123; <span class="hljs-string">&#x27;jen&#x27;</span>: <span class="hljs-string">&#x27;python&#x27;</span>, <span class="hljs-string">&#x27;sarah&#x27;</span>: <span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-string">&#x27;edward&#x27;</span>: <span class="hljs-string">&#x27;ruby&#x27;</span>, <span class="hljs-string">&#x27;phil&#x27;</span>: <span class="hljs-string">&#x27;python&#x27;</span>, <span class="hljs-string">&#x27;sdf&#x27;</span>: <span class="hljs-string">&#x27;python&#x27;</span>,&#125;<br><span class="hljs-keyword">for</span> lang <span class="hljs-keyword">in</span> <span class="hljs-built_in">set</span>(favorite_languages.values()):<br>	<span class="hljs-built_in">print</span>(lang)<br></code></pre></td></tr></table></figure>
<p>集合和字典很容易混淆，因为它们都是用一对花括号定义的。 当花括号内没有键值对时，定义的很可能是集合。不同于列表 和字典，集合不会以特定的顺序存储元素。</p>
<p><strong>在列表中存储字典</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">alien_0 = &#123;<span class="hljs-string">&#x27;color&#x27;</span>: <span class="hljs-string">&#x27;green&#x27;</span>, <span class="hljs-string">&#x27;points&#x27;</span>: <span class="hljs-number">5</span>&#125; <br>alien_1 = &#123;<span class="hljs-string">&#x27;color&#x27;</span>: <span class="hljs-string">&#x27;yellow&#x27;</span>, <span class="hljs-string">&#x27;points&#x27;</span>: <span class="hljs-number">10</span>&#125; <br>alien_2 = &#123;<span class="hljs-string">&#x27;color&#x27;</span>: <span class="hljs-string">&#x27;red&#x27;</span>, <span class="hljs-string">&#x27;points&#x27;</span>: <span class="hljs-number">15</span>&#125;<br>aliens = [alien_0, alien_1, alien_2]<br><span class="hljs-keyword">for</span> alien <span class="hljs-keyword">in</span> aliens: <br>  <span class="hljs-built_in">print</span>(alien)<br></code></pre></td></tr></table></figure>
<p><strong>在字典中存储列表</strong></p>
<p>每当需要在字典中将一个键关联到多个值时，都可以在字典中嵌套 一个列表。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">favorite_languages = &#123;<br><span class="hljs-string">&#x27;jen&#x27;</span>: [<span class="hljs-string">&#x27;python&#x27;</span>, <span class="hljs-string">&#x27;ruby&#x27;</span>], <br><span class="hljs-string">&#x27;sarah&#x27;</span>: [<span class="hljs-string">&#x27;c&#x27;</span>],<br><span class="hljs-string">&#x27;edward&#x27;</span>: [<span class="hljs-string">&#x27;ruby&#x27;</span>, <span class="hljs-string">&#x27;go&#x27;</span>], <br><span class="hljs-string">&#x27;phil&#x27;</span>: [<span class="hljs-string">&#x27;python&#x27;</span>, <span class="hljs-string">&#x27;haskell&#x27;</span>], &#125;<br><span class="hljs-keyword">for</span> name, languages <span class="hljs-keyword">in</span> favorite_languages.items():<br>	<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\n<span class="hljs-subst">&#123;name.title()&#125;</span>&#x27;s favorite languages are:&quot;</span>) <br>	<span class="hljs-keyword">for</span> language <span class="hljs-keyword">in</span> languages: <br>		<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\t<span class="hljs-subst">&#123;language.title()&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>
<p>注意 　列表和字典的嵌套层级不应太多。如果嵌套层级比前 面的示例多得多，很可能有更简单的解决方案。</p>
<p><strong>在字典中存储字典</strong></p>
<p>可在字典中嵌套字典，但这样做时，代码可能很快复杂起来。</p>
<p>最好储存的每项字典都具有相同的结构。虽然Python并没 有这样的要求，但这使得嵌套的字典处理起来更容易。倘若表示每个字典都包含不同的键，for 循环内部的代码将更复杂。</p>
<h3 id="3-input和while循环"><a href="#3-input和while循环" class="headerlink" title="3. input和while循环"></a>3. input和while循环</h3><p><strong><code>input()</code>工作原理</strong></p>
<p>函数<code>input()</code>让程序暂停运行，等待用户输入一些文本。获取用户输入后，Python将其赋给一个变量，以方便后面使用。</p>
<p>函数<code>input()</code>的参数为要向用户显示的提示 （prompt） 或说明，让用户知道该如何做。</p>
<p>注意：Sublime Text等众多编辑器不能运行用户输入程序，必须从终端运行它们。</p>
<p><strong>将用户输入转化为数值<code>int()</code></strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">msg=<span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;plz give a num:\t&#x27;</span>)<br>num=<span class="hljs-built_in">int</span>(msg)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(num))<br><span class="hljs-keyword">if</span> num&gt;=<span class="hljs-number">10</span>:<br>	<span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;You are big&#x27;</span>)<br><span class="hljs-keyword">else</span>:<br>	<span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;You are small&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p><strong>while循环</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">num=<span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> num&lt;=<span class="hljs-number">5</span>:<br>	<span class="hljs-built_in">print</span>(num)<br>	num+=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>
<p>while 循环运行，直到指定的条件<strong>不满足</strong>为止</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">prompt = <span class="hljs-string">&quot;\nTell me something, and I will repeat it back to you:&quot;</span><br>prompt += <span class="hljs-string">&quot;\nEnter &#x27;quit&#x27; to end the program. &quot;</span> <br>message = <span class="hljs-string">&quot;&quot;</span> <br><span class="hljs-keyword">while</span> message != <span class="hljs-string">&#x27;quit&#x27;</span>:<br>	message = <span class="hljs-built_in">input</span>(prompt)<br>	<span class="hljs-built_in">print</span>(message)<br></code></pre></td></tr></table></figure>
<p><strong>使用标志作为条件</strong></p>
<p>在要求很多条件都满足的程序中，在一条while 语句中检查所有这些条件，将既复杂又困难。</p>
<p>因此可定义一个变量，用于判断整个程序是否处于活动状态。这个变量称为标志 （flag）。这样，在while 语句中就只需检查一个条件，从而让程序更整洁。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">prompt = <span class="hljs-string">&quot;\nTell me something, and I will repeat it back to you:&quot;</span><br>prompt += <span class="hljs-string">&quot;\nEnter &#x27;quit&#x27; to end the program. &quot;</span> <br>active=<span class="hljs-literal">True</span><br><span class="hljs-keyword">while</span> active:<br>	message = <span class="hljs-built_in">input</span>(prompt)<br>	<span class="hljs-keyword">if</span> message==<span class="hljs-string">&#x27;quit&#x27;</span>:<br>		active=<span class="hljs-literal">False</span><br>	<span class="hljs-keyword">else</span>:<br>		<span class="hljs-built_in">print</span>(message)<br></code></pre></td></tr></table></figure>
<p><strong>使用while 循环处理列表和字典</strong></p>
<p>for 循环是一种遍历列表的有效方式，但不应在for 循环中修改列表，否则将导致Python难以跟踪其中的元素。要在遍历列表的同时对其进行修改，可使用while 循环。通过将while 循环同列表和字典结合起来使用，可收集、存储并组织大量输入，供以后查看和显示。</p>
<p>(1) 列表间通过while移动元素</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">unconfirmed_users = [<span class="hljs-string">&#x27;alice&#x27;</span>, <span class="hljs-string">&#x27;brian&#x27;</span>, <span class="hljs-string">&#x27;candace&#x27;</span>] <br>confirmed_users = []	<br><span class="hljs-keyword">while</span> unconfirmed_users:<br>	cur_user=unconfirmed_users.pop()<br>	<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Verifying user:<span class="hljs-subst">&#123;cur_user&#125;</span>&quot;</span>)<br>	confirmed_users.append(cur_user)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\nThe following users have been confirmed:&quot;</span>)<br><span class="hljs-keyword">for</span> user <span class="hljs-keyword">in</span> confirmed_users:<br>	<span class="hljs-built_in">print</span>(user)<br></code></pre></td></tr></table></figure>
<p>(2) 删除特定值的所有列表元素</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">pets = [<span class="hljs-string">&#x27;dog&#x27;</span>, <span class="hljs-string">&#x27;cat&#x27;</span>, <span class="hljs-string">&#x27;dog&#x27;</span>, <span class="hljs-string">&#x27;goldfish&#x27;</span>, <span class="hljs-string">&#x27;cat&#x27;</span>, <span class="hljs-string">&#x27;rabbit&#x27;</span>, <span class="hljs-string">&#x27;cat&#x27;</span>]<br><span class="hljs-built_in">print</span>(pets)<br><span class="hljs-keyword">while</span> <span class="hljs-string">&#x27;cat&#x27;</span> <span class="hljs-keyword">in</span> pets:<br>	pets.remove(<span class="hljs-string">&#x27;cat&#x27;</span>)<br><span class="hljs-built_in">print</span>(pets)<br></code></pre></td></tr></table></figure>
<p>(3) 使用用户输入来填充字典</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">responses=&#123;&#125;<br>active=<span class="hljs-literal">True</span><br><span class="hljs-keyword">while</span> active:<br>	name=<span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;what is your name?&#x27;</span>)<br>	response=<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Which mountain would you like to climb someday?&quot;</span>)<br>	responses[name]=response<br>	repeate=<span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;Continue?(Y/N)&#x27;</span>)<br>	<span class="hljs-keyword">if</span> repeate==<span class="hljs-string">&#x27;N&#x27;</span>:<br>		active=<span class="hljs-literal">False</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;------result------&#x27;</span>)<br><span class="hljs-keyword">for</span> name,response <span class="hljs-keyword">in</span> responses.items():<br>	<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;name&#125;</span> would like to climb <span class="hljs-subst">&#123;response&#125;</span>.&quot;</span>)<br></code></pre></td></tr></table></figure>
<h3 id="4-函数"><a href="#4-函数" class="headerlink" title="4. 函数"></a>4. 函数</h3><p><strong>定义函数</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">greet_user</span>():<br>	<span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Hello&#x27;</span>)<br>greet_user()<br></code></pre></td></tr></table></figure>
<p><strong>含参函数</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">greet_user</span>(<span class="hljs-params">name</span>):<br>	<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;hello,<span class="hljs-subst">&#123;name&#125;</span>&quot;</span>)<br>greet_user(<span class="hljs-string">&#x27;xmm&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p><strong>位置实参</strong></p>
<p>调用函数时，Python必须将函数调用中的每个实参都关联到函数定义中的一个形参。为此，最简单的关联方式是基于实参的顺序。这种关联方式称为位置实参 。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">describe_pet</span>(<span class="hljs-params">animal_type, pet_name</span>):<br>	<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\nI have a <span class="hljs-subst">&#123;animal_type&#125;</span>.&quot;</span>) <br>	<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;My <span class="hljs-subst">&#123;animal_type&#125;</span>&#x27;s name is <span class="hljs-subst">&#123;pet_name.title()&#125;</span>.&quot;</span>)<br>describe_pet(<span class="hljs-string">&#x27;hamster&#x27;</span>, <span class="hljs-string">&#x27;harry&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>位置实参的顺序很重要，如果实参的顺序不正确，结果可能出乎意料。</p>
<p><strong>关键字实参</strong></p>
<p>关键字实参让你无须考虑函数调用 中的实参顺序，还清楚地指出了函数调用中各个值的用途</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">describe_pet</span>(<span class="hljs-params">animal_type, pet_name</span>):<br>	<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\nI have a <span class="hljs-subst">&#123;animal_type&#125;</span>.&quot;</span>) <br>	<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;My <span class="hljs-subst">&#123;animal_type&#125;</span>&#x27;s name is <span class="hljs-subst">&#123;pet_name.title()&#125;</span>.&quot;</span>)<br>describe_pet(pet_name=<span class="hljs-string">&#x27;lego&#x27;</span>, animal_type=<span class="hljs-string">&#x27;cat&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p><strong>默认值</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">describe_pet</span>(<span class="hljs-params"> pet_name,animal_type=<span class="hljs-string">&#x27;dog&#x27;</span></span>):<br>	<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\nI have a <span class="hljs-subst">&#123;animal_type&#125;</span>.&quot;</span>) <br>	<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;My <span class="hljs-subst">&#123;animal_type&#125;</span>&#x27;s name is <span class="hljs-subst">&#123;pet_name.title()&#125;</span>.&quot;</span>)<br>describe_pet(pet_name=<span class="hljs-string">&#x27;lego&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>注意：使用默认值时，必须先写没有默认值的形参，再写有默认值的实参，顺序不对会报错。</p>
<p><strong>返回值</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">eat_food</span>(<span class="hljs-params">food,num</span>):<br>	msg=<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;num&#125;</span> <span class="hljs-subst">&#123;food&#125;</span>s&quot;</span><br>	<span class="hljs-keyword">return</span> msg<br>word=eat_food(<span class="hljs-string">&#x27;burger&#x27;</span>,<span class="hljs-number">3</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Eat <span class="hljs-subst">&#123;word&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>
<p><strong>让实参变成可选的</strong></p>
<p>并非所有实参都需要提供，但不提供的话就不能正确运行。因此可以指定一个空的默认值，并将其移到形参列表的末尾。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">eat_food</span>(<span class="hljs-params">food,num,name=<span class="hljs-string">&#x27;&#x27;</span></span>):<br>	msg=<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;name&#125;</span> Eats <span class="hljs-subst">&#123;num&#125;</span> <span class="hljs-subst">&#123;food&#125;</span>s&quot;</span><br>	<span class="hljs-keyword">return</span> msg<br><span class="hljs-built_in">print</span>(eat_food(<span class="hljs-string">&#x27;egg&#x27;</span>,<span class="hljs-number">6</span>))<br></code></pre></td></tr></table></figure>
<p><strong>返回字典</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">full_name</span>(<span class="hljs-params">first_name,last_name,age=<span class="hljs-literal">None</span></span>):<br>	person=&#123;<span class="hljs-string">&#x27;first&#x27;</span>:first_name,<span class="hljs-string">&#x27;last&#x27;</span>:last_name&#125;<br>	<span class="hljs-keyword">if</span> age:<br>		person[<span class="hljs-string">&#x27;age&#x27;</span>]=age<br>	<span class="hljs-keyword">return</span> person<br>people=full_name(<span class="hljs-string">&#x27;love&#x27;</span>,<span class="hljs-string">&#x27;U&#x27;</span>,age=<span class="hljs-number">521</span>)<br><span class="hljs-built_in">print</span>(people)<br></code></pre></td></tr></table></figure>
<p>可选形参age 设置为特殊值None，可将None 视为占位值。在条件测试中，None相当于False 。</p>
<p><strong>结合使用函数和while 循环</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">full_name</span>(<span class="hljs-params">first_name,last_name</span>):<br>	person=&#123;<span class="hljs-string">&#x27;first&#x27;</span>:first_name,<span class="hljs-string">&#x27;last&#x27;</span>:last_name&#125;<br>	<span class="hljs-keyword">return</span> person<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>	<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\nPlease tell me your name:&quot;</span>) <br>	f_name = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;First name: &quot;</span>) <br>	l_name = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Last name: &quot;</span>)<br>	formatted_name = full_name(f_name, l_name) <br>	<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\nHello, <span class="hljs-subst">&#123;formatted_name&#125;</span>!&quot;</span>)<br></code></pre></td></tr></table></figure>
<p><strong>向函数中传递列表</strong></p>
<p>需要参数过于复杂时，向函数传递列表很有用，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">great</span>(<span class="hljs-params">names</span>):<br>	<span class="hljs-keyword">for</span> name <span class="hljs-keyword">in</span> names:<br>		msg=<span class="hljs-string">f&quot;Hello,<span class="hljs-subst">&#123;name.title()&#125;</span>&quot;</span><br>		<span class="hljs-built_in">print</span>(msg)<br>usernames=[<span class="hljs-string">&#x27;sfd&#x27;</span>,<span class="hljs-string">&#x27;sagf&#x27;</span>,<span class="hljs-string">&#x27;yth&#x27;</span>,<span class="hljs-string">&#x27;her&#x27;</span>,<span class="hljs-string">&#x27;sdg&#x27;</span>,<span class="hljs-string">&#x27;ewrt&#x27;</span>]<br>great(usernames)<br></code></pre></td></tr></table></figure>
<p><strong>在函数中修改列表</strong> </p>
<p>将列表传递给函数后，函数就可对其进行修改。在函数中对这个列表所做的任何修改都是永久性的，这让你能够高效地处理大量数据。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">prev=[<span class="hljs-string">&#x27;phone case&#x27;</span>, <span class="hljs-string">&#x27;robot pendant&#x27;</span>, <span class="hljs-string">&#x27;dodecahedron&#x27;</span>]<br>cur=[]<br><span class="hljs-keyword">while</span> prev:<br>	item=prev.pop()<br>	<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Printing model: <span class="hljs-subst">&#123;item&#125;</span>&quot;</span>)<br>	cur.append(item)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\nThe following models have been printed:&quot;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> cur:<br>	<span class="hljs-built_in">print</span>(i)<br></code></pre></td></tr></table></figure>
<p>为重新组织这些代码，可编写两个函数，每个都做一件具体的工作，这样的效率更高。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">prev=[<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>]<br>cur=[]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">copy</span>(<span class="hljs-params">prev,cur</span>):<br>	<span class="hljs-keyword">while</span> prev:<br>		item=prev.pop()<br>		<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Printing model: <span class="hljs-subst">&#123;item&#125;</span>&quot;</span>)<br>		cur.append(item)<br>	<span class="hljs-keyword">return</span> cur<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">prt</span>(<span class="hljs-params">cur</span>):<br>	<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\nThe following models have been printed:&quot;</span>)<br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> cur:<br>		<span class="hljs-built_in">print</span>(i)<br>prt(copy(prev,cur))<br></code></pre></td></tr></table></figure>
<p>由于列表作为参数传入函数后的修改是永久性的，因此不用设置中间变量，直接顺着写下来就行。</p>
<p><strong>禁止函数修改列表</strong></p>
<p>如果不想修改列表，可以向函数传递列表的副本而非原件。这样，函数所做的任何修改都只影响副本，而原件丝 毫不受影响。要将列表的副本传递给函数，可以像下面这样做：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">function_name(list_name_[:])<br></code></pre></td></tr></table></figure>
<p>虽然向函数传递列表的副本可保留原始列表的内容，但除非有充分的理由，否则还是应该将原始列表传递给函数。这是因为让函数使用现成的列表可避免花时间和内存创建副本，从而提高效率，在处理大型列表时尤其如此。</p>
<p><strong>传递任意数量的实参</strong></p>
<p>有时候，预先不知道函数需要接受多少个实参，好在Python允许函数从调用语句中收集任意数量的实参。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">eat_food</span>(<span class="hljs-params">name,*food</span>):<br>	<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;name&#125;</span> eats <span class="hljs-subst">&#123;food&#125;</span>&quot;</span>)<br>eat_food(<span class="hljs-string">&#x27;xmm&#x27;</span>,<span class="hljs-string">&#x27;burger&#x27;</span>,<span class="hljs-string">&#x27;rice&#x27;</span>,<span class="hljs-string">&#x27;chicken&#x27;</span>,<span class="hljs-string">&#x27;cola&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>形参名中的星号让Python创建一个名为<code>food</code>的空元组，并将收到的所有参数都封装到这个元组中。</p>
<p>如果要让函数接受不同类型的实参，必须在函数定义中将接纳任意数量实参的形参放在最后。</p>
<p><strong>使用任意数量的关键字实参</strong></p>
<p>有时候，需要接受任意数量的实参，但预先不知道传递给函数的会是什么样的信息。</p>
<p>在这种情况下，可将函数编写成能够接受任意数量的键值对——调用语句提供了多少就接受多少。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">build_dec</span>(<span class="hljs-params">first,last,**user_info</span>):<br>	user_info[<span class="hljs-string">&#x27;fn&#x27;</span>]=first<br>	user_info[<span class="hljs-string">&#x27;ln&#x27;</span>]=last<br>	<span class="hljs-keyword">return</span> user_info<br>dic=build_dec(<span class="hljs-string">&#x27;albert&#x27;</span>,<span class="hljs-string">&#x27;leo&#x27;</span>,location=<span class="hljs-string">&#x27;princeton&#x27;</span>, field=<span class="hljs-string">&#x27;physics&#x27;</span>)<br><span class="hljs-built_in">print</span>(dic)<br></code></pre></td></tr></table></figure>
<p>函数定义要求提供名和姓，同时允许根据需要提供任意数量的名称值对。形参<code>**user_info</code>中的两个星号让 Python创建一个名为<code>user_info</code> 的空字典，并将收到的所有名称值对都放到这个字典中。</p>
<p>注意：你经常会看到形参名<code>**kwargs</code> ，它用于收集任意数量的关键字实参。</p>
<p><strong>将函数存储在模块中</strong></p>
<p>使用函数的优点之一是可将代码块与主程序分离。通过给函数指定描述性名称，可让主程序容易理解得多。你还可以更进一步，将函数存储在称为模块的独立文件中，再将模块通过<code>import</code>导入到主程序 中。</p>
<p>导入模块的方法有多种，下面对每种进行简要的介绍。</p>
<p>(1) 导入整个模块</p>
<p>要让函数是可导入的，得先创建模块。模块是扩展名为.py的文件，包含要导入到程序中的代码。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#创建pizza.py，在主程序中导入</span><br><span class="hljs-keyword">import</span> pizza<br>pizza.f1()<br>pizza.f2()<br></code></pre></td></tr></table></figure>
<p>(2) 导入特定的函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#创建pizza.py，在主程序中导入特定函数fn1()、fn2()</span><br><span class="hljs-keyword">from</span> pizza <span class="hljs-keyword">import</span> fn1,fn2<br>fn1()<br>fn2()<br></code></pre></td></tr></table></figure>
<p><strong>使用as 给函数指定别名</strong></p>
<p>如果要导入函数的名称可能与程序中现有的名称冲突，或者函数的名称太长，可指定简短而独一无二的别名：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pizza <span class="hljs-keyword">import</span> fn1 <span class="hljs-keyword">as</span> f1<br>f1()<br></code></pre></td></tr></table></figure>
<p><strong>使用as 给模块指定别名</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pizza <span class="hljs-keyword">as</span> p<br>p.fn1()<br>p.fn2()<br></code></pre></td></tr></table></figure>
<p><strong>导入模块中的所有函数</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pizza <span class="hljs-keyword">import</span> *<br>fn1()<br>fn2()<br></code></pre></td></tr></table></figure>
<p>最好不要采用这种导入方法，Python可能遇到多个名称相同的函数或变量，进而覆盖函数，而不是分别导入所有的函数。</p>
<p>最佳的做法是，要么只导入需要使用的函数，要么导入整个模块并使用句点表示法。</p>
<hr>
<h3 id="1-类"><a href="#1-类" class="headerlink" title="1. 类"></a>1. 类</h3><p><strong>创建和使用类</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span>:<br>	<span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name,age</span>):<br>		self.name=name<br>		self.age=age<br>	<span class="hljs-keyword">def</span> <span class="hljs-title function_">sit</span>(<span class="hljs-params">self</span>):<br>		<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;self.name&#125;</span> is now sitting.&quot;</span>)<br>	<span class="hljs-keyword">def</span> <span class="hljs-title function_">roll</span>(<span class="hljs-params">self</span>):<br>		<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;self.name&#125;</span> rolled over.&quot;</span>)<br></code></pre></td></tr></table></figure>
<p><strong>方法<code>_init_()_</code></strong></p>
<p>类中的函数称为方法 。</p>
<p><code>_init_()</code>是一个特殊方法，每当你根据Dog 类创建新实例时，Python都会自动运行它。在这个方法的名称中，开头和末尾各有两个下划线，这是一种约定，旨在避免Python默认方法与普通方法发生名称冲突。</p>
<p>该方法中的三个形参：self 、name 和 age 。其中形参self 是一个指向实例本身的引用，必须位于其他形参的前面。以self 为前缀的变量可供类中的所有方法使用，可以通过类的任何实例来访问，像这样可通过实例访问的变量称为属性 。</p>
<blockquote>
<p>因为 Python调用这个方法来创建Dog 实例时，将自动传入实参self ，所以必须位于所有参数的前面。</p>
<p>而self 会自动传递，因此可以缺省。每当根据Dog 类创建实例时，都只需给最后别的形参提供值。</p>
</blockquote>
<p><strong>普通方法</strong></p>
<p>本例中<code>sit()</code>和<code>roll()</code>方法执行时不需要额外的信息，因此只有一个形参self 。</p>
<p><strong>根据类创建实例</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">doggie=Dog(<span class="hljs-string">&#x27;Leo&#x27;</span>,<span class="hljs-number">3</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;dog name:<span class="hljs-subst">&#123;doggie.name&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;dog age:<span class="hljs-subst">&#123;doggie.age&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>
<p>通常将类的首字母大写，创建的实例首字母小写</p>
<p>a. 访问属性</p>
<p>要访问实例的属性，可使用句点表示法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">doggie.name<br></code></pre></td></tr></table></figure>
<p>b. 调用方法</p>
<p>使用句点表示法来调用Dog 类中定义的方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">doggie.sit()<br>doggie.roll()<br></code></pre></td></tr></table></figure>
<p><strong>给属性指定默认值</strong></p>
<p>在初始化函数中添加一个名为odometer_reading 的属性，其初始值总是为 0。并添加一个名为read_odometer() 的方法，用于读取汽车的里程表：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Car</span>:<br>	<span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, make,model,year</span>):<br>		self.make=make<br>		self.model=model<br>		self.year=year<br>		self.odometer_reading = <span class="hljs-number">0</span><br>	<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_des</span>(<span class="hljs-params">self</span>):<br>		fn=<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;self.year&#125;</span> <span class="hljs-subst">&#123;self.make&#125;</span> <span class="hljs-subst">&#123;self.model&#125;</span>&quot;</span><br>		<span class="hljs-keyword">return</span> fn.title()<br>	<span class="hljs-keyword">def</span> <span class="hljs-title function_">read_odometer</span>(<span class="hljs-params">self</span>):<br>		<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;This car has <span class="hljs-subst">&#123;self.odometer_reading&#125;</span> miles on it.&quot;</span>)<br>my_car=Car(<span class="hljs-string">&#x27;audi&#x27;</span>,<span class="hljs-string">&#x27;a4&#x27;</span>,<span class="hljs-number">2019</span>)<br><span class="hljs-built_in">print</span>(my_car.get_des())<br>my_car.read_odometer()<br></code></pre></td></tr></table></figure>
<p><strong>修改属性的值</strong></p>
<p>a. 直接修改属性的值</p>
<p>要修改属性的值，最简单的方式是通过实例直接访问它。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">my_car.odometer_reading=<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>
<p>b. 通过方法修改属性的值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">Class Car:<br>	...<br>	<span class="hljs-keyword">def</span> <span class="hljs-title function_">update</span>(<span class="hljs-params">self,mile</span>):<br>		self.odometer_reading=mile<br>my_car=Car(<span class="hljs-string">&#x27;audi&#x27;</span>,<span class="hljs-string">&#x27;a4&#x27;</span>,<span class="hljs-number">2019</span>)<br>my_car.update(<span class="hljs-number">23_400</span>)<br></code></pre></td></tr></table></figure>
<p>c. 通过方法对属性的值进行递增</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">Class Car:<br>	...<br>	<span class="hljs-keyword">def</span> <span class="hljs-title function_">inc</span>(<span class="hljs-params">self,miles</span>):<br>		self.odometer_reading+=miles<br>my_car=Car(<span class="hljs-string">&#x27;audi&#x27;</span>,<span class="hljs-string">&#x27;a4&#x27;</span>,<span class="hljs-number">2019</span>)<br>my_car.inc(<span class="hljs-number">100</span>)<br></code></pre></td></tr></table></figure>
<p><strong>继承</strong></p>
<p>在父类的基础上编写子类时，通常要调用父类的方法 <code>__init__()</code>，子类会包含这些属性。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Car</span>:<br>	<span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, make,model,year</span>):<br>		self.make=make<br>		self.model=model<br>		self.year=year<br>		self.odometer_reading = <span class="hljs-number">0</span><br>	<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_des</span>(<span class="hljs-params">self</span>):<br>		fn=<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;self.year&#125;</span> <span class="hljs-subst">&#123;self.make&#125;</span> <span class="hljs-subst">&#123;self.model&#125;</span>&quot;</span><br>		<span class="hljs-keyword">return</span> fn.title()<br>	<span class="hljs-keyword">def</span> <span class="hljs-title function_">read_odometer</span>(<span class="hljs-params">self</span>):<br>		<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;This car has <span class="hljs-subst">&#123;self.odometer_reading&#125;</span> miles on it.&quot;</span>)<br>	<span class="hljs-keyword">def</span> <span class="hljs-title function_">update</span>(<span class="hljs-params">self,mile</span>):<br>		self.odometer_reading=mile<br>	<span class="hljs-keyword">def</span> <span class="hljs-title function_">inc</span>(<span class="hljs-params">self,miles</span>):<br>		self.odometer_reading+=miles<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Elecar</span>(<span class="hljs-title class_ inherited__">Car</span>):<br>	<span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,make,model,year</span>):<br>		<span class="hljs-built_in">super</span>().__init__(make,model,year)<br>my_tesla=Elecar(<span class="hljs-string">&#x27;tesla&#x27;</span>,<span class="hljs-string">&#x27;model-X&#x27;</span>,<span class="hljs-number">2019</span>)<br><span class="hljs-built_in">print</span>(my_tesla.get_des())<br></code></pre></td></tr></table></figure>
<ul>
<li>创建子类时，父类必须包含在当前 文件中，且位于子类前面。</li>
<li>定义子类时，必须在圆括号内指定父类的名称。</li>
<li>super() 是一个特殊函数，让你能够调用父类的方法。</li>
</ul>
<p><strong>给子类定义属性和方法</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Car</span>:<br>--snip--<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ElectricCar</span>(<span class="hljs-title class_ inherited__">Car</span>):<br>	<span class="hljs-string">&quot;&quot;&quot;电动汽车的独特之处。&quot;&quot;&quot;</span><br>	<span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, make, model, year</span>):<br>		<span class="hljs-string">&quot;&quot;&quot; 初始化父类的属性。 再初始化电动汽车特有的属性。 &quot;&quot;&quot;</span> <br>		<span class="hljs-built_in">super</span>().__init__(make, model, year) <br>		self.battery_size = <span class="hljs-number">75</span><br>	<span class="hljs-keyword">def</span> <span class="hljs-title function_">describe_battery</span>(<span class="hljs-params">self</span>):<br>		<span class="hljs-string">&quot;&quot;&quot;打印一条描述电瓶容量的消息。&quot;&quot;&quot;</span> <br>		<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;This car has a <span class="hljs-subst">&#123;self.battery_size&#125;</span>-kWh battery.&quot;</span>)<br>my_tesla = ElectricCar(<span class="hljs-string">&#x27;tesla&#x27;</span>, <span class="hljs-string">&#x27;model s&#x27;</span>, <span class="hljs-number">2019</span>)<br><span class="hljs-built_in">print</span>(my_tesla.get_descriptive_name()) <br>my_tesla.describe_battery()<br></code></pre></td></tr></table></figure>
<p>添加新属性self.battery_size ，并设置初始值。</p>
<p><strong>重写父类的方法</strong></p>
<p>在子类中定义与父类方法同名的方法，这样，Python将不会考虑这个父类方法，而只关注你在子类中定义的相应方法。</p>
<p><strong>将实例用作属性</strong></p>
<p>使用代码模拟实物时，你可能会发现自己给类添加的细节越来越多：属性和方法清单以及文件都越来越长。在这种情况下，可能需要将类的一部分提取出来，作为一个独立的类。可以将大型类拆分成多个协同工作的小类。</p>
<p>例如，不断给ElectricCar 类添加细节时，我们可能发现其中包 含很多专门针对汽车电瓶的属性和方法。在这种情况下，可将这些属性和方法提取出来，放到一个名为Battery 的类中，并将一 个Battery 实例作为ElectricCar 类的属性：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Car</span>:<br>	--snip--<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Battery</span>:<br>	<span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, battery_size=<span class="hljs-number">75</span></span>):<br>		self.battery_size = battery_size<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Electric</span>(<span class="hljs-title class_ inherited__">Car</span>):<br>	<span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,make,model,year</span>):<br>		<span class="hljs-built_in">super</span>().__init__(make,model,year)<br>		self.battery=Battery()<br>my_tesla = ElectricCar(<span class="hljs-string">&#x27;tesla&#x27;</span>, <span class="hljs-string">&#x27;model s&#x27;</span>, <span class="hljs-number">2019</span>)<br><span class="hljs-built_in">print</span>(my_tesla.get_descriptive_name()) <br>my_tesla.battery.describe_battery()<br></code></pre></td></tr></table></figure>
<p>在ElectricCar 类中，添加了一个名为self.battery 的属性。这行代码让Python创建一个新的Battery 实例，并将该实例赋给新属性self.battery 。</p>
<p>这行代码让Python在实例my_tesla 中查找属性battery ，并对存 储在该属性中的Battery 实例调用方法describe_battery() 。</p>
<p><strong>导入类</strong></p>
<p>随着不断给类添加功能，文件可能变得很长，即便妥善地使用了继承亦如此。为遵循Python的总体理念，应让文件尽可能整洁。 Python在这方面提供了帮助，允许将类存储在模块中，然后在主程 序中导入所需的模块。</p>
<p>a. 导入单个类</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#有一个Car类存在car.py文件中</span><br><span class="hljs-keyword">from</span> car <span class="hljs-keyword">import</span> Car<br>my_new_car = Car(<span class="hljs-string">&#x27;audi&#x27;</span>, <span class="hljs-string">&#x27;a4&#x27;</span>, <span class="hljs-number">2019</span>)<br><span class="hljs-built_in">print</span>(my_new_car.get_descriptive_name())<br>my_new_car.odometer_reading = <span class="hljs-number">23</span> <br>my_new_car.read_odometer()<br></code></pre></td></tr></table></figure>
<p>b. 从一个模块中导入多个类</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> car <span class="hljs-keyword">import</span> Car, ElectricCar<br></code></pre></td></tr></table></figure>
<p>c. 导入整个模块</p>
<p>导入整个模块，再使用句点表示法访问需要的类。这种导入方式很简单，代码也易于阅读。因为创建类实例的代码都包含模块名，所以不会与当前文件使用的任何名称发生冲突。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> car<br>my_beetle = car.Car(<span class="hljs-string">&#x27;volkswagen&#x27;</span>, <span class="hljs-string">&#x27;beetle&#x27;</span>, <span class="hljs-number">2019</span>) <br><span class="hljs-built_in">print</span>(my_beetle.get_descriptive_name())<br></code></pre></td></tr></table></figure>
<p>d. 导入模块中的所有类</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> module_name <span class="hljs-keyword">import</span> *<br></code></pre></td></tr></table></figure>
<p>不推荐使用这种导入方式</p>
<p>e. 在一个模块中导入另一个模块</p>
<p>将类存储在多个模块中时，你可能会发现一个模块中的类依赖于另一个模块中的类。在这种情况下，可在前一 个模块中导入必要的类。</p>
<p>将Car类存储在一个模块中，并将ElectricCar 类和Battery 类存储在另一个模块中。将第二个模块命名为electric_car.py（这将 覆盖前面创建的文件electric_car.py），并将Battery 类和 ElectricCar 类复制到这个模块中：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> car <span class="hljs-keyword">import</span> Car <span class="hljs-keyword">from</span> electric_car <span class="hljs-keyword">import</span> ElectricCar<br>my_beetle = Car(<span class="hljs-string">&#x27;volkswagen&#x27;</span>, <span class="hljs-string">&#x27;beetle&#x27;</span>, <span class="hljs-number">2019</span>)<br><span class="hljs-built_in">print</span>(my_beetle.get_descriptive_name())<br>my_tesla = ElectricCar(<span class="hljs-string">&#x27;tesla&#x27;</span>, <span class="hljs-string">&#x27;roadster&#x27;</span>, <span class="hljs-number">2019</span>)<br><span class="hljs-built_in">print</span>(my_tesla.get_descriptive_name())<br></code></pre></td></tr></table></figure>
<p>f. 使用别名</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> electric_car <span class="hljs-keyword">import</span> ElectricCar <span class="hljs-keyword">as</span> EC<br>my_tesla = EC(<span class="hljs-string">&#x27;tesla&#x27;</span>, <span class="hljs-string">&#x27;roadster&#x27;</span>, <span class="hljs-number">2019</span>)<br></code></pre></td></tr></table></figure>
<h3 id="2-文件和异常"><a href="#2-文件和异常" class="headerlink" title="2. 文件和异常"></a>2. 文件和异常</h3><p>　 本章中，你将学习处理文件，让程序能够快速地分析大量数 据；你将学习错误处理，避免程序在面对意外情形时崩溃；你 将学习异常 ，它们是Python创建的特殊对象，用于管理程序运 行时出现的错误；你还将学习模块json ，它让你能够保存用户数据，以免在程序停止运行后丢失。</p>
<p><strong>从文件中读取数据</strong></p>
<p>要使用文本文件中的信息，首先需要将信息读取到内存中。为此，你可以一次性读取文件的全部内容，也可以以每次一行的方式逐步读取。</p>
<p>a. 读取整个文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;pi.txt&#x27;</span>) <span class="hljs-keyword">as</span> file_object:<br>    contents = file_object.read() <br><span class="hljs-built_in">print</span>(contents)<br></code></pre></td></tr></table></figure>
<p>​    在这个程序中，函数<code>open()</code>先打开文件，这样我们才能访问它。参数填入要打开的文件的名称，返回一个表示文件的对象，Python将该对象赋给file_object 供以后使用。关键字with在不再需要访问文件后将其关闭。</p>
<p>b. 为什么不用<code>close()</code>关闭文件？</p>
<p>​    用<code>close()</code>关闭文件时，如果程序存在bug导致方法close() 未执行，文件将不会关闭。这看似微不足道，但未妥善关闭文件可能导致数据丢失或受损。如果在程序中过早调用close() ，你会发现需要使用文件时它已关闭 （这将导致文件无法访问），这会导致更多的错误。并非在任何情况下都能准确的确定关闭文件的恰当时机，但通过使用前面所示的结构，可让Python去确定：你只管打开文件，并在需要时使用它，Python自会在合适的时 候自动将其关闭。</p>
<p>c. <code>read()</code>读取内容</p>
<p>​    有了表示pi_digits.txt的文件对象后，使用方法<code>read()</code>读取这个文件的全部内容，并将其作为一个长长的字符 串赋给变量contents 。这样，通过打印contents 的值，就可将这个文本文件的全部内容显示出来：</p>
<p>d. 读取内容末尾多出来一个空行</p>
<p>​    相比于原始文件，该输出唯一不同的地方是末尾多了一个空行。因为<code>read()</code>到达文件末尾时返回一个空字符串，而将这个空字符串显示出来时就是一个空行。要删除多出来的空行，可在函数调用print() 中使用rstrip() ：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;pi_digits.txt&#x27;</span>) <span class="hljs-keyword">as</span> file_object:<br>	contents = file_object.read()<br><span class="hljs-built_in">print</span>(contents.rstrip())<br></code></pre></td></tr></table></figure>
<p><strong>文件路径</strong></p>
<p>不写文件路径时，Python将只在当前目录中查找，不会在子文件夹或上级文件夹中查找。</p>
<p>相对文件路径：相对于当前程序所在目录。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;text_files/filename.txt&#x27;</span>) <span class="hljs-keyword">as</span> file_object:<br></code></pre></td></tr></table></figure>
<p>这行代码让Python到当前文件目录的子文件夹text_files中去查找指定的.txt文件。</p>
<p>注意：显示文件路径时，Windows系统使用反斜杠<code>\</code>而不是斜杠<code>/</code>，但在代码中依然可以使用斜杠。如果在文件路径中直接使用反斜杠，将引发错误，因为反斜杠用于对字符串中的字符进行转义。</p>
<p>绝对路径：可读取系统中任何地方的文件。</p>
<p><strong>逐行读取</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">filename=<span class="hljs-string">&#x27;pi.txt&#x27;</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(filename) <span class="hljs-keyword">as</span> fo:<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> fo:<br>        <span class="hljs-built_in">print</span>(line)<br></code></pre></td></tr></table></figure>
<p>打印每一行时，发现空白行更多了：</p>
<p>每行末尾都有两个换行符：一个来自文件，另一个来自函数调用print() 。要消除这些多余的空白行，可在函数调用print() 中使用rstrip() 。</p>
<p><strong>创建一个包含文件各行内容的列表</strong></p>
<p>使用关键字with时，open() 返回的文件对象只在with 代码块内可用。如果要在with代码块外访问文件的内容，可在with代码块内将文件的各行存储在一个外部列表中。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">filename=<span class="hljs-string">&#x27;pi.txt&#x27;</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(filename) <span class="hljs-keyword">as</span> fo:<br>    lines=fo.readlines()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> lines:<br>    <span class="hljs-built_in">print</span>(i.rstrip())<br></code></pre></td></tr></table></figure>
<p><strong>使用文件的内容</strong></p>
<p>将文件读取到内存中后，就能以任何方式使用这些数据了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">filename=<span class="hljs-string">&#x27;pi.txt&#x27;</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(filename) <span class="hljs-keyword">as</span> fo:<br>    lines=fo.readlines()<br>pi_str=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> lines:<br>    pi_str+=i.rstrip()<br><span class="hljs-built_in">print</span>(pi_str)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(pi_str))<br></code></pre></td></tr></table></figure>
<p>注意：读取文本文件时，Python将其中的所有文本都解读为字符串。如果读取的是数，并要将其作为数值使用，就必须使用函数int() 将其转换为整数或使用函数float() 将其转换为浮点数。</p>
<p><strong>写文件</strong></p>
<p>要将文本写入文件，需要在调用open() 时提供另一个实参为：读取模式<code>&#39;r&#39;</code>、写入模式 <code>&#39;w&#39;</code>、附加模式<code>&#39;a&#39;</code>或读写模式<code>&#39;r+&#39;</code>。如果省略了模式实参，Python将默认用只读模式打开文件。</p>
<p>如果要写入的文件不存在，函数open() 将自动创建它。然而，以<code>&#39;w&#39;</code>模式打开文件时千万要小心，因为如果指定的文件已经存在，Python将清空该文件，不想这样的话可以用<code>&#39;a&#39;</code>模式。</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs vim">filename=<span class="hljs-string">&#x27;pi.txt&#x27;</span><br>with <span class="hljs-keyword">open</span>(<span class="hljs-string">&#x27;pi.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> <span class="hljs-keyword">fo</span>:<br>    <span class="hljs-keyword">fo</span>.<span class="hljs-keyword">write</span>(<span class="hljs-string">&#x27;love U!&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>注意：Python只能写入字符串格式。如果要写入数据，必须先使用函数<code>str()</code>将其转换为字符串格 式。</p>
<p><strong>异常</strong></p>
<p>异常使用<code>try-except</code> 代码块处理，让 Python在出现异常时执行指定的操作，让程序在出现异常时也可以继续运行。</p>
<p>a. 处理异常</p>
<p>ZeroDivisionError为用数除以0时触发的异常，处理起来可以这样：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">try</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-number">5</span>/<span class="hljs-number">0</span>)<br><span class="hljs-keyword">except</span> ZeroDivisionError:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;you can\&#x27;t do this&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>把可能会触发异常的代码放到try模块里，except里为异常处理程序。</p>
<p>b. 使用异常避免崩溃</p>
<p>程序崩溃让用户看到traceback并不好，不懂技术的用户会被搞糊涂，怀有恶意的用户还会通过traceback获悉你不想他知道的信息。</p>
<p>例如，他将知道你的程序文件的名称，还将看到部分不能正确运行的代码。有时候，训练有素的攻击者可根据这些信息判断出可对你的代码发起什么样的攻击。</p>
<p>c. else 代码块</p>
<p>try-except-else 代码块的工作原理大致如下。Python先执行try代码块中的代码，只有可能引发异常的代码才需要放在try 语句中，有时候下面的代码需要用到try中的语句，放到try- except内部会导致程序冗余，放到外部会触发别的异常，因此Python有一个else代码块，专门用来放置这部分代码。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    fir=<span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;plz input the first num:&#x27;</span>)<br>    sec=<span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;plz input the second num:&#x27;</span>)<br>    <span class="hljs-keyword">if</span> sec==<span class="hljs-string">&#x27;q&#x27;</span>:<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">try</span>:<br>        ans=<span class="hljs-built_in">int</span>(fir)/<span class="hljs-built_in">int</span>(sec)<br>    <span class="hljs-keyword">except</span> ZeroDivisionError:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;the second num can\&#x27;t be 0&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure>
<p><strong>处理FileNotFoundError 异常</strong></p>
<p>使用文件时，一种常见的问题是找不到文件：查找的文件可能在其他地方，文件名可能不正确，或者这个文件根本就不存在。对于这些情形，都可使用try-except 代码块以直观的方式处理。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">try</span>:<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;i.txt&#x27;</span>,encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> fo:<br>        contents=fo.read()<br><span class="hljs-keyword">except</span> FileNotFoundError:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;file not found&#x27;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(contents.rstrip())<br></code></pre></td></tr></table></figure>
<p>参数encoding 在系统的默认编码与要读取文件使用的编码不一致时，必须要赋值。</p>
<p>方法<code>split()</code>以空格为分隔符将字符串分拆成单个的单词，并将这些单词都存储到一个列表中，但是有些单词可能包含标点。</p>
<p><strong>静默失败</strong></p>
<p>有时候我们希望程序在发生异常时保持沉默就可以了，就像什么都没有发生一样继续运行。Python有一个pass 语句，可用于让Python在 代码块中什么都不要做：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>():<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;i.txt&#x27;</span>,encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> fo:<br>            contents=fo.read()<br>    <span class="hljs-keyword">except</span> FileNotFoundError:<br>        <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(contents.rstrip())<br></code></pre></td></tr></table></figure>
<p><strong>存储数据</strong></p>
<p>模块json可以简单的把Python数据结构转储到文件中，并在程序再次运行时加载该文件中的数据。你还可以使用json 在 Python程序之间分享数据。更重要的是，JSON数据格式并非Python专用的，这可以让JSON格式存储的数据与使用其他编程语言的人分享。是一种轻便而有用的格式，也易于学习。</p>
<p>注意：JSON（JavaScript Object Notation）格式最初是为 JavaScript开发的，但随后成了一种常见格式，被包括Python在 内的众多语言采用。</p>
<p>a. 使用json.dump() 和json.load()</p>
<p>我们来编写一个使用json.dump() 存储一组数的程序，再使用json.load()将这些数读取到内存中的程序 。</p>
<p>函数json.dump() 接受两个实参：要存储的数据，以及可用于存储数据的文件对象（没有则创建）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> json<br>nums=[<span class="hljs-number">2</span>,<span class="hljs-number">4</span>,<span class="hljs-number">6</span>,<span class="hljs-number">2</span>,<span class="hljs-number">6</span>,<span class="hljs-number">3</span>]<br>fname=<span class="hljs-string">&#x27;num.json&#x27;</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(fname,<span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> fo:<br>    json.dump(nums,fo)<br></code></pre></td></tr></table></figure>
<p>打开文件numbers.json可以看到：</p>
<figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-string">[2, 4, 6, 2, 6, 3]</span><br></code></pre></td></tr></table></figure>
<p>下面再编写一个程序，使用json.load() 将列表读取到内存中：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> json<br>fn=<span class="hljs-string">&#x27;num.json&#x27;</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(fn) <span class="hljs-keyword">as</span> fo:<br>    nums=json.load(fo)<br><span class="hljs-built_in">print</span>(nums)<br></code></pre></td></tr></table></figure>
<p>这是一种在程序之间共享数据的简单方式。</p>
<p>示例：保存和读取用户生成的数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> json<br>fn=<span class="hljs-string">&#x27;user.json&#x27;</span><br><span class="hljs-keyword">try</span>:<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(fn) <span class="hljs-keyword">as</span> f:<br>        user=json.load(f)<br><span class="hljs-keyword">except</span> FileNotFoundError:<br>    user=<span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;your name?\n&#x27;</span>)<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(fn,<span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        json.dump(user,f)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;We&#x27;ll remember you when you come back, <span class="hljs-subst">&#123;user&#125;</span>!&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Welcome back, <span class="hljs-subst">&#123;user&#125;</span>!&quot;</span>)<br></code></pre></td></tr></table></figure>
<p>在try模块中打开文件，如果是第一次打开文件则跳到异常处理模块中创建该文件，并将数据进行存储，如果文件已存在，就直接读取并打印。</p>
<h3 id="3-测试代码"><a href="#3-测试代码" class="headerlink" title="3. 测试代码"></a>3. 测试代码</h3><p>　编写函数或类时，还可为其编写测试。通过测试，可确定代码面对各种输入都能够按要求的那样工作。</p>
<p><strong>测试方法</strong></p>
<p>要为函数编写测试用例，可先导入模块unittest 和要测试的函数，再创建一个继承unittest.TestCase 的类，并编写一系列方法对函数行为的不同方面进行测试。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#four.py的待测试代码</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_name</span>(<span class="hljs-params">first,last</span>):<br>    fname=<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;first,last&#125;</span>&#x27;</span><br>    <span class="hljs-keyword">return</span> fname.title()<br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> unittest<br><span class="hljs-keyword">from</span> four <span class="hljs-keyword">import</span> get_name<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">NamaCase</span>(unittest.TestCase):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_first_last_name</span>(<span class="hljs-params">self</span>):<br>        fname=get_name(<span class="hljs-string">&#x27;v&#x27;</span>,<span class="hljs-string">&#x27;leo&#x27;</span>)<br>        self.assertEqual(fname,<span class="hljs-string">&#x27;V Leo&#x27;</span>)<br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    unittest.main()<br></code></pre></td></tr></table></figure>
<p>创建了一个名为NamaCase的类，用于包含一系列针对待测试类的单元测试。这个类可以随意命名，但必须继承<code>unittest.TestCase</code> 类，这样Python才知道如何运行你编写的测试。</p>
<p>NamaCase只包含一个方法，命名为<code>test_first_last_name()</code>，运行脚本时，所有以<code>test_</code>打头的方法都将自动运行。在这个方法中，调用了要测试的函数<code>get_name()</code>。</p>
<p><code>assertEqual()</code>是unittest 类最有用的功能之一：断言方法，用来核实得到的结果是否与期望的结果一致，将得到的测试值与我们的期望值进行比较，如果相等的话就很nice，如果不相等的话就会输出Failed。</p>
<p><code>&#39;__main__&#39;</code> 是顶层代码执行的作用域的名称。模块的 <code>__name__</code>在通过标准输入、脚本文件或是交互式命令读入的时候会等于 <code>&#39;__main__&#39;</code>。</p>
<p>模块可以通过检查自己的 <code>__name__</code> 来得知是否运行在 main 作用域中，这使得模块可以在作为脚本或是通过 <code>python -m</code> 运行时条件性地执行一些代码，<strong>而在被 import 时不会执行</strong>。</p>
<p>简单的说，这就是一个用于在被导入时不执行，只有作为主程序时才执行的一个标志。</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-comment"># execute only if run as a script</span><br>    main()<br></code></pre></td></tr></table></figure>
<p>对软件包来说，通过加入 <code>__main__.py</code> 模块可以达到同样的效果，当使用 <code>-m</code> 运行模块时，其中的代码会被执行。</p>
<p><strong>测试类</strong></p>
<p>断言方法：检查你认为应该满足的条件是否确实满足。</p>
<p>表11-1　unittest模块中的断言方法</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>方法</th>
<th>用途</th>
</tr>
</thead>
<tbody>
<tr>
<td>assertEqual(a, b)</td>
<td>核实a == b</td>
</tr>
<tr>
<td>assertNotEqual(a, b)</td>
<td>核实a != b</td>
</tr>
<tr>
<td>assertTrue(x)</td>
<td>核实x 为True</td>
</tr>
<tr>
<td>assertFalse(x)</td>
<td>核实x 为False</td>
</tr>
<tr>
<td>assertIn(item , list )</td>
<td>核实 item 在 list 中</td>
</tr>
<tr>
<td>assertNotIn(item , list )</td>
<td>核实 item 不在 list 中</td>
</tr>
</tbody>
</table>
</div>
<p>测试AnonymousSurvey 类</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">AnonymousSurvey</span>:<br>	<span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,ques</span>) :<br>		self.ques=ques<br>		self.resp=[]<br>	<span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>(<span class="hljs-params">self</span>):<br>		<span class="hljs-built_in">print</span>(self.ques)<br>	<span class="hljs-keyword">def</span> <span class="hljs-title function_">store</span>(<span class="hljs-params">self ,new</span>):<br>		self.resp.append(new)<br>	<span class="hljs-keyword">def</span> <span class="hljs-title function_">results</span>(<span class="hljs-params">self</span>):<br>		<span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Results:&#x27;</span>)<br>		<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> self.resp:<br>			<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;-<span class="hljs-subst">&#123;i&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>
<p>下面来编写一个测试，对AnonymousSurvey 类的行为的一个方面进行验证：如果用户面对调查问题只提供一个答案，这个答案也能被妥善地存储。为此，我们将在这个答案被存储后，使用方法 assertIn() 来核实它确实在答案列表中：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> unittest <span class="hljs-keyword">from</span> survey <span class="hljs-keyword">import</span> AnonymousSurvey<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">TestAnonymousSurvey</span>(unittest.TestCase):<br>	<span class="hljs-keyword">def</span> <span class="hljs-title function_">test_store_single_response</span>(<span class="hljs-params">self</span>):<br>		question = <span class="hljs-string">&quot;What language did you first learn to speak?&quot;</span> <br>		my_survey = AnonymousSurvey(question) <br>		my_survey.store_response(<span class="hljs-string">&#x27;English&#x27;</span>) <br>		self.assertIn(<span class="hljs-string">&#x27;English&#x27;</span>, my_survey.responses)<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>	unittest.main()<br></code></pre></td></tr></table></figure>
<p><strong>方法setUp()</strong></p>
<p>在前面的测试中，我们在每个测试方法里都创建了一个AnonymousSurvey 实例，并在每个方法中都创建了答 案。unittest.TestCase 类包含的方法setUp() 让我们只需创建这些对象一次，就能在每个测试方法中使用。</p>
<p>如果在Test类中包含了方法setUp() ，Python将先运行它，再运行各个以test_ 打头的方法。这样，在你编写的每个测试方法中，都可使用在方法 setUp() 中创建的对象。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> unittest<br><span class="hljs-keyword">from</span> four <span class="hljs-keyword">import</span> AnonymousSurvey<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">TestAnnony</span>(unittest.TestCase):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">setUp</span>(<span class="hljs-params">self</span>):<br>        ques=<span class="hljs-string">&quot;What language did you first learn to speak?&quot;</span><br>        self.my_sur=AnonymousSurvey(ques)<br>        self.resp=[<span class="hljs-string">&#x27;English&#x27;</span>,<span class="hljs-string">&#x27;Spanish&#x27;</span>,<span class="hljs-string">&#x27;Mandarin&#x27;</span>]<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_one</span>(<span class="hljs-params">self</span>):<br>        self.my_sur.store(self.resp[<span class="hljs-number">0</span>])<br>        self.assertIn(self.resp[<span class="hljs-number">0</span>],self.my_sur.resp[<span class="hljs-number">0</span>])<br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    unittest.main()<br></code></pre></td></tr></table></figure>
<p>方法setUp() 做了两件事情：创建一个测试用的调查对象，以及创建一个测试用答案列表。存储这两样东西的变量名包含前缀self （即存储在属性中），因此可在这个类的任何地方使用。这让两个测试方法都更简单，因为它们都不用创建调查对象和答案了。只用看测试类的答案和答案列表是否相符即可。</p>
<hr>
<h2 id="一、下载数据"><a href="#一、下载数据" class="headerlink" title="一、下载数据"></a>一、下载数据</h2><p>本章将访问并可视化的数据以两种常见格式存储：CSV和 JSON。</p>
<h3 id="案例一、全球温度图表csv"><a href="#案例一、全球温度图表csv" class="headerlink" title="案例一、全球温度图表csv"></a>案例一、全球温度图表csv</h3><p><strong>CSV文件格式</strong></p>
<p>要在文本文件中存储数据，一个简单方式是将数据作为一系列以逗号分隔的值 （comma-separated values）写入文件。这样的文件称 为CSV 文件。例如，下面是一行CSV格式的天气数据：</p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey"><span class="hljs-string">&quot;USW00025333&quot;</span>,<span class="hljs-string">&quot;SITKA AIRPORT, AK US&quot;</span>,<span class="hljs-string">&quot;2018-01-01&quot;</span>,<span class="hljs-string">&quot;0.45&quot;</span>,,<span class="hljs-string">&quot;48&quot;</span>,<span class="hljs-string">&quot;38&quot;</span><br></code></pre></td></tr></table></figure>
<p>CSV文件对人来说阅读起来比较麻烦，但程序可轻松提取并处理其中的值，有助于加快数据分析过程。</p>
<p><strong>分析CSV文件头</strong></p>
<p>csv 模块包含在Python标准库中，可用于分析CSV文件中的数据行。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> csv<br>filename=<span class="hljs-string">&#x27;../sitka_weather_07-2018_simple.csv&#x27;</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(filename) <span class="hljs-keyword">as</span>  f:<br>    reader=csv.reader(f)<br>    header_row=<span class="hljs-built_in">next</span>(reader)<br>    <span class="hljs-built_in">print</span>(header_row)<br></code></pre></td></tr></table></figure>
<p>调用<code>csv.reader()</code>创建一个与该文件相关联的阅读器对象，调用next()传入阅读器对象时，它将返 回文件中的下一行。在上述代码中，只调用了next() 一次，没有把每次循环的数据传入列表，因此得到的是文件的第一行，其中包含文件头。</p>
<p>reader 处理文件中以逗号分隔的第一行数据，并将每项数据都作为一个元素存储在列表中。</p>
<p><strong>打印文件头及其位置</strong></p>
<p>为了让文件头数据更容易理解，将列表中的每个文件头及其位置打印出来：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> csv<br>filename=<span class="hljs-string">&#x27;../sitka_weather_07-2018_simple.csv&#x27;</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(filename) <span class="hljs-keyword">as</span>  f:<br>    reader=csv.reader(f)<br>    header_row=<span class="hljs-built_in">next</span>(reader)<br>    <span class="hljs-keyword">for</span> index, column_header <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(header_row):<br>        <span class="hljs-built_in">print</span>(index, column_header)<br></code></pre></td></tr></table></figure>
<p>在循环中，对列表调用了<code>enumerate()</code> 来获取每个元素的索引及其值。</p>
<p><strong>提取并读取数据</strong></p>
<p>知道需要哪些列中的数据后，我们来读取一些数据。首先，读取每天的最高温度：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> csv<br>filename=<span class="hljs-string">&#x27;../sitka_weather_07-2018_simple.csv&#x27;</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(filename) <span class="hljs-keyword">as</span>  f:<br>    reader=csv.reader(f)<br>    header_row=<span class="hljs-built_in">next</span>(reader)<br>    highs=[]<br>    <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> reader:<br>      <span class="hljs-comment">#第五列为温度数据</span><br>        high=<span class="hljs-built_in">int</span>(row[<span class="hljs-number">5</span>])<br>        highs.append(high)<br><span class="hljs-built_in">print</span>(highs)<br></code></pre></td></tr></table></figure>
<p><strong>绘制温度图表</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> csv<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br>filename=<span class="hljs-string">&#x27;../sitka_weather_07-2018_simple.csv&#x27;</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(filename) <span class="hljs-keyword">as</span>  f:<br>    reader=csv.reader(f)<br>    header_row=<span class="hljs-built_in">next</span>(reader)<br>    highs=[]<br>    <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> reader:<br>        high=<span class="hljs-built_in">int</span>(row[<span class="hljs-number">5</span>])<br>        highs.append(high)<br>plt.style.use(<span class="hljs-string">&#x27;seaborn&#x27;</span>)<br>fig,ax=plt.subplots()<br>ax.plot(highs,c=<span class="hljs-string">&#x27;pink&#x27;</span>)<br>ax.set_title(<span class="hljs-string">&quot;2018年7月每日最高温度&quot;</span>, fontsize=<span class="hljs-number">24</span>)<br>ax.set_xlabel(<span class="hljs-string">&#x27;&#x27;</span>, fontsize=<span class="hljs-number">16</span>)<br>ax.set_ylabel(<span class="hljs-string">&quot;温度 (F)&quot;</span>, fontsize=<span class="hljs-number">16</span>)<br>ax.tick_params(axis=<span class="hljs-string">&#x27;both&#x27;</span>, which=<span class="hljs-string">&#x27;major&#x27;</span>, labelsize=<span class="hljs-number">16</span>)<br>plt.show()<br></code></pre></td></tr></table></figure>
<p><strong>模块datetime</strong></p>
<p>导入模块datetime 中的datetime 类，再调用方法<code>strptime()</code>，并将包含所需日期的字符串作为第一个实参。第二个实参告诉Python如何设置日期的格式。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>实参</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>%A</td>
<td>星期几，如Monday</td>
</tr>
<tr>
<td>%B</td>
<td>月份名，如January</td>
</tr>
<tr>
<td>%m</td>
<td>用数表示的月份（01～12）</td>
</tr>
<tr>
<td>%d</td>
<td>用数表示的月份中的一天（01～31）</td>
</tr>
<tr>
<td>%Y</td>
<td>四位的年份，如2019</td>
</tr>
<tr>
<td>%y</td>
<td>两位的年份，如19</td>
</tr>
<tr>
<td>%H</td>
<td>24小时制的小时数（00～23）</td>
</tr>
<tr>
<td>%I</td>
<td>12小时制的小时数（01～12）</td>
</tr>
<tr>
<td>%p</td>
<td>am或pm</td>
</tr>
<tr>
<td>%M</td>
<td>分钟数（00～59）</td>
</tr>
<tr>
<td>%S</td>
<td>秒数（00～61）</td>
</tr>
</tbody>
</table>
</div>
<p><strong>在图表中添加日期</strong></p>
<p>可以通过提取日期和最高温度并将其传递给plot() ，对温度图形进行改进</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> csv<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br>filename=<span class="hljs-string">&#x27;../sitka_weather_07-2018_simple.csv&#x27;</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(filename) <span class="hljs-keyword">as</span>  f:<br>    reader=csv.reader(f)<br>    header_row=<span class="hljs-built_in">next</span>(reader)<br>    dates=[]<br>    highs=[]<br>    <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> reader:<br>      <span class="hljs-comment">#将包含日期信息的数据（row[2]）转换为datetime 对象</span><br>        current_date = datetime.strptime(row[<span class="hljs-number">2</span>],<span class="hljs-string">&#x27;%Y-%m-%d&#x27;</span>)<br>        high=<span class="hljs-built_in">int</span>(row[<span class="hljs-number">5</span>])<br>        dates.append(current_date)<br>        highs.append(high)<br>plt.style.use(<span class="hljs-string">&#x27;seaborn&#x27;</span>)<br>fig,ax=plt.subplots()<br>ax.plot(dates,highs,c=<span class="hljs-string">&#x27;pink&#x27;</span>)<br>ax.set_title(<span class="hljs-string">&quot;2018年7月每日最高温度&quot;</span>, fontsize=<span class="hljs-number">24</span>)<br>ax.set_xlabel(<span class="hljs-string">&#x27;&#x27;</span>, fontsize=<span class="hljs-number">16</span>)<br><span class="hljs-comment">#绘制倾斜的日期标签，以免其彼此重叠</span><br>fig.autofmt_xdate()<br>ax.set_ylabel(<span class="hljs-string">&quot;温度 (F)&quot;</span>, fontsize=<span class="hljs-number">16</span>)<br>ax.tick_params(axis=<span class="hljs-string">&#x27;both&#x27;</span>, which=<span class="hljs-string">&#x27;major&#x27;</span>, labelsize=<span class="hljs-number">16</span>)<br>plt.show()<br></code></pre></td></tr></table></figure>
<p><strong>给图表区域着色</strong></p>
<p>使用方法<code>fill_between()</code> 。它接受一个x值系列和两个y值系列，并填充两个y值系列之间的空间</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">    <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> reader:<br>        current_date = datetime.strptime(row[<span class="hljs-number">2</span>],<span class="hljs-string">&#x27;%Y-%m-%d&#x27;</span>)<br>        high=<span class="hljs-built_in">int</span>(row[<span class="hljs-number">5</span>])<br>        low=<span class="hljs-built_in">int</span>(row[<span class="hljs-number">6</span>])<br>        dates.append(current_date)<br>        highs.append(high)<br>        lows.append(low)<br>plt.style.use(<span class="hljs-string">&#x27;seaborn&#x27;</span>)<br>fig,ax=plt.subplots()<br>ax.plot(dates,highs,c=<span class="hljs-string">&#x27;pink&#x27;</span>,alpha=<span class="hljs-number">0.5</span>)<br>ax.plot(dates,lows,c=<span class="hljs-string">&#x27;yellow&#x27;</span>,alpha=<span class="hljs-number">0.5</span>)<br>ax.fill_between(dates,highs,lows,facecolor=<span class="hljs-string">&#x27;blue&#x27;</span>,alpha=<span class="hljs-number">0.1</span>)<br></code></pre></td></tr></table></figure>
<p>alpha 指定颜色的透明度。alpha 值为0表示完全透明，为1（默认）表示完全不透明。实参facecolor指定填充区域的颜色</p>
<p><img src="/../img/image-20220917195455887.png" srcset="/img/loading.gif" lazyload alt="image-20220917195455887" style="zoom:50%;"></p>
<h3 id="案例二、全球地震散点图json"><a href="#案例二、全球地震散点图json" class="headerlink" title="案例二、全球地震散点图json"></a>案例二、全球地震散点图json</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> json<br>fn=<span class="hljs-string">&#x27;./eq_data_1_day_m1.json&#x27;</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(fn) <span class="hljs-keyword">as</span> f:<br>    data=json.load(f)<br>reader_file=<span class="hljs-string">&#x27;readable_eq_data.json&#x27;</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(reader_file,<span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    json.dump(data,f,indent=<span class="hljs-number">4</span>)<br></code></pre></td></tr></table></figure>
<p>函数json.load() 将数据转换为 Python能够处理的格式，这里是一个庞大的字典。参数indent=4 让dump() 使用与数据结构匹配的缩进量来设置数据的格式。</p>
<p><strong>创建地震列表</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> json<br>fn=<span class="hljs-string">&#x27;./eq_data_1_day_m1.json&#x27;</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(fn) <span class="hljs-keyword">as</span> f:<br>    data=json.load(f)<br>dics=data[<span class="hljs-string">&#x27;features&#x27;</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(dics))<br></code></pre></td></tr></table></figure>
<p>提取与键 ‘features’ 相关联的数据,记录了158次地震</p>
<p>每次地震的震级都存储在相应字典 的’properties’ 部分的’mag’ 键下，依次将地震震级赋给变量mag ，再将这个变量附加到列表mags 末尾。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> json<br>fn=<span class="hljs-string">&#x27;./eq_data_1_day_m1.json&#x27;</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(fn) <span class="hljs-keyword">as</span> f:<br>    data=json.load(f)<br>dics=data[<span class="hljs-string">&#x27;features&#x27;</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(dics))<br>mags=[]<br><span class="hljs-keyword">for</span> eq_dict <span class="hljs-keyword">in</span> data:<br>    mag=eq_dict[<span class="hljs-string">&#x27;properties&#x27;</span>][<span class="hljs-string">&#x27;mag&#x27;</span>]<br>    mags.append(mag)<br><span class="hljs-built_in">print</span>((mag[:<span class="hljs-number">10</span>]))<br></code></pre></td></tr></table></figure>
<p><strong>绘制震级散点图</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> plotly.express <span class="hljs-keyword">as</span> px<br>fig = px.scatter( x=lons, y=lats,<br>	labels=&#123;<span class="hljs-string">&quot;x&quot;</span>: <span class="hljs-string">&quot;经度&quot;</span>, <span class="hljs-string">&quot;y&quot;</span>: <span class="hljs-string">&quot;纬度&quot;</span>&#125;,<br>	range_x=[-<span class="hljs-number">200</span>, <span class="hljs-number">200</span>], range_y=[-<span class="hljs-number">90</span>, <span class="hljs-number">90</span>], <br>  width=<span class="hljs-number">800</span>, height=<span class="hljs-number">800</span>,<br>	title=<span class="hljs-string">&quot;全球地震散点图&quot;</span>,)<br>fig.write_html(<span class="hljs-string">&quot;global_earthquakes.html&quot;</span>) <br>fig.show()<br></code></pre></td></tr></table></figure>
<p>调用px.scatter 函数配置参数创建一个fig 实例，分别设置x轴为经度［范围是[-200, 200]］、y 轴为纬度［范围是[-90, 90] ］，设置散点图显示的宽度和高度均为800像素，并设置标题为“全球地震散点图”。</p>
<p>散点图配置完成，返回一个fig 对象。fig.write_html 方法可以将可视化图保存为html文件。</p>
<p><strong>另一种指定图表数据的方式</strong></p>
<p>使用pandas数据分析工具，创建一个DataFrame ，将需要的数据封装起来：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br>data = pd.DataFrame( data=<span class="hljs-built_in">zip</span>(lons, lats, titles, mags), <br>columns=[<span class="hljs-string">&quot;经度&quot;</span>, <span class="hljs-string">&quot;纬度&quot;</span>, <span class="hljs-string">&quot;位置&quot;</span>, <span class="hljs-string">&quot;震级&quot;</span>] ) <br>data.head()<br></code></pre></td></tr></table></figure>
<p>在这种方式中，所有有关数据的信息都以键值对的形式放在一个字 典中。如果在eq_plot.py中使用这些代码，生成的图表是一样的。 相比于前一种格式，这种格式让我们能够无缝衔接数据分析，并且更轻松地进行定制。</p>
<p><strong>渐变</strong></p>
<p>Plotly Express有大量的渐变可供选择。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> plotly.express <span class="hljs-keyword">as</span> px<br><span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> px.colors.named_colorscales():<br>	<span class="hljs-built_in">print</span>(key)<br></code></pre></td></tr></table></figure>
<p>使用px.colors.diverging.RdYlGn[::-1] 可以将对应颜色的配色列表反转。</p>
<p><strong>添加鼠标指向时显示的文本</strong></p>
<p>Plotly Express的操作非常简单，只需要将hover_name 参数配置为data 的”位置” 字段即可。</p>
<h2 id="二、使用API"><a href="#二、使用API" class="headerlink" title="二、使用API"></a>二、使用API</h2><p>使用Web应用程序编程接口（API）自动请求网站的特定信息而不是整个网页，再对这些信息进行可视化。由于这样编写的程序始终使用最新的数据进行可视化，即便数据瞬息万变，它呈现的信息也是最新的。</p>
<p><strong>使用Web API</strong></p>
<p>Web API是网站的一部分，用于与使用具体URL请求特定信息的程序交互。这种请求称为API调用。请求的数据将以易于处理的格式（如JSON或CSV）返回。</p>
<p><strong>使用API调用请求数据</strong></p>
<p>GitHub的API让你能够通过API调用来请求各种信息。</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">https://api.github.<span class="hljs-keyword">com</span>/<span class="hljs-built_in">search</span>/repositories?q=<span class="hljs-keyword">language</span>:<span class="hljs-keyword">python</span>&amp;<span class="hljs-keyword">sort</span>=<span class="hljs-keyword">star</span><br></code></pre></td></tr></table></figure>
<p>这个调用返回GitHub当前托管了多少个Python项目，以及有关最受欢迎的Python仓库的信息。下面来仔细研究这个调用。开头的 <a target="_blank" rel="noopener" href="https://api.github.com/">https://api.github.com/</a> 将请求发送到GitHub网站中响应API 调用的部分，接下来的search/repositories 让API搜索GitHub 上的所有仓库。</p>
<p>repositories 后面的问号指出需要传递一个实参。q 表示查询，而等号（=）让我们能够开始指定查询。我们使用language:python指出只想获取主要语言为Python的仓库的信息。最后的&amp;sort=stars指定将项目按星级排序。</p>
<p><strong>安装Requests</strong></p>
<p>Requests包让Python程序能够轻松地向网站请求信息并检查返回的响应。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-comment"># 执行API调用并存储响应。</span><br>url=<span class="hljs-string">&#x27;https://api.github.com/search/repositories?q=language:python&amp;sort=star&#x27;</span><br>headers=&#123;<span class="hljs-string">&#x27;Accept&#x27;</span>: <span class="hljs-string">&#x27;application/vnd.github.v3+json&#x27;</span>&#125;<br>r=requests.get(url,headers=headers)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Status code:<span class="hljs-subst">&#123;r.status_code&#125;</span>&quot;</span>)<br><span class="hljs-comment"># 将API响应赋给一个变量。</span><br>response_dict=r.json()<br><span class="hljs-built_in">print</span>(response_dict.keys())<br></code></pre></td></tr></table></figure>
<p>url存储API调用的URL，最新的GitHub API版本为第3版，因此通过指定headers 显式地要求使用这个版本的API，再使用requests 调用API。响应对象包含一个名为status_code 的属性，指出了请求是否成功 （状态码200表示请求成功）。</p>
<p>这个API返回JSON格式的信息，因此使用方法json() 将这些信息转换为一个Python字典，最后，打印response_dict 中的键，输出如下：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">Status <span class="hljs-selector-tag">code</span>: <span class="hljs-number">200</span> <br><span class="hljs-function"><span class="hljs-title">dict_keys</span><span class="hljs-params">([<span class="hljs-string">&#x27;total_count&#x27;</span>, <span class="hljs-string">&#x27;incomplete_results&#x27;</span>, <span class="hljs-string">&#x27;items&#x27;</span>])</span></span><br></code></pre></td></tr></table></figure>
<p><strong>处理响应字典</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-comment"># 执行API调用并存储响应。</span><br>url=<span class="hljs-string">&#x27;https://api.github.com/search/repositories?q=language:python&amp;sort=star&#x27;</span><br>headers=&#123;<span class="hljs-string">&#x27;Accept&#x27;</span>: <span class="hljs-string">&#x27;application/vnd.github.v3+json&#x27;</span>&#125;<br>r=requests.get(url,headers=headers)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Status code:<span class="hljs-subst">&#123;r.status_code&#125;</span>&quot;</span>)<br><span class="hljs-comment"># 将API响应赋给一个变量。</span><br>response_dict=r.json()<br><span class="hljs-comment">#打印与&#x27;total_count&#x27; 相关联的值，它指出了GitHub总 共包含多少个Python仓库。</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Total repositories: <span class="hljs-subst">&#123;response_dict[<span class="hljs-string">&#x27;total_count&#x27;</span>]&#125;</span>&quot;</span>)<br><span class="hljs-comment"># 探索有关仓库的信息。</span><br>repo_dicts=response_dict[<span class="hljs-string">&#x27;item&#x27;</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Repositories returned: <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(repo_dicts)&#125;</span>&quot;</span>)<br><span class="hljs-comment"># 研究第一个仓库。</span><br>repo_dict=repo_dicts[<span class="hljs-number">0</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\nKeys: <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(repo_dict)&#125;</span>&quot;</span>)<br><span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> <span class="hljs-built_in">sorted</span>(repo_dict.keys()):<br>    <span class="hljs-built_in">print</span>(key)<br></code></pre></td></tr></table></figure>
<p>GitHub的API返回有关仓库的大量信息：repo_dict 包含73个键。通过仔细查看这些键，可大致知道可提取有关项目的哪些信息。</p>
<p>要准确地获悉API将返回哪些信息，要么阅读文档，要么像这里一样使用代码来查看。</p>
<p><strong>监视API的速率限制</strong></p>
<p>大多数API存在速率限制，也就是说，在特定时间内可执行的请求数存在限制。</p>
<p>要获悉是否接近了GitHub的限制，请在浏览器中输入 <a target="_blank" rel="noopener" href="https://api.github.com/rate_limit">https://api.github.com/rate_limit</a></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-attr">&quot;limit&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">10</span><span class="hljs-punctuation">,</span><br></code></pre></td></tr></table></figure>
<p>配额极限为每分钟10个请求，用完配额后，你将收到一条简单的响应，由此知道已到达API极限。到达极限后，必须等待配额重置。</p>
<p><strong>使用Plotly可视化仓库</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests <br><span class="hljs-keyword">from</span> plotly.graph_objs <span class="hljs-keyword">import</span> Bar <br><span class="hljs-keyword">from</span> plotly <span class="hljs-keyword">import</span> offline<br><br> <span class="hljs-comment"># 执行API调用并存储响应。 </span><br> url = <span class="hljs-string">&#x27;https://api.github.com/search/repositories?q=language:python&amp;sort=stars&#x27;</span><br> headers = &#123;<span class="hljs-string">&#x27;Accept&#x27;</span>: <span class="hljs-string">&#x27;application/vnd.github.v3+json&#x27;</span>&#125;<br> r = requests.get(url, headers=headers) <br> <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Status code: <span class="hljs-subst">&#123;r.status_code&#125;</span>&quot;</span>)<br><span class="hljs-comment"># 处理结果。 </span><br> response_dict = r.json()<br> repo_dicts = response_dict[<span class="hljs-string">&#x27;items&#x27;</span>]<br> repo_names, stars = [], []<br> <span class="hljs-keyword">for</span> repo_dict <span class="hljs-keyword">in</span> repo_dicts:<br> 		repo_names.append(repo_dict[<span class="hljs-string">&#x27;name&#x27;</span>])<br>    stars.append(repo_dict[<span class="hljs-string">&#x27;stargazers_count&#x27;</span>])<br><span class="hljs-comment"># 可视化。</span><br>data = [&#123; <br>	<span class="hljs-string">&#x27;type&#x27;</span>: <span class="hljs-string">&#x27;bar&#x27;</span>, <br>	<span class="hljs-string">&#x27;x&#x27;</span>: repo_names, <br>	<span class="hljs-string">&#x27;y&#x27;</span>: stars, <br>  <span class="hljs-comment">#给条形指定了颜色和边框，给条形指定了一种自定义的蓝色，加上了宽1.5像素的深灰色轮廓，还将条形的不透明度设置为0.6，</span><br>	<span class="hljs-string">&#x27;marker&#x27;</span>: &#123; <br>		<span class="hljs-string">&#x27;color&#x27;</span>: <span class="hljs-string">&#x27;rgb(60, 100, 150)&#x27;</span>, <br>		<span class="hljs-string">&#x27;line&#x27;</span>: &#123;<span class="hljs-string">&#x27;width&#x27;</span>: <span class="hljs-number">1.5</span>, <span class="hljs-string">&#x27;color&#x27;</span>: <span class="hljs-string">&#x27;rgb(25, 25, 25)&#x27;</span>&#125; <br>		&#125;, <br>	<span class="hljs-string">&#x27;opacity&#x27;</span>: <span class="hljs-number">0.6</span>,<br>&#125;]<br>my_layout = &#123; <br>	<span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;GitHub上最受欢迎的Python项目&#x27;</span>, <br>	<span class="hljs-string">&#x27;xaxis&#x27;</span>: &#123;<span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;Repository&#x27;</span>&#125;, <br>	<span class="hljs-string">&#x27;yaxis&#x27;</span>: &#123;<span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;Stars&#x27;</span>&#125;, <br>	&#125;<br>fig = &#123;<span class="hljs-string">&#x27;data&#x27;</span>: data, <span class="hljs-string">&#x27;layout&#x27;</span>: my_layout&#125; <br>offline.plot(fig, filename=<span class="hljs-string">&#x27;python_repos.html&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>在data 和 my_layout 中以键值对的形式指定各种样式。</p>
<p><strong>添加自定义工具提示</strong></p>
<p>在列表data 包含的字典中，添加了键’hovertext’ ，并将与之关联的值指定为刚创建的列表</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">label=<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;owner&#125;</span>&lt;br/&gt;<span class="hljs-subst">&#123;description&#125;</span>&quot;</span><br>labels.append(label)<br>data = [&#123;<br>	<span class="hljs-string">&#x27;type&#x27;</span>: <span class="hljs-string">&#x27;bar&#x27;</span>, <br>	<span class="hljs-string">&#x27;x&#x27;</span>: repo_names, <br>	<span class="hljs-string">&#x27;y&#x27;</span>: stars, <br>	<span class="hljs-string">&#x27;hovertext&#x27;</span>: labels, 	<br>&#125;]<br></code></pre></td></tr></table></figure>
<p>在观察者将鼠标指向条形时，显示label标签中的内容。</p>
<p><strong>在图表中添加可单击的链接</strong></p>
<p>将x轴标签作为链接，让观察者能够访问项目在 GitHub上的主页。为此，需要提取URL并用其生成x 轴标签：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> repo_dict <span class="hljs-keyword">in</span> repo_dicts:<br>	repo_name = repo_dict[<span class="hljs-string">&#x27;name&#x27;</span>]<br>  <span class="hljs-comment">#从repo_dict 中提取项目的URL</span><br>	repo_url = repo_dict[<span class="hljs-string">&#x27;html_url&#x27;</span>]<br>  <span class="hljs-comment">#创建一个指向项目的链接</span><br>	repo_link = <span class="hljs-string">f&quot;&lt;a href=&#x27;<span class="hljs-subst">&#123;repo_url&#125;</span>&#x27;&gt;<span class="hljs-subst">&#123;repo_name&#125;</span>&lt;/a&gt;&quot;</span><br>  <span class="hljs-comment">#将链接附加到列表repo_links 末尾。</span><br>	repo_links.append(repo_link)<br> data = [&#123;<br>		<span class="hljs-string">&#x27;type&#x27;</span>: <span class="hljs-string">&#x27;bar&#x27;</span>, <br>   	<span class="hljs-string">&#x27;x&#x27;</span>: repo_links, <br>   	<span class="hljs-string">&#x27;y&#x27;</span>: stars,<br>		--snip-<br> &#125;]<br></code></pre></td></tr></table></figure>
<p>将这个列表用作图表的x值。生成的图表与前面相同，但可单击图表底端的项目名，以访问项目在GitHub上的主页。</p>
<p><strong>深入了解Plotly和GitHub API</strong></p>
<p><a target="_blank" rel="noopener" href="https://www.geeksforgeeks.org/python-plotly-tutorial/">Plotly自助文档</a></p>
<p><a target="_blank" rel="noopener" href="https://plotly.com/python/reference/layout/">可视化所有设置</a></p>
<hr>
<h3 id="项目一：外星人入侵"><a href="#项目一：外星人入侵" class="headerlink" title="项目一：外星人入侵"></a>项目一：外星人入侵</h3><p>本项目将使用Pygame模块，用于管理图形、动画乃至声音，让你能够更轻松地开发复杂的游戏。</p>
<p><strong>阶段一</strong></p>
<p>创建一艘飞船，可以左右移动，并且能在用户按空格键时开火。设置好这种行为后，就可以创建外星人并提高游戏的可玩性了。</p>
<p>先来安装Pygame，可使用pip 模块来帮助下载并安装 Python包。要安装Pygame，在终端提示符下执行如下命令：</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs tex">python3 -m pip install --user pygame<br>python3<br>import pygame<br></code></pre></td></tr></table></figure>
<p><strong>开始游戏项目</strong></p>
<p>首先创建一个空的Pygame窗口，并让这个游戏响应用户输入，设置背景色，以及加载飞船图像。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> pygame<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">AlienInvasion</span>:<br>  <span class="hljs-comment">#访问Pygame检测到的事件</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>      <span class="hljs-comment">#初始化游戏并创建游戏资源</span><br>        pygame.init()<br>        self.screen=pygame.display.set_mode((<span class="hljs-number">1200</span>,<span class="hljs-number">800</span>))<br>        pygame.display.set_caption(<span class="hljs-string">&quot;Alien Invasion&quot;</span>)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run_game</span>(<span class="hljs-params">self</span>):<br>      <span class="hljs-comment">#开始游戏的主循环</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>          <span class="hljs-comment">#监视键盘和鼠标事件</span><br>            <span class="hljs-keyword">for</span> event <span class="hljs-keyword">in</span> pygame.event.get():<br>                <span class="hljs-keyword">if</span> event.<span class="hljs-built_in">type</span>==pygame.QUIT:<br>                    sys.exit()<br>            <span class="hljs-comment">#让最近绘制的屏幕可见</span><br>            pygame.display.flip()<br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&#x27;__main__&#x27;</span>:<br>  <span class="hljs-comment">#创建游戏实例并运行游戏</span><br>    ai=AlienInvasion()<br>    ai.run_game()<br></code></pre></td></tr></table></figure>
<p>a. 导入模块</p>
<p>首先，导入模块sys和pygame 。模块pygame 包含开发游戏所需的功能，模块sys中的工具用来退出游戏。</p>
<p>b. 初始化显示窗口</p>
<p><code>pygame.init()</code>初始化背景设置，<code>pygame.display.set_mode()</code>创建一个显示窗口，游戏的所有图形元素都将在其中绘制。实参(1200, 800) 是一个元组，指定了游戏窗口的尺寸——宽1200像素、高800 像素。将这个显示窗口赋给属性<code>self.screen</code> ，让这个类中的所有方法都能够使用它。</p>
<p>c. surface元素</p>
<p>在这个游戏中，每个元素（如外星人或飞船）都是一个surface。<code>display.set_mode()</code>返回的surface表示整个游戏窗口。激活游戏的动画循环后，每经过一次循环都将自动重绘这个surface。</p>
<p>d. 运行游戏</p>
<p>方法<code>run_game()</code> 有无限循环的 while 循环，循环内用来放监听事件和事件响应。</p>
<p>c. 响应事件</p>
<p><code>pygame.event.get()</code>用于访问Pygame检测到的事件，这个函数返回一个事件列表，所有键盘和鼠标事件都将导致这个for 循环运行。</p>
<p>d. 换帧</p>
<p><code>pygame.display.flip()</code> 函数命令Pygame显示最近绘制的屏幕。在这个程序里，它每次执行while 循环时都会绘制一个空屏幕，并擦去旧屏幕。我们移动游戏元素时，<code>pygame.display.flip()</code>将不断更新屏幕，以显示元素的新位置，并且在原来的位置隐藏元素，从而营造平滑移动的效果。</p>
<p>e. 创建实例</p>
<p>创建一个游戏实例并调用<code>run_game()</code> 。如果此时运行alien_invasion.py，将看到一个空的Pygame窗口。</p>
<p><strong>设置背景色</strong></p>
<p>在Pygame中，颜色是以RGB值指定的，我们自定义一个元祖赋给self.bg_color作为RGB参数。并在while循环内调用方法<code>fill()</code> 用背景色填充屏幕，方法<code>fill()</code>用于处理surface，接受一个RGB实参，在每次循环时都用该背景色重绘屏幕。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> pygame<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">AlienInvasion</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        pygame.init()<br>        self.screen=pygame.display.set_mode((<span class="hljs-number">1200</span>,<span class="hljs-number">800</span>))<br>        pygame.display.set_caption(<span class="hljs-string">&quot;Alien Invasion&quot;</span>)<br>        self.bg_color=(<span class="hljs-number">227</span>, <span class="hljs-number">234</span>, <span class="hljs-number">255</span>)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run_game</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            <span class="hljs-keyword">for</span> event <span class="hljs-keyword">in</span> pygame.event.get():<br>                <span class="hljs-keyword">if</span> event.<span class="hljs-built_in">type</span>==pygame.QUIT:<br>                    sys.exit()<br>            self.screen.fill((self.bg_color))<br>            pygame.display.flip()<br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    ai=AlienInvasion()<br>    ai.run_game()<br></code></pre></td></tr></table></figure>
<p><strong>创建设置类</strong></p>
<p>每次给游戏添加新功能时，都要引入一些新设置。下面来编写一个settings模块，用于将所有设置都存储在一个地方，以免在代码中到处添加设置。</p>
<p>在文件夹alien_invasion中，新建一个名为settings.py的文件，并在其中添加如下Settings 类：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Settings</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.screen_width=<span class="hljs-number">1200</span><br>        self.screen_height=<span class="hljs-number">800</span><br>        self.bg_color=(<span class="hljs-number">227</span>, <span class="hljs-number">234</span>, <span class="hljs-number">255</span>)<br></code></pre></td></tr></table></figure>
<p>并将 alien_invasion.py修改成下面这样：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> pygame<br><span class="hljs-keyword">from</span> settings <span class="hljs-keyword">import</span> Settings<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">AlienInvasion</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        pygame.init()<br>        self.settings=Settings()       			<br>     		self.screen=pygame.display.set_mode((self.settings.screen_width,<br>                                             self.settings.screen_height))<br>        pygame.display.set_caption(<span class="hljs-string">&quot;Alien Invasion&quot;</span>)<span class="hljs-comment">#设置窗口标题</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run_game</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            <span class="hljs-keyword">for</span> event <span class="hljs-keyword">in</span> pygame.event.get():<br>                <span class="hljs-keyword">if</span> event.<span class="hljs-built_in">type</span>==pygame.QUIT:<br>                    sys.exit()<br>            self.screen.fill((self.settings.bg_color))<br>            pygame.display.flip()<br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    ai=AlienInvasion()<br>    ai.run_game()<br></code></pre></td></tr></table></figure>
<p>创建的Settings类被赋给<code>self.settings</code>，接下来就可以作为AlienInvasion示例本身的属性来调用了。</p>
<p><strong>添加飞船图像</strong></p>
<p>为了在屏幕上绘制玩家的飞船，我们将加 载一幅图像，再使用Pygame方法blit() 绘制它。在游戏中几乎可以使用任何类型的图像文件，但使用位图（.bmp） 文件最为简单，因为Pygame默认加载位图，可使用Photoshop、 GIMP和Paint等工具将其转换为位图。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pygame<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Ship</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,ai_game</span>):<br>        self.screen=ai_game.screen<br>        self.screen_rect=ai_game.screen.get_rect()<br>        <span class="hljs-comment"># 加载飞船图像并获取其外接矩形。</span><br>        self.proto=pygame.image.load(<span class="hljs-string">&#x27;airsvg.svg&#x27;</span>)<br>        self.image=pygame.transform.scale(self.proto,(<span class="hljs-number">200</span>,<span class="hljs-number">100</span>))<br>        self.rect = self.image.get_rect()<br>        <span class="hljs-comment"># 对于每艘新飞船，都将其放在屏幕底部的中央。</span><br>        self.rect.midbottom = self.screen_rect.midbottom<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">blitme</span>(<span class="hljs-params">self</span>):<br>      	<span class="hljs-comment">#在指定位置绘制飞船。</span><br>        self.screen.blit(self.image, self.rect)<br>        <span class="hljs-comment">#pygame.transform.scale(Surface, (width, height), DestSurface = None) </span><br>        <span class="hljs-comment">#转化大小</span><br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> pygame<br><span class="hljs-keyword">from</span> ship <span class="hljs-keyword">import</span> Ship<br><span class="hljs-keyword">from</span> settings <span class="hljs-keyword">import</span> Settings<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">AlienInvasion</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        pygame.init()<br>        self.settings=Settings()<br>        self.screen=pygame.display.set_mode(<br>          (self.settings.screen_width,<br>           self.settings.screen_height))<br>        pygame.display.set_caption(<span class="hljs-string">&quot;Alien Invasion&quot;</span>)<br>        self.ship = Ship(self)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run_game</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            <span class="hljs-keyword">for</span> event <span class="hljs-keyword">in</span> pygame.event.get():<br>                <span class="hljs-keyword">if</span> event.<span class="hljs-built_in">type</span>==pygame.QUIT:<br>                    sys.exit()<br>            self.screen.fill((self.settings.bg_color))<br>            self.ship.blitme()<br>            pygame.display.flip()<br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    ai=AlienInvasion()<br>    ai.run_game()<br></code></pre></td></tr></table></figure>
<p>Pygame之所以高效，是因为它让你能够像处理矩形（rect 对象） 一样处理所有的游戏元素。</p>
<p>Ship传进去一个当前AlienInvasion 实例的引用来访问AlienInvasion中定义的所有游戏资源。<code>get_rect()</code>函数的作用是将我们的图片的位置用代码的形式告诉我们。</p>
<p><img src="/../img/image-20220913202941197.png" srcset="/img/loading.gif" lazyload alt="image-20220913202941197"></p>
<p>调用<code>pygame.image.load()</code>加载图像，并将飞船图像的位置传递给它。该函数返回一个表示飞船的surface，将这个 surface赋给了self.image 。加载图像后，使用get_rect() 获取相应surface的属性rect ，以便后面能够把图片的位置和外框的底部中央对齐起来。</p>
<ul>
<li>处理rect 对象时，可通过设置它的属性值来指定矩形的位置。</li>
<li>让游戏元素居中，可设置相应 rect 对象的属性center 、centerx 或centery ；</li>
<li>让游戏元素与屏幕边缘对齐，可使用属性top 、bottom 、left 或right 。</li>
<li>还有一些组合属性，可同时设置两个方向，如midbottom 、midtop 、midleft 和 midright 。</li>
<li>要调整游戏元素的水平或垂直位置，可使用属性x和y ，分别是相应矩形左上角的坐标和坐标。</li>
</ul>
<p><strong><code>pygame.surface.blit()</code>方法</strong></p>
<p>假设有两个surface对象，简称为图，函数<code>B.blit(A,dest)</code>的功能就是把图A粘贴到图B上，这意味着B上的图将被A上的图覆盖，且永久不能恢复。</p>
<p><code>blit（）</code>的原型是<code>blit（source, dest, area=None, special_flags = 0）</code>，返回值为rect对象，返回被改变的画面区域，例如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">screen=pygame.display.set_mode(<span class="hljs-number">200</span>,<span class="hljs-number">200</span>)	<span class="hljs-comment">#screen是Surface实例，宽高各为200</span><br>screen.blit(image,(<span class="hljs-number">10</span>,<span class="hljs-number">10</span>))		<span class="hljs-comment">#image是某图像，(10,10)是screen坐标</span><br></code></pre></td></tr></table></figure>
<p>先创建一个surface实例B，再把图A粘贴到图B的某一位置上。第二个参数为一个坐标标识，可以是一个（x，y）元组。也可以是一个（x，y，height，width）元组，也可以是一个Rect对象，Rect对象可以理解为有位置有大小的矩形。</p>
<p>pygame的坐标体系中以左上角为原点，向右向下两个方向作x轴y轴，构成坐标（x，y），注意是被画的B对象的左上角，如果这个对象是屏幕，那就是屏幕的左上角了。如果传入一个Rect对象给dest，那么blit()会使用传入Rect对象的左上角坐标，而忽略Rect的宽和高。例如：</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs crystal">screen = pygame.display.set_mode(<span class="hljs-number">200</span>,<span class="hljs-number">200</span>)<br>rect=image.get_rect()<br>rect.x=<span class="hljs-number">10</span><br>rect.y=<span class="hljs-number">10</span><br>screen.blit(image, rect)	<span class="hljs-comment">#效果同上边代码</span><br></code></pre></td></tr></table></figure>
<p>blit方法的第3和第4个参数都有默认值，实际使用中可以不使用这两个参数。可选参数area是一个Rect对象，表示从source的area区域取出图像绘制到screen上。</p>
<p><strong>重构</strong></p>
<p>在大型项目中，经常需要在添加新代码前重构既有代码。重构旨在简化代码结构，把一大段代码分割成多个不同的函数，易于扩展和管理。本节将把越来越长的方法 run_game() 拆分成两个辅助方法（helper method）。辅助方法在 类中执行任务，但并非是通过实例调用的。在Python中，辅助方法的名称以单个下划线打头。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> pygame<br><span class="hljs-keyword">from</span> ship <span class="hljs-keyword">import</span> Ship<br><span class="hljs-keyword">from</span> settings <span class="hljs-keyword">import</span> Settings<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">AlienInvasion</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        pygame.init()<br>        self.settings=Settings()<br>        self.screen=pygame.display.set_mode((self.settings.screen_width,self.settings.screen_height))<br>        pygame.display.set_caption(<span class="hljs-string">&quot;Alien Invasion&quot;</span>)<br>        self.ship = Ship(self)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run_game</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            self._check_events()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_check_events</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">for</span> event <span class="hljs-keyword">in</span> pygame.event.get():<br>            <span class="hljs-keyword">if</span> event.<span class="hljs-built_in">type</span> == pygame.QUIT:<br>                sys.exit()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_update_screen</span>(<span class="hljs-params">self</span>):<br>        self.screen.fill((self.settings.bg_color))<br>        self.ship.blitme()<br>        pygame.display.flip()<br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    ai=AlienInvasion()<br>    ai.run_game()<br></code></pre></td></tr></table></figure>
<p><strong>驾驶飞船</strong></p>
<p>下面来编写代码，在用户按左或右箭头键时做出响应。</p>
<p>a. 响应按键</p>
<p>每当用户执行动作时，都会在Pygame中注册一个事件，事件都是通过方法pygame.event.get() 获取的，因此需要在方法 _check_events() 中指定要检查哪些类型的事件。每次按键都被注册为一个KEYDOWN 事件。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">_check_events</span>(<span class="hljs-params">self</span>):<br>    <span class="hljs-keyword">for</span> event <span class="hljs-keyword">in</span> pygame.event.get():<br>        <span class="hljs-keyword">if</span> event.<span class="hljs-built_in">type</span> == pygame.QUIT:<br>            sys.exit()<br>        <span class="hljs-keyword">elif</span> event.<span class="hljs-built_in">type</span>==pygame.KEYDOWN:<br>            <span class="hljs-keyword">if</span> event.key==pygame.K_RIGHT:<br>                self.ship.rect.x+=<span class="hljs-number">1</span><br>            <span class="hljs-keyword">elif</span> event.key==pygame.K_LEFT:<br>                self.ship.rect.x-=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>
<p>b. 允许持续移动</p>
<p>玩家按住右键不放时，我们希望飞船不断向右移动，直到玩家松开为止。我们将让游戏检测<code>pygame.KEYUP</code>事件，以便知道玩家何时松开右键。然后，结合使用<code>KEYDOWN</code>和<code>KEYUP</code>事件以及一个名为<code>moving_right</code> 和<code>moving_left</code>的标志来实现持续移动。</p>
<p>当标志为False 时，飞船不会移动。玩家按下右键时，我们将该标志设置为True ，在玩家松开时将该标志重新设置为False 。</p>
<p>飞船的属性都由Ship 类控制，因此要给这个类添加一个名为<code>moving_right</code> 和<code>moving_left</code>的属性以及一个名为<code>update()</code> 的方法。方法<code>update()</code>检查标志的状态，在while 循环中调用这个方法，以调整飞船的位置。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">_check_events</span>(<span class="hljs-params">self</span>):<br>    <span class="hljs-keyword">for</span> event <span class="hljs-keyword">in</span> pygame.event.get():<br>        <span class="hljs-keyword">if</span> event.<span class="hljs-built_in">type</span> == pygame.QUIT:<br>            sys.exit()<br>        <span class="hljs-keyword">elif</span> event.<span class="hljs-built_in">type</span>==pygame.KEYDOWN:<br>            <span class="hljs-keyword">if</span> event.key==pygame.K_RIGHT:<br>                self.ship.moving_right=<span class="hljs-literal">True</span><br>            <span class="hljs-keyword">elif</span> event.key==pygame.K_LEFT:<br>                self.ship.moving_left=<span class="hljs-literal">True</span><br>        <span class="hljs-keyword">elif</span> event.<span class="hljs-built_in">type</span>==pygame.KEYUP:<br>            self.ship.moving_left=<span class="hljs-literal">False</span><br>            self.ship.moving_right=<span class="hljs-literal">False</span><br></code></pre></td></tr></table></figure>
<p>如果在keyup时让左右键标志都置为False的话，当同时按下左右键，只要松开其中一个飞机就停止动作了，这种游戏机制太严格了，还是分别检测吧。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">_check_events</span>(<span class="hljs-params">self</span>):<br>    <span class="hljs-keyword">for</span> event <span class="hljs-keyword">in</span> pygame.event.get():<br>        <span class="hljs-keyword">if</span> event.<span class="hljs-built_in">type</span> == pygame.QUIT:<br>            sys.exit()<br>        <span class="hljs-keyword">elif</span> event.<span class="hljs-built_in">type</span>==pygame.KEYDOWN:<br>            <span class="hljs-keyword">if</span> event.key==pygame.K_RIGHT:<br>                self.ship.moving_right=<span class="hljs-literal">True</span><br>            <span class="hljs-keyword">elif</span> event.key==pygame.K_LEFT:<br>                self.ship.moving_left=<span class="hljs-literal">True</span><br>        <span class="hljs-keyword">elif</span> event.<span class="hljs-built_in">type</span>==pygame.KEYUP:<br>            <span class="hljs-keyword">if</span> event.key == pygame.K_RIGHT:<br>                self.ship.moving_right = <span class="hljs-literal">False</span><br>            <span class="hljs-keyword">elif</span> event.key == pygame.K_LEFT:<br>                self.ship.moving_left = <span class="hljs-literal">False</span><br></code></pre></td></tr></table></figure>
<p>Ship类：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pygame<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Ship</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,ai_game</span>):<br>        self.screen=ai_game.screen<br>        self.screen_rect=ai_game.screen.get_rect()<br>        self.proto=pygame.image.load(<span class="hljs-string">&#x27;airsvg.svg&#x27;</span>)<br>        self.image=pygame.transform.scale(self.proto,(<span class="hljs-number">200</span>,<span class="hljs-number">100</span>))<br>        self.rect = self.image.get_rect()<br>        self.rect.midbottom = self.screen_rect.midbottom<br>        self.moving_right=<span class="hljs-literal">False</span><br>        self.moving_left=<span class="hljs-literal">False</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">blitme</span>(<span class="hljs-params">self</span>):<br>        self.screen.blit(self.image, self.rect)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">update</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">if</span> self.moving_right:<br>            self.rect.x+=<span class="hljs-number">1</span><br>        <span class="hljs-keyword">elif</span> self.moving_left:<br>            self.rect.x-=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>
<p><strong>调整飞船的速度</strong></p>
<p>当前，每次执行while 循环时，飞船最多移动1像素，但可 在Settings 类中添加属性ship_speed ，用于控制飞船的速度。使用函数float() 将速度的值转换为小数，才能准确进行运算 。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Settings</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.screen_width=<span class="hljs-number">1200</span><br>        self.screen_height=<span class="hljs-number">800</span><br>        self.bg_color=(<span class="hljs-number">230</span>, <span class="hljs-number">230</span>, <span class="hljs-number">230</span>)<br>        self.ship_speed=<span class="hljs-number">1.5</span><br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pygame<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Ship</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,ai_game</span>):<br>        self.screen=ai_game.screen<br>        self.screen_rect=ai_game.screen.get_rect()<br>        self.proto=pygame.image.load(<span class="hljs-string">&#x27;airsvg.svg&#x27;</span>)<br>        self.image=pygame.transform.scale(self.proto,(<span class="hljs-number">200</span>,<span class="hljs-number">100</span>))<br>        self.rect = self.image.get_rect()<br>        self.rect.midbottom = self.screen_rect.midbottom<br>        self.moving_right=<span class="hljs-literal">False</span><br>        self.moving_left=<span class="hljs-literal">False</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">blitme</span>(<span class="hljs-params">self</span>):<br>        self.screen.blit(self.image, self.rect)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">update</span>(<span class="hljs-params">self,speed</span>):<br>        <span class="hljs-keyword">if</span> self.moving_right:<br>            self.rect.x+=<span class="hljs-built_in">float</span>(speed)<br>        <span class="hljs-keyword">elif</span> self.moving_left:<br>            self.rect.x-=<span class="hljs-built_in">float</span>(speed)<br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> pygame<br><span class="hljs-keyword">from</span> ship <span class="hljs-keyword">import</span> Ship<br><span class="hljs-keyword">from</span> settings <span class="hljs-keyword">import</span> Settings<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">AlienInvasion</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        pygame.init()<br>        self.settings=Settings()<br>        self.screen=pygame.display.set_mode((self.settings.screen_width,self.settings.screen_height))<br>        pygame.display.set_caption(<span class="hljs-string">&quot;Alien Invasion&quot;</span>)<br>        self.ship = Ship(self)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run_game</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            self._check_events()<br>            self.ship.update(self.settings.ship_speed)<br>            self._update_screen()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_check_events</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">for</span> event <span class="hljs-keyword">in</span> pygame.event.get():<br>            <span class="hljs-keyword">if</span> event.<span class="hljs-built_in">type</span> == pygame.QUIT:<br>                sys.exit()<br>            <span class="hljs-keyword">elif</span> event.<span class="hljs-built_in">type</span>==pygame.KEYDOWN:<br>                <span class="hljs-keyword">if</span> event.key==pygame.K_RIGHT:<br>                    self.ship.moving_right=<span class="hljs-literal">True</span><br>                <span class="hljs-keyword">elif</span> event.key==pygame.K_LEFT:<br>                    self.ship.moving_left=<span class="hljs-literal">True</span><br>            <span class="hljs-keyword">elif</span> event.<span class="hljs-built_in">type</span>==pygame.KEYUP:<br>                <span class="hljs-keyword">if</span> event.key == pygame.K_RIGHT:<br>                    self.ship.moving_right = <span class="hljs-literal">False</span><br>                <span class="hljs-keyword">elif</span> event.key == pygame.K_LEFT:<br>                    self.ship.moving_left = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_update_screen</span>(<span class="hljs-params">self</span>):<br>        self.screen.fill((self.settings.bg_color))<br>        self.ship.blitme()<br>        pygame.display.flip()<br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    ai=AlienInvasion()<br>    ai.run_game()<br></code></pre></td></tr></table></figure>
<p><strong>限制飞船的活动范围</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">update</span>(<span class="hljs-params">self,speed</span>):<br>    <span class="hljs-keyword">if</span> self.moving_right <span class="hljs-keyword">and</span> self.rect.right&lt;<span class="hljs-number">1200</span>:<br>        self.rect.x+=<span class="hljs-built_in">float</span>(speed)<br>    <span class="hljs-keyword">elif</span> self.moving_left <span class="hljs-keyword">and</span> self.rect.left&gt;<span class="hljs-number">0</span>:<br>        self.rect.x-=<span class="hljs-built_in">float</span>(speed)<br></code></pre></td></tr></table></figure>
<p>随着游戏的开发，方法_check_events() 将越来越长。因此将其部分代码放在两个方法中，其中一个处理KEYDOWN 事件，另一个处理KEYUP 事件。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">_check_events</span>(<span class="hljs-params">self</span>):<br>    <span class="hljs-keyword">for</span> event <span class="hljs-keyword">in</span> pygame.event.get():<br>        <span class="hljs-keyword">if</span> event.<span class="hljs-built_in">type</span> == pygame.QUIT:<br>            sys.exit()<br>        <span class="hljs-keyword">elif</span> event.<span class="hljs-built_in">type</span>==pygame.KEYDOWN:<br>            self._check_keydown_events(event)<br>        <span class="hljs-keyword">elif</span> event.<span class="hljs-built_in">type</span>==pygame.KEYUP:<br>            self._check_keyup_events(event)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">_check_keydown_events</span>(<span class="hljs-params">self, event</span>):<br>    <span class="hljs-keyword">if</span> event.key == pygame.K_RIGHT:<br>        self.ship.moving_right = <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">elif</span> event.key == pygame.K_LEFT:<br>        self.ship.moving_left = <span class="hljs-literal">True</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">_check_keyup_events</span>(<span class="hljs-params">self, event</span>):<br>    <span class="hljs-keyword">if</span> event.key == pygame.K_RIGHT:<br>        self.ship.moving_right = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">elif</span> event.key == pygame.K_LEFT:<br>        self.ship.moving_left = <span class="hljs-literal">False</span><br></code></pre></td></tr></table></figure>
<p><strong>全屏模式</strong></p>
<p>要在全屏模式下运行该游戏，可在<code>__init()__</code>中做如下修改：</p>
<p>创建屏幕时传入尺寸(0, 0) 以及参数<code>pygame.FULLSCREEN</code>。这让Pygame生成一个覆盖整个显示器的屏幕。由于无法预先知道屏幕的宽度和高度，要在创建屏幕后更新这些设置：使用屏幕的rect 的属性width 和height 来更新对象settings 。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>    pygame.init()<br>    self.settings=Settings()<br>    self.screen=pygame.display.set_mode((<span class="hljs-number">0</span>,<span class="hljs-number">0</span>),pygame.FULLSCREEN)<br>    self.settings.screen_width=self.screen.get_rect().width<br>    self.settings.screen_height=self.screen.get_rect().height<br>    pygame.display.set_caption(<span class="hljs-string">&quot;Alien Invasion&quot;</span>)<br>    self.ship = Ship(self)<br></code></pre></td></tr></table></figure>
<p>注意：在全屏模式下运行这款游戏之前，请确认能够按Q键退出，因为Pygame默认不提供在全屏模式下退出游戏的方式。</p>
<p><strong>射击</strong></p>
<p>我们将编写在玩家按空格键时发射子弹的代码，子弹将在屏幕中向上飞行，抵达屏幕上边缘 后消失。</p>
<p>a. 添加子弹设置</p>
<p>首先，更新settings.py，存储新类Bullet 所需的值：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>	--snip-<br>	<span class="hljs-comment"># 子弹设置 </span><br>	self.bullet_speed = <span class="hljs-number">1.0</span> <br>	self.bullet_width = <span class="hljs-number">3</span> <br>	self.bullet_height = <span class="hljs-number">15</span> <br>	self.bullet_color = (<span class="hljs-number">60</span>, <span class="hljs-number">60</span>, <span class="hljs-number">60</span>)<br></code></pre></td></tr></table></figure>
<p>b. 创建Bullet 类</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pygame <br><span class="hljs-keyword">from</span> pygame.sprite <span class="hljs-keyword">import</span> Sprite<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Bullet</span>(<span class="hljs-title class_ inherited__">Sprite</span>):<br>	<span class="hljs-string">&quot;&quot;&quot;管理飞船所发射子弹的类&quot;&quot;&quot;</span><br>	<span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, ai_game</span>):<br>		<span class="hljs-string">&quot;&quot;&quot;在飞船当前位置创建一个子弹对象。&quot;&quot;&quot;</span> <br>		<span class="hljs-built_in">super</span>().__init__() <br>		self.screen = ai_game.screen <br>		self.settings = ai_game.settings <br>		self.color = self.settings.bullet_color<br>		<span class="hljs-comment">#在(0,0)处创建一个表示子弹的矩形，再设置正确的位置。 </span><br>		self.rect = pygame.Rect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <br>		self.settings.bullet_width, 			<br>		self.settings.bullet_height) <br>		self.rect.midtop = ai_game.ship.rect.midtop<br>		<span class="hljs-comment"># 存储用小数表示的子弹位置。 </span><br>		self.y = <span class="hljs-built_in">float</span>(self.rect.y)<br></code></pre></td></tr></table></figure>
<p>Bullet 类继承了Sprite 类。通过使用精灵（sprite），可将游戏中相关的元素编组，进而同时用for循环操作编组中的所有元素。<code>pygame.sprite.group</code>中的一个值得注意的method是<code>draw(surface)</code>，可以直接将group里面的每一个sprite对象在surface上通过<code>surface.blit()</code>操作进行绘制，见下例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#创建一个sprite类实例aliens</span><br>aliens.draw(screen)<br><span class="hljs-keyword">for</span> alien <span class="hljs-keyword">in</span> aliens.sprites():<br>    screen.blit(alien.image, alien.rect)<br></code></pre></td></tr></table></figure>
<p>本例中，先调用super() 来继承Sprite，再创建子弹属性的rect</p>
<p>因为子弹并非基于图像，所以必须使用pygame.Rect() 类从头开始创建一个矩形。创建这个类的实例 时，必须提供矩形左上角的x坐标和y坐标，以及矩形的宽度和高度。我们在(0, 0)处创建这个矩形，但下一行代码就将其移到了正确的位置，因为子弹的初始位置取决于飞船当前的位置。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Bullet</span>(<span class="hljs-title class_ inherited__">Sprite</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,ai_game</span>):<br>        <span class="hljs-built_in">super</span>().__init__()<br>        self.screen=ai_game.screen<br>        self.settings=ai_game.settings<br>        self.color = self.settings.bullet_color<br>        self.rect = pygame.Rect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, self.settings.bullet_width, self.settings.bullet_height)<br>        self.rect.midtop = ai_game.ship.rect.midtop<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">update</span>(<span class="hljs-params">self</span>):<br>        self.rect.y-=self.settings.bullet_speed<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">draw_bullet</span>(<span class="hljs-params">self</span>):<br>        pygame.draw.ellipse(self.screen, self.color, self.rect)<br></code></pre></td></tr></table></figure>
<p>c. 将子弹存储到编组中</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>	--snip-<br>	self.ship = Ship(self)<br>	self.bullets = pygame.sprite.Group()<br></code></pre></td></tr></table></figure>
<p>然后在while 循环中更新子弹的位置：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">run_game</span>(<span class="hljs-params">self</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        self._check_events()<br>        self.ship.update(self.settings.ship_speed,self.settings.screen_width)<br>        self.bullets.update()<br>        self._update_screen()<br></code></pre></td></tr></table></figure>
<p>d. Fire</p>
<p>e. 删除屏幕外的子弹</p>
<p>使用for循环遍历Pygame编组时，Python要求该列表的长度在整个循环中保持不变。因此不能从for 循环遍历的列表或编组中删除元素，所以必须遍历编组的副本。</p>
<p>我们使用方法copy() 来设置for 循环，从而能够在循环中修改bullets 。</p>
<p>f. 限制子弹数量</p>
<p>将未消失的子弹数限制为三颗，在创建新子弹前检查未消失的子弹数是否小于该设置：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">_fire_bullet</span>(<span class="hljs-params">self</span>):<br>	<span class="hljs-string">&quot;&quot;&quot;创建新子弹并将其加入编组bullets中。&quot;&quot;&quot;</span><br>	<span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self.bullets) &lt; self.settings.bullets_allowed:<br>		new_bullet = Bullet(self) self.bullets.add(new_bullet)<br></code></pre></td></tr></table></figure>
<p>g. 让主循环包含尽可能少的代码</p>
<p>把run_game() 中while 循环里带模块的代码都写到单独的函数里</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> pygame<br><span class="hljs-keyword">from</span> ship <span class="hljs-keyword">import</span> Ship<br><span class="hljs-keyword">from</span> settings <span class="hljs-keyword">import</span> Settings<br><span class="hljs-keyword">from</span> settings <span class="hljs-keyword">import</span> Bullet<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">AlienInvasion</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        pygame.init()<br>        self.settings=Settings()<br>        <span class="hljs-comment">#self.screen=pygame.display.set_mode((self.settings.screen_width,self.settings.screen_height))</span><br>        self.screen=pygame.display.set_mode((<span class="hljs-number">0</span>,<span class="hljs-number">0</span>),pygame.FULLSCREEN)<br>        self.settings.screen_width=self.screen.get_rect().width<br>        self.settings.screen_height=self.screen.get_rect().height<br>        pygame.display.set_caption(<span class="hljs-string">&quot;Alien Invasion&quot;</span>)<br>        self.ship = Ship(self)<br>        self.bullets=pygame.sprite.Group()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run_game</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            self._check_events()<br>            self.ship.update(self.settings.ship_speed,self.settings.screen_width)<br>            self.bullets.update()<br>            self._update_bullets()<br>            self._update_screen()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_check_events</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">for</span> event <span class="hljs-keyword">in</span> pygame.event.get():<br>            <span class="hljs-keyword">if</span> event.<span class="hljs-built_in">type</span> == pygame.QUIT:<br>                sys.exit()<br>            <span class="hljs-keyword">elif</span> event.<span class="hljs-built_in">type</span>==pygame.KEYDOWN:<br>                self._check_keydown_events(event)<br>            <span class="hljs-keyword">elif</span> event.<span class="hljs-built_in">type</span>==pygame.KEYUP:<br>                self._check_keyup_events(event)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_check_keydown_events</span>(<span class="hljs-params">self, event</span>):<br>        <span class="hljs-keyword">if</span> event.key == pygame.K_RIGHT:<br>            self.ship.moving_right = <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">elif</span> event.key == pygame.K_LEFT:<br>            self.ship.moving_left = <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">elif</span> event.key==pygame.K_q:<br>            sys.exit()<br>        <span class="hljs-keyword">elif</span> event.key==pygame.K_SPACE:<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self.bullets)&lt;self.settings.bullets_allowed:<br>                self._fire_bullet()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_check_keyup_events</span>(<span class="hljs-params">self, event</span>):<br>        <span class="hljs-keyword">if</span> event.key == pygame.K_RIGHT:<br>            self.ship.moving_right = <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">elif</span> event.key == pygame.K_LEFT:<br>            self.ship.moving_left = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_fire_bullet</span>(<span class="hljs-params">self</span>):<br>        new_bullet=Bullet(self)<br>        self.bullets.add((new_bullet))<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_update_screen</span>(<span class="hljs-params">self</span>):<br>        self.screen.fill((self.settings.bg_color))<br>        self.ship.blitme()<br>        <span class="hljs-keyword">for</span> bullet <span class="hljs-keyword">in</span> self.bullets.sprites():<br>            bullet.draw_bullet()<br>        pygame.display.flip()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_update_bullets</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">for</span> bullet <span class="hljs-keyword">in</span> self.bullets.copy():<br>            <span class="hljs-keyword">if</span> bullet.rect.bottom &lt; <span class="hljs-number">0</span>:<br>                self.bullets.remove(bullet)<br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    ai=AlienInvasion()<br>    ai.run_game()<br></code></pre></td></tr></table></figure>
<h3 id="项目二：外星人生成"><a href="#项目二：外星人生成" class="headerlink" title="项目二：外星人生成"></a>项目二：外星人生成</h3><p>目标：</p>
<ol>
<li>首先在屏幕上边缘附近添加一个外星人，再生成一群外星人。</li>
<li>让这群外星人向两边和下面移动，并删除被子弹击中的外星人。</li>
<li>显示玩家拥有的飞船数量，并在玩家的飞船用完后结束游戏。</li>
</ol>
<p><strong>创建Alien类</strong></p>
<p>将每个外星人的左边距都设置为外星 人的宽度，并将上边距设置为外星人的高度。我们主要关心的是外星人的水平速度，因此精确地记录了每个外星人的水平位置。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Alien</span>(<span class="hljs-title class_ inherited__">Sprite</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,ai_game</span>):<br>        <span class="hljs-built_in">super</span>().__init__()<br>        self.screen=ai_game.screen<br>        self.image=pygame.image.load(<span class="hljs-string">&#x27;images/alien.bmp&#x27;</span>)<br>        pygame.transform.scale(self.image,(<span class="hljs-number">20</span>,<span class="hljs-number">20</span>))<br>        <span class="hljs-comment"># 每个外星人最初都在屏幕左上角附近。</span><br>        self.rect=self.image.get_rect()<br>        self.rect.x=self.rect.width<br>        self.rect.y=self.rect.height<br>        <span class="hljs-comment"># 存储外星人的精确水平位置。</span><br>        self.x=<span class="hljs-built_in">float</span>(self.rect.x)<br></code></pre></td></tr></table></figure>
<p><strong>创建Alien实例</strong></p>
<p>我们最终会创建一群外星人，涉及的工作量不少，因此要新建一个名为_create_fleet() 的辅助方法。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>	--snip-<br>	self.ship = Ship(self) <br>	self.bullets = pygame.sprite.Group() <br>	self.aliens = pygame.sprite.Group()<br>	self._create_fleet()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">_create_fleet</span>(<span class="hljs-params">self</span>):<br>	<span class="hljs-string">&quot;&quot;&quot;创建外星人群。&quot;&quot;&quot;</span> <br>	<span class="hljs-comment"># 创建一个外星人。 </span><br>	alien = Alien(self) <br>	self.aliens.add(alien)<br></code></pre></td></tr></table></figure>
<p>要让外星人现身，需要在_update_screen() 中对外星人编组调用方法draw() ：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">self.aliens.draw(self.screen)<br></code></pre></td></tr></table></figure>
<p>对编组调用<code>draw()</code>时，Pygame将把编组中的每个元素绘制到属性rect 指定的位置。方法draw() 接受一个参数，这个参数指定了 要将编组中的元素绘制到哪个surface上。</p>
<p><strong>创建一群外星人</strong></p>
<p>计算可用于放置外星人的水平空间，还需要在外星人之间留出一定的空间，定为外星人的宽度：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">available_space_x = settings.screen_width – (<span class="hljs-number">2</span> * alien_width)<br>number_aliens_x = available_space_x // (<span class="hljs-number">2</span> * alien_width)<br></code></pre></td></tr></table></figure>
<p>Work：找一幅星星图像，并在屏幕上显示一系列随机排列的星星。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> pygame<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">from</span> pygame.sprite <span class="hljs-keyword">import</span> Sprite<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Star</span>(<span class="hljs-title class_ inherited__">Sprite</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,ai_game</span>):<br>        <span class="hljs-built_in">super</span>().__init__()<br>        self.screen=ai_game.screen<br>        self.proto=pygame.image.load(<span class="hljs-string">&#x27;star.svg&#x27;</span>)<br>        self.image=pygame.transform.scale(self.proto,(<span class="hljs-number">50</span>,<span class="hljs-number">50</span>))<br>        self.rect=self.image.get_rect()<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Sky</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        pygame.init()<br>        self.screen = pygame.display.set_mode((<span class="hljs-number">1200</span>,<span class="hljs-number">800</span>))<br>        pygame.display.set_caption(<span class="hljs-string">&quot;Stars&quot;</span>)<br>        self.bg_color=(<span class="hljs-number">255</span>, <span class="hljs-number">127</span>, <span class="hljs-number">80</span>)<br>        self.stars=pygame.sprite.Group()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run_game</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            self.update_screen()<br>            self.check()<br>            self.create()<br>        pygame.display.flip()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">update_screen</span>(<span class="hljs-params">self</span>):<br>        self.screen.fill(self.bg_color)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">check</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">for</span> event <span class="hljs-keyword">in</span> pygame.event.get():<br>            <span class="hljs-keyword">if</span> event.<span class="hljs-built_in">type</span>==pygame.QUIT:<br>                sys.exit()<br>            <span class="hljs-keyword">elif</span> event.<span class="hljs-built_in">type</span>==pygame.KEYDOWN:<br>                <span class="hljs-keyword">if</span> event.key==pygame.K_q:<br>                    sys.exit()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">create</span>(<span class="hljs-params">self</span>):<br>        num_x=random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">20</span>)<br>        num_y=random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">10</span>)<br>        <span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num_y):<br>            <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num_x):<br>                new_star=Star(self)<br>                self.stars.add(new_star)<br>                new_star.rect.x=<span class="hljs-number">100</span>+<span class="hljs-number">50</span>*num_x<br>                new_star.rect.y=<span class="hljs-number">100</span>+<span class="hljs-number">50</span>*num_y<br>        self.stars.draw(self.screen)<br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    sky=Sky()<br>    sky.run_game()<br></code></pre></td></tr></table></figure>
<p>要实现设置fleet_direction ，可将其设置为文本值，如’left’ 或’right’ ，但这样就必须编写if-elif 语句来检查外星人群的移 动方向。鉴于只有两个可能的方向，我们使用值1和-1来表示，并 在外星人群改变方向时在这两个值之间切换。</p>
<p><strong>检查外星人是否撞到了屏幕边缘</strong></p>
<p>如果外星人的rect 的属性right 大于或等于屏幕的rect 的right 属性，就说明外星人位于屏幕右边缘；如果外星人的rect 的left 属性小于或等于0，就说明外星人位于屏幕左边缘</p>
<p><strong>检测子弹与外星人的碰撞</strong></p>
<p>函数sprite.groupcollide() 将一个编组中每个元素的rect 同另一个编组中每个元素的rect 进行比较。在这里，是将每颗子弹 的rect 同每个外星人的rect 进行比较，并返回一个字典，其中包含发生了碰撞的子弹和外星人。在这个字典中，每个键都是一颗子 弹，而关联的值是被该子弹击中的外星人。</p>
<p>第一个参数为键，第二个参数为值，第三个参数为碰撞后值是否消失，第三个参数为碰撞后键是否消失。</p>
<p><strong>生成新的外星人群</strong></p>
<p>要在一群外星人被消灭后再显示一群外星人，先检查编组 aliens 是否为空。如果编组aliens 为空， 就使用方法empty() 删除bullets编组中余下的所有精灵，并新建一群外星人</p>
<p><strong>结束游戏</strong></p>
<p>检查外星人和飞船之间的碰撞，函数spritecollideany() 接受两个实参：一个精灵和一个编组。 它检查编组是否有成员与精灵发生了碰撞，并在找到与精灵发生碰撞的成员后停止遍历编组。在这里，它遍历编组aliens ，并返回找到的第一个与飞船发生碰撞的外星人。</p>
<p><u>不想看了，真的会有人用python做游戏吗</u></p>
<h4 id="项目二-数据可视化"><a href="#项目二-数据可视化" class="headerlink" title="项目二 数据可视化"></a>项目二 数据可视化</h4><h4 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h4><p>Matplotlib是一个数学绘图库，是一款优秀的可视化和分析工具，本章将使用Plotly包，它生成的图表非常适合在数字设备上显示。Plotly生成的图表可根据显示设备的尺寸自动调整大小，还具备众多交互特性，如在用户将鼠标指向图表的不同部分时突出数据集的特定方面。本章将使用Plotly来分析掷骰子的结果。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>函数名称</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>Bar</td>
<td>绘制条形图</td>
</tr>
<tr>
<td>Barh</td>
<td>绘制水平条形图</td>
</tr>
<tr>
<td>Boxplot</td>
<td>绘制箱型图</td>
</tr>
<tr>
<td>Hist</td>
<td>绘制直方图</td>
</tr>
<tr>
<td>his2d</td>
<td>绘制2D直方图</td>
</tr>
<tr>
<td>Pie</td>
<td>绘制饼状图</td>
</tr>
<tr>
<td>Plot</td>
<td>在坐标轴上画线或者标记</td>
</tr>
<tr>
<td>Polar</td>
<td>绘制极坐标图</td>
</tr>
<tr>
<td>Scatter</td>
<td>绘制x与y的散点图</td>
</tr>
<tr>
<td>Stackplot</td>
<td>绘制堆叠图</td>
</tr>
<tr>
<td>Stem</td>
<td>用来绘制二维离散数据绘制（又称为“火柴图”）</td>
</tr>
<tr>
<td>Step</td>
<td>绘制阶梯图</td>
</tr>
<tr>
<td>Quiver</td>
<td>绘制一个二维按箭头</td>
</tr>
<tr>
<td>Imread</td>
<td>从文件中读取图像的数据并形成数组。</td>
</tr>
<tr>
<td>Imsave</td>
<td>将数组另存为图像文件。</td>
</tr>
<tr>
<td>Imshow</td>
<td>在数轴区域内显示图像。</td>
</tr>
<tr>
<td>Axes</td>
<td>在画布(Figure)中添加轴</td>
</tr>
<tr>
<td>Text</td>
<td>向轴添加文本</td>
</tr>
<tr>
<td>Title</td>
<td>设置当前轴的标题</td>
</tr>
<tr>
<td>Xlabel</td>
<td>设置x轴标签</td>
</tr>
<tr>
<td>Xlim</td>
<td>获取或者设置x轴区间大小</td>
</tr>
<tr>
<td>Xscale</td>
<td>设置x轴缩放比例</td>
</tr>
<tr>
<td>Xticks</td>
<td>获取或设置x轴刻标和相应标签</td>
</tr>
<tr>
<td>Ylabel</td>
<td>设置y轴的标签</td>
</tr>
<tr>
<td>Ylim</td>
<td>获取或设置y轴的区间大小</td>
</tr>
<tr>
<td>Yscale</td>
<td>设置y轴的缩放比例</td>
</tr>
<tr>
<td>Yticks</td>
<td>获取或设置y轴的刻标和相应标签</td>
</tr>
<tr>
<td>Figtext</td>
<td>在画布上添加文本</td>
</tr>
<tr>
<td>Figure</td>
<td>创建一个新画布</td>
</tr>
<tr>
<td>Show</td>
<td>显示数字</td>
</tr>
<tr>
<td>Savefig</td>
<td>保存当前画布</td>
</tr>
<tr>
<td>Close</td>
<td>关闭画布窗口</td>
</tr>
</tbody>
</table>
</div>
<p><strong>绘制简单的折线图</strong></p>
<p>使用平方数序列1、4、 9、16和25来绘制这个图表。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br>squares=[<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,<span class="hljs-number">9</span>,<span class="hljs-number">16</span>,<span class="hljs-number">25</span>]<br>fig,ax=plt.subplots()<br>ax.plot(squares)<br>plt.show()<br></code></pre></td></tr></table></figure>
<p>创建一个名为squares 的列表，存储要用来制作图表的数据。</p>
<p>调用函数<code>subplots()</code>， 创建一个包含子图区域的画布fig，并创建一个 figure 图形对象ax。</p>
<p><code>subplots()</code> 的函数格式如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">fig , ax = plt.subplots(nrows, ncols)<br></code></pre></td></tr></table></figure>
<p>nrows 与 ncols 表示两个整数参数，它们指定子图所占的行数、列数。</p>
<p>函数的返回值是一个元组，包括一个图形对象和所有的 axes 对象。其中 axes 对象的数量等于 nrows * ncols，且每个 axes 对象均可通过索引值访问（从1开始），坐标原点位于左上角。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br>fig,a =  plt.subplots(<span class="hljs-number">2</span>,<span class="hljs-number">2</span>)<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br>x = np.arange(<span class="hljs-number">1</span>,<span class="hljs-number">5</span>)<br><span class="hljs-comment">#绘制平方函数</span><br>a[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>].plot(x,x*x)<br>a[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>].set_title(<span class="hljs-string">&#x27;square&#x27;</span>)<br><span class="hljs-comment">#绘制平方根图像</span><br>a[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>].plot(x,np.sqrt(x))<br>a[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>].set_title(<span class="hljs-string">&#x27;square root&#x27;</span>)<br><span class="hljs-comment">#绘制指数函数</span><br>a[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>].plot(x,np.exp(x))<br>a[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>].set_title(<span class="hljs-string">&#x27;exp&#x27;</span>)<br><span class="hljs-comment">#绘制对数函数</span><br>a[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>].plot(x,np.log10(x))<br>a[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>].set_title(<span class="hljs-string">&#x27;log&#x27;</span>)<br>plt.show()<br></code></pre></td></tr></table></figure>
<p><img src="/../img/image-20220917121348668.png" srcset="/img/loading.gif" lazyload alt="image-20220917121348668"></p>
<p>方法<code>plot()</code>，它尝试根据给定的数据以有意义的方式绘制图表。函数<code>plt.show()</code>打开Matplotlib查看器并显示绘制的图表。在查看器中，可以缩放和导航图形，还可单击磁盘图标将图表保存起来。</p>
<p><strong>修改标签文字和线条粗细</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">import</span> matplotlib<br>matplotlib.rc(<span class="hljs-string">&quot;font&quot;</span>,family=<span class="hljs-string">&#x27;Adobe Heiti Std&#x27;</span>)<br>squares=[<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,<span class="hljs-number">9</span>,<span class="hljs-number">16</span>,<span class="hljs-number">25</span>]<br>fig,ax=plt.subplots()<br>ax.plot(squares,linewidth=<span class="hljs-number">3</span>)<br>ax.set_title(<span class="hljs-string">&#x27;sqrt&#x27;</span>,fontsize=<span class="hljs-number">24</span>)<br>ax.set_xlabel(<span class="hljs-string">&#x27;value&#x27;</span>,fontsize=<span class="hljs-number">14</span>)<br>ax.set_ylabel(<span class="hljs-string">&#x27;value.sqrt&#x27;</span>,fontsize=<span class="hljs-number">14</span>)<br>ax.tick_params(axis=<span class="hljs-string">&#x27;both&#x27;</span>,labelsize=<span class="hljs-number">14</span>)<br>plt.show()<br></code></pre></td></tr></table></figure>
<p>⌃+左键可以查看源代码，<code>set_title()</code>给图表指定标题，方法<code>set_xlabel()</code>和<code>set_ylabel()</code>让你能够为每条轴设置标题，方法<code>tick_params()</code>设置刻度的样式，指定的实参将影响x轴和y轴上的刻度（<code>axes=&#39;both&#39;</code>为x和y轴都有刻度）。</p>
<p><strong>校正图形</strong></p>
<p>图形更容易看清后，我们发现没有正确地绘制数据：折线图的终点指出4.0的平方为25！下面来修复这个问题。向plot() 提供一系列数时，它假设第一个数据点对应的 坐标值 为0，但这里第一个点对应的值为1。为改变这种默认行为，可向plot() 同时提供输入值和输出值：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br>input_values=[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>]<br>squares=[<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,<span class="hljs-number">9</span>,<span class="hljs-number">16</span>,<span class="hljs-number">25</span>]<br>fig,ax=plt.subplots()<br>ax.plot(input_values,squares,linewidth=<span class="hljs-number">3</span>)<br>plt.show()<br></code></pre></td></tr></table></figure>
<p>现在plot() 将正确地绘制数据，因为同时提供了输入值和输出值，plot() 无须对输出值的生成方式做出假设，直接一一对应即可。</p>
<p><strong>使用内置样式</strong></p>
<p>打印全部内置样式</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> matplotlib <span class="hljs-keyword">import</span> style<br><span class="hljs-built_in">print</span>(plt.style.available)<br></code></pre></td></tr></table></figure>
<p>‘bmh’, ‘classic’, ‘dark_background’, ‘fast’, ‘fivethirtyeight’, ‘ggplot’, ‘grayscale’, ‘seaborn-bright’, ‘seaborn-muted’, ‘seaborn-notebook’, ‘seaborn-paper’, ‘seaborn-pastel’, ‘seaborn-poster’, ‘seaborn-talk’, ‘seaborn-ticks’, ‘seaborn-white’, ‘seaborn-whitegrid’, ‘seaborn’, ‘Solarize_Light2’, ‘tableau-colorblind10’, ‘_classic_test’</p>
<p>使用方法：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">plt.style.use(<span class="hljs-string">&#x27;seaborn&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>背景有格线可以用：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">plt.grid(True, linestyle=<span class="hljs-string">&#x27;-.&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p><img src="/../img/image-20220917140815396.png" srcset="/img/loading.gif" lazyload alt="image-20220917140815396" style="zoom:50%;"></p>
<p><strong>使用scatter() 绘制散点图并设置样式</strong></p>
<p>绘制散点图，你可能想以一种颜色显示较小的值，用另一种颜色显示较大的值。绘制大型数据集时，还可对每个点都设置同样的样式，再使用不同的样式选项重新绘制某些点以示突出。</p>
<p>要绘制单个点，可使用方法scatter() 。向它传递一对<code>(x,y)</code>坐标，它将在指定位置绘制一个点：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br>plt.style.use(<span class="hljs-string">&#x27;seaborn&#x27;</span>) <br>fig, ax = plt.subplots() <br>ax.scatter(<span class="hljs-number">2</span>, <span class="hljs-number">4</span>)<br><span class="hljs-comment"># 设置x和y轴刻度标记的大小，并且刻度聚焦在点的附近，并设置刻度字体的大小</span><br>ax.tick_params(axis=<span class="hljs-string">&#x27;both&#x27;</span>, which=<span class="hljs-string">&#x27;major&#x27;</span>, labelsize=<span class="hljs-number">14</span>)<br>plt.show()<br></code></pre></td></tr></table></figure>
<p><strong>使用scatter() 绘制一系列点</strong></p>
<p>要绘制一系列的点，可向<code>scatter()</code>传递两个分别包含x值和y值的列表：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br>vxs=[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>]<br>vys=[<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,<span class="hljs-number">9</span>,<span class="hljs-number">16</span>,<span class="hljs-number">25</span>]<br>plt.style.use(<span class="hljs-string">&#x27;seaborn&#x27;</span>)<br>fig, ax = plt.subplots()<br><span class="hljs-comment">#s=100设置点的大小</span><br>ax.scatter(vxs,vys,s=<span class="hljs-number">100</span>)<br>plt.show()<br></code></pre></td></tr></table></figure>
<p><strong>自动计算数据</strong></p>
<p>手工计算列表效率低下，我们可以用Python循环来完成。</p>
<p>下面是绘制1000个点的代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br>vxs=<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1001</span>)<br>vys=[x**<span class="hljs-number">2</span> <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> vxs]<br>plt.style.use(<span class="hljs-string">&#x27;seaborn&#x27;</span>)<br>fig, ax = plt.subplots()<br>ax.scatter(vxs,vys,s=<span class="hljs-number">10</span>)<br><span class="hljs-comment">#axis()设置坐标范围</span><br>ax.axis([<span class="hljs-number">0</span>,<span class="hljs-number">1100</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1100000</span>])<br>plt.show()<br></code></pre></td></tr></table></figure>
<p>方法axis() 指定了每个坐标轴的取值范围，含4个参数：x和y轴的最小值和最大值。这里将x坐标轴的取值范围设置为0～1100，并将y坐标轴的取值范围设置为 0～1 100 000。</p>
<p><strong>自定义颜色</strong></p>
<p>要修改数据点的颜色，可向<code>scatter()</code> 传递参数c</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">ax.scatter(vxs,vys,c=<span class="hljs-string">&#x27;yellow&#x27;</span>,s=<span class="hljs-number">10</span>)<br></code></pre></td></tr></table></figure>
<p>要指定自定义颜色，可传递参 数c ，并将其设置为一个元组，其中包含三个0～1的小数值，分别 表示红色、绿色和蓝色的分量。值越接近0，指定的颜色越深；值越接近1，指定的颜色越浅。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">ax.scatter(vxs,vys,c=(<span class="hljs-number">0</span>,<span class="hljs-number">0.58</span>,<span class="hljs-number">0.49</span>),s=<span class="hljs-number">10</span>)<br></code></pre></td></tr></table></figure>
<p><strong>使用颜色渐变</strong></p>
<p>用于突出数据的规律。例如，可以用较浅的颜色来显示较小的值，并使用较深的颜色来显示较大的值。以下代码将值较小的点显示为浅蓝色，并将值较大的点显示为深蓝色</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br>vxs=<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1001</span>)<br>vys=[x**<span class="hljs-number">2</span> <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> vxs]<br>plt.style.use(<span class="hljs-string">&#x27;seaborn&#x27;</span>)<br>fig, ax = plt.subplots()<br><span class="hljs-comment">#将参数c设置成一个值列表，并使用参数cmap 告诉 pyplot 使用哪个颜色映射</span><br>ax.scatter(vxs,vys,c=vys,cmap=plt.cm.Blues,s=<span class="hljs-number">10</span>)<br>ax.axis([<span class="hljs-number">0</span>,<span class="hljs-number">1100</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1100000</span>])<br>plt.show()<br></code></pre></td></tr></table></figure>
<p><img src="/../img/image-20220917160441549.png" srcset="/img/loading.gif" lazyload alt="image-20220917160441549" style="zoom:50%;"></p>
<p>注意：要了解pyplot 中所有的颜色映射，请访问Matplotlib网站主页，单击Examples，向下滚动到Color，再单击Colormaps reference。</p>
<p><strong>自动保存图表</strong></p>
<p>要让程序自动将图表保存到文件中，可将调用<code>plt.show()</code> 替换为调用<code>plt.savefig()</code> ：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">plt.savefig(<span class="hljs-string">&#x27;squares_plot.png&#x27;</span>, bbox_inches=<span class="hljs-string">&#x27;tight&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>第一个实参指定要以什么文件名保存图表，这个文件将存储到当前程序目录下。</p>
<p>第二个实参指定将图表多余的空白区域裁剪掉。如果要保留图表周围多余的空白区域，只需省略这个实参即可。</p>
<h4 id="随机漫步"><a href="#随机漫步" class="headerlink" title="随机漫步"></a>随机漫步</h4><p>每次行走都是完全随机的、没有明确的方向，结果是由一系列随机决策决定的。</p>
<p><strong>创建RandomWalk 类</strong></p>
<p>这个类需要三个属性：一个是存储漫步次数的变量，其他两个是列表，分别存储漫步经过的每个点的 x坐标和y坐标，让每次漫步都从点(0, 0)出发。</p>
<p>RandomWalk 类只包含两个方法：方法<code>__init___()</code>和 <code>fill_walk()</code>，后者计算随机漫步经过的所有点。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> choice<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">RandomWalk</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,num_points=<span class="hljs-number">5000</span></span>):<br>        self.num_points=num_points<br>        self.x_values=[<span class="hljs-number">0</span>]<br>        self.y_values=[<span class="hljs-number">0</span>]<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">fill_walk</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(self.x_values)&lt;self.num_points:<br>            <span class="hljs-comment">#随机返回1或-1,决定上下左右</span><br>            x_dir=choice([<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>])<br>            x_dis=choice([<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>])<br>            x_step=x_dis*x_dir<br>            y_dir = choice([<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>])<br>            y_dis = choice([<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>])<br>            y_step = y_dis * y_dir<br>            <span class="hljs-comment">#拒绝原地踏步</span><br>            <span class="hljs-keyword">if</span> x_step==<span class="hljs-number">0</span> <span class="hljs-keyword">and</span> y_step == <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">continue</span><br>            <span class="hljs-comment"># 计算下一个点的x值和y值，从最后一个点的坐标加上这一步走的距离中决定</span><br>            x = self.x_values[-<span class="hljs-number">1</span>] + x_step<br>            y = self.y_values[-<span class="hljs-number">1</span>] + y_step<br>            self.x_values.append(x)<br>            self.y_values.append(y)<br><br></code></pre></td></tr></table></figure>
<p><strong>绘制随机漫步图</strong></p>
<p>rw_visual.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> random_walk <span class="hljs-keyword">import</span> RandomWalk<br>rw=RandomWalk(<span class="hljs-number">100</span>)<br>rw.fill_walk()<br>plt.style.use(<span class="hljs-string">&#x27;classic&#x27;</span>)<br>fig,ax=plt.subplots()<br>ax.scatter(rw.x_values,rw.y_values,c=(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>),s=<span class="hljs-number">5</span>)<br>plt.show()<br></code></pre></td></tr></table></figure>
<p><strong>模拟多次随机漫步</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> random_walk <span class="hljs-keyword">import</span> RandomWalk<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    rw=RandomWalk(<span class="hljs-number">1000</span>)<br>    rw.fill_walk()<br>    plt.style.use(<span class="hljs-string">&#x27;classic&#x27;</span>)<br>    fig,ax=plt.subplots() <br>    ax.scatter(rw.x_values,rw.y_values,c=(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>),s=<span class="hljs-number">5</span>)<br>    plt.show()<br>    keep_running = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Make another walk? (y/n): &quot;</span>)<br>    <span class="hljs-keyword">if</span> keep_running == <span class="hljs-string">&#x27;n&#x27;</span>:<br>        <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure>
<p><strong>设置随机漫步图的样式</strong></p>
<p>本节将定制图表，以突出每次漫步的重要特征。为此，我们确定要突出的元素，如漫步的起点、 终点和经过的路径。</p>
<p>a. 给点着色</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> random_walk <span class="hljs-keyword">import</span> RandomWalk<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    rw=RandomWalk()<br>    rw.fill_walk()<br>    plt.style.use(<span class="hljs-string">&#x27;classic&#x27;</span>)<br>    fig,ax=plt.subplots()<br>    point_num=<span class="hljs-built_in">range</span>(rw.num_points)<br>    ax.scatter(rw.x_values,rw.y_values,<br>               c=point_num,cmap=plt.cm.Blues,<br>               edgecolors=<span class="hljs-string">&#x27;none&#x27;</span>, s=<span class="hljs-number">15</span>)<br>    plt.show()<br>    keep_running = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Make another walk? (y/n): &quot;</span>)<br>    <span class="hljs-keyword">if</span> keep_running == <span class="hljs-string">&#x27;n&#x27;</span>:<br>        <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure>
<p>使用range() 生成了一个数字列表，其中包含的数与漫步包含的点数量相同。将参数c设置为point_numbers ，指定使用颜色映射Blues ，并传递实参edgecolors=’none’ 以删除每个点的轮廓。最终的随机漫步图从浅蓝色渐变为深蓝色。</p>
<p>至于为什么不直接用rw.y_values给c，因为他在一直append，直接赋不太好。</p>
<p><img src="/../img/image-20220917164443554.png" srcset="/img/loading.gif" lazyload alt="image-20220917164443554" style="zoom:50%;"></p>
<p>b. 重新绘制起点和终点</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">ax.scatter(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, c=<span class="hljs-string">&#x27;green&#x27;</span>, edgecolors=<span class="hljs-string">&#x27;none&#x27;</span>, s=<span class="hljs-number">100</span>)<br>   <br>ax.scatter(rw.x_values[-<span class="hljs-number">1</span>], rw.y_values[-<span class="hljs-number">1</span>],<br>           c=<span class="hljs-string">&#x27;red&#x27;</span>, edgecolors=<span class="hljs-string">&#x27;none&#x27;</span>,s=<span class="hljs-number">100</span>)<br></code></pre></td></tr></table></figure>
<p>c. 隐藏坐标轴</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">ax.get_xaxis().set_visible(<span class="hljs-literal">False</span>) <br>ax.get_yaxis().set_visible(<span class="hljs-literal">False</span>)<br></code></pre></td></tr></table></figure>
<p>d. 调整尺寸以适合屏幕</p>
<p>创建图表时，可传递参数figsize 以指定生成的图形的尺寸。 需要给参数figsize 指定一个元组，向Matplotlib指出绘图窗口的尺寸，单位为英寸，如果知道当前系统 的分辨率，可通过参数dpi 向plt.subplots() 传递该分辨 率，以有效利用可用的屏幕空间。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">fig, ax = plt.subplots(figsize=(<span class="hljs-number">15</span>, <span class="hljs-number">9</span>), dpi=<span class="hljs-number">128</span>)<br></code></pre></td></tr></table></figure>
<h4 id="使用Plotly模拟掷骰子"><a href="#使用Plotly模拟掷骰子" class="headerlink" title="使用Plotly模拟掷骰子"></a>使用Plotly模拟掷骰子</h4><p>Plotly生成的图表还是交互式的：用户将鼠标指向特定元素时，将突出显示有关该元素的信息。</p>
<p><strong>创建Die 类</strong></p>
<p>创建一个n面骰子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Die</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,num_sides=<span class="hljs-number">6</span></span>):<br>        self.num_sides=num_sides<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">roll</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> randint(<span class="hljs-number">1</span>,self.num_sides)<br></code></pre></td></tr></table></figure>
<p><strong>掷骰子</strong></p>
<p>计算每个点数出现的次数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> die <span class="hljs-keyword">import</span> Die<br>die=Die()<br>results=[]<br><span class="hljs-keyword">for</span> rn <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>    result=die.roll()<br>    results.append(result)<br>freq=[]<br><span class="hljs-keyword">for</span> value <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,die.num_sides+<span class="hljs-number">1</span>):<br>    fre=results.count(value)<br>    freq.append(fre)<br><span class="hljs-built_in">print</span>(freq)<br></code></pre></td></tr></table></figure>
<p><strong>绘制直方图</strong></p>
<p>绘制一个条形图，指出各种结果出现的频率</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> die <span class="hljs-keyword">import</span> Die<br><span class="hljs-keyword">from</span> plotly.graph_objs <span class="hljs-keyword">import</span> Bar, Layout<br><span class="hljs-keyword">from</span> plotly <span class="hljs-keyword">import</span> offline<br>die=Die()<br>results=[]<br><span class="hljs-keyword">for</span> rn <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>    result=die.roll()<br>    results.append(result)<br>freq=[]<br><span class="hljs-keyword">for</span> value <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,die.num_sides+<span class="hljs-number">1</span>):<br>    fre=results.count(value)<br>    freq.append(fre)<br><span class="hljs-comment">#Plotly不能直接接受函数range() 的结果，因此需要使用函数list() 将其转换为列表。</span><br>x_values = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, die.num_sides+<span class="hljs-number">1</span>))<br><span class="hljs-comment">#Plotly类Bar() 表示用于绘制条形图的数据集,需要一个存储x值的列表和一个存储y值的列表。</span><br>data = [Bar(x=x_values, y=freq)]<br><span class="hljs-comment">#每个坐标轴都能以不同的方式进行配置,而每个配置选项都是一个字典元素,这里只设置了坐标轴标签</span><br>x_axis_config = &#123;<span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;结果&#x27;</span>&#125;<br>y_axis_config = &#123;<span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;结果的频率&#x27;</span>&#125;<br><span class="hljs-comment">#类Layout() 返回一个指定图表布局和配置的对象</span><br>my_layout = Layout(title=<span class="hljs-string">&#x27;掷一个D6 1000次的结果&#x27;</span>, xaxis=x_axis_config, yaxis=y_axis_config)<br><span class="hljs-comment">#为生成图表，我们调用了函数offline.plot()</span><br><span class="hljs-comment">#这个函数需要一个包含数据和布局对象的字典，还接受一个文件名</span><br>offline.plot(&#123;<span class="hljs-string">&#x27;data&#x27;</span>: data, <span class="hljs-string">&#x27;layout&#x27;</span>: my_layout&#125;, filename=<span class="hljs-string">&#x27;d6.html&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>注意：Plotly让这个图表具有交互性，将鼠标指向其中的任意条形，就能看到与之相关联的数据。另外，注意到右上角有一些图标，让你能够平移和缩放图表以及将其保存为图像。</p>
<p><strong>同时掷两个骰子</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> die <span class="hljs-keyword">import</span> Die<br><span class="hljs-keyword">from</span> plotly.graph_objs <span class="hljs-keyword">import</span> Bar, Layout<br><span class="hljs-keyword">from</span> plotly <span class="hljs-keyword">import</span> offline<br>die1=Die()<br>die2=Die()<br>results=[]<br><span class="hljs-keyword">for</span> rn <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>    result1=die1.roll()<br>    result2=die2.roll()<br>    results.append(result1+result2)<br>freq=[]<br><span class="hljs-keyword">for</span> value <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,(die1.num_sides+<span class="hljs-number">1</span>)*<span class="hljs-number">2</span>):<br>    fre=results.count(value)<br>    freq.append(fre)<br>x_values = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, (die1.num_sides+<span class="hljs-number">1</span>)*<span class="hljs-number">2</span>))<br>data = [Bar(x=x_values, y=freq)]<br>x_axis_config = &#123;<span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;结果&#x27;</span>,<span class="hljs-string">&#x27;dtick&#x27;</span>: <span class="hljs-number">1</span>&#125;<br>y_axis_config = &#123;<span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;结果的频率&#x27;</span>&#125;<br>my_layout = Layout(title=<span class="hljs-string">&#x27;掷一个D6 1000次的结果&#x27;</span>, xaxis=x_axis_config, yaxis=y_axis_config)<br>offline.plot(&#123;<span class="hljs-string">&#x27;data&#x27;</span>: data, <span class="hljs-string">&#x27;layout&#x27;</span>: my_layout&#125;, filename=<span class="hljs-string">&#x27;d6.html&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>创建图表时，在字典x_axis_config 中使设置’dtick’: 1，让Plotly显示每个刻度值。</p>
<p><strong>同时掷两个面数不同的骰子</strong></p>
<p>下面来创建一个6面骰子和一个10面骰子，看看同时掷这两个骰子 50 000次的结果如何：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> die <span class="hljs-keyword">import</span> Die<br><span class="hljs-keyword">from</span> plotly.graph_objs <span class="hljs-keyword">import</span> Bar, Layout<br><span class="hljs-keyword">from</span> plotly <span class="hljs-keyword">import</span> offline<br>die1=Die(<span class="hljs-number">6</span>)<br>die2=Die(<span class="hljs-number">10</span>)<br>results=[]<br><span class="hljs-keyword">for</span> rn <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">50_000</span>):<br>    result=die1.roll()+die2.roll()<br>    results.append(result)<br>freq=[]<br><span class="hljs-keyword">for</span> value <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>,die1.num_sides+die2.num_sides+<span class="hljs-number">1</span>):<br>    fre=results.count(value)<br>    freq.append(fre)<br>x_values = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>, die1.num_sides+die2.num_sides+<span class="hljs-number">1</span>))<br>data = [Bar(x=x_values, y=freq)]<br>x_axis_config = &#123;<span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;结果&#x27;</span>,<span class="hljs-string">&#x27;dtick&#x27;</span>: <span class="hljs-number">1</span>&#125;<br>y_axis_config = &#123;<span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;结果的频率&#x27;</span>&#125;<br>my_layout = Layout(title=<span class="hljs-string">&#x27;掷一个D6 1000次的结果&#x27;</span>, xaxis=x_axis_config, yaxis=y_axis_config)<br>offline.plot(&#123;<span class="hljs-string">&#x27;data&#x27;</span>: data, <span class="hljs-string">&#x27;layout&#x27;</span>: my_layout&#125;, filename=<span class="hljs-string">&#x27;d6.html&#x27;</span>)<br></code></pre></td></tr></table></figure>

              
            </div>
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Python/" class="category-chain-item">Python</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Python%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">#Python基础知识</a>
      
    </div>
  
</div>


              

              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/06/29/HTML/" title="HTML">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">HTML</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/06/25/Maven-Mabtis/" title="Maven&amp;Mabtis">
                        <span class="hidden-mobile">Maven&amp;Mabtis</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  <article id="comments" lazyload>
    
  <div id="vcomment" class="comment"></div> 
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script>
  <script>
    var notify = '' == true ? true : false;
    var verify = '' == true ? true : false;
      window.onload = function() {
          new Valine({
              el: '#vcomment',
              app_id: "AwHBUAjSP1GvDVpiBgxfS2Pg-gzGzoHsz",
              app_key: "kMsGLN3hzkQJuLrmqQBgquFF",
              placeholder: "说点什么",
              avatar:"retro",
              visitor: true       

          });
      }
  </script>

 
  <noscript>Please enable JavaScript to view the comments</noscript>



  </article>


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;Table of Contents</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  




  
  








    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  

  

  

  

  

  

  
    
  




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script>
  (function() {
    var enableLang = CONFIG.code_language.enable && CONFIG.code_language.default;
    var enableCopy = CONFIG.copy_btn;
    if (!enableLang && !enableCopy) {
      return;
    }

    function getBgClass(ele) {
      return Fluid.utils.getBackgroundLightness(ele) >= 0 ? 'code-widget-light' : 'code-widget-dark';
    }

    var copyTmpl = '';
    copyTmpl += '<div class="code-widget">';
    copyTmpl += 'LANG';
    copyTmpl += '</div>';
    jQuery('.markdown-body pre').each(function() {
      var $pre = jQuery(this);
      if ($pre.find('code.mermaid').length > 0) {
        return;
      }
      if ($pre.find('span.line').length > 0) {
        return;
      }

      var lang = '';

      if (enableLang) {
        lang = CONFIG.code_language.default;
        if ($pre[0].children.length > 0 && $pre[0].children[0].classList.length >= 2 && $pre.children().hasClass('hljs')) {
          lang = $pre[0].children[0].classList[1];
        } else if ($pre[0].getAttribute('data-language')) {
          lang = $pre[0].getAttribute('data-language');
        } else if ($pre.parent().hasClass('sourceCode') && $pre[0].children.length > 0 && $pre[0].children[0].classList.length >= 2) {
          lang = $pre[0].children[0].classList[1];
          $pre.parent().addClass('code-wrapper');
        } else if ($pre.parent().hasClass('markdown-body') && $pre[0].classList.length === 0) {
          $pre.wrap('<div class="code-wrapper"></div>');
        }
        lang = lang.toUpperCase().replace('NONE', CONFIG.code_language.default);
      }
      $pre.append(copyTmpl.replace('LANG', lang).replace('code-widget">',
        getBgClass($pre[0]) + (enableCopy ? ' code-widget copy-btn" data-clipboard-snippet><i class="iconfont icon-copy"></i>' : ' code-widget">')));

      if (enableCopy) {
        Fluid.utils.createScript('https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js', function() {
          var clipboard = new window.ClipboardJS('.copy-btn', {
            target: function(trigger) {
              var nodes = trigger.parentNode.childNodes;
              for (var i = 0; i < nodes.length; i++) {
                if (nodes[i].tagName === 'CODE') {
                  return nodes[i];
                }
              }
            }
          });
          clipboard.on('success', function(e) {
            e.clearSelection();
            e.trigger.innerHTML = e.trigger.innerHTML.replace('icon-copy', 'icon-success');
            setTimeout(function() {
              e.trigger.innerHTML = e.trigger.innerHTML.replace('icon-success', 'icon-copy');
            }, 2000);
          });
        });
      }
    });
  })();
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  
      <script>
        MathJax = {
          tex    : {
            inlineMath: { '[+]': [['$', '$']] }
          },
          loader : {
            load: ['ui/lazy']
          },
          options: {
            renderActions: {
              findScript    : [10, doc => {
                document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
                  const display = !!node.type.match(/; *mode=display/);
                  const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                  const text = document.createTextNode('');
                  node.parentNode.replaceChild(text, node);
                  math.start = { node: text, delim: '', n: 0 };
                  math.end = { node: text, delim: '', n: 0 };
                  doc.math.push(math);
                });
              }, '', false],
              insertedScript: [200, () => {
                document.querySelectorAll('mjx-container').forEach(node => {
                  let target = node.parentNode;
                  if (target.nodeName.toLowerCase() === 'li') {
                    target.parentNode.classList.add('has-jax');
                  }
                });
              }, '', false]
            }
          }
        };
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.1/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>

  <script defer src="/js/leancloud.js" ></script>




  
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/yinghua.js"></script>
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/xiantiao.js"></script>
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/xiaoxingxing.js"></script>
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/caidai.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/z16.model.json"},"display":{"position":"right","width":150,"height":300,"hOffset":-15,"vOffset":-15},"mobile":{"show":true},"react":{"opacity":0.7},"log":false});</script></body>
</html>
